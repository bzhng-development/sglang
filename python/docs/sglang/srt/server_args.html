<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
<meta name="generator" content="pdoc3 0.11.6">
<title>sglang.srt.server_args API documentation</title>
<meta name="description" content="The arguments of the server.">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/sanitize.min.css" integrity="sha512-y1dtMcuvtTMJc1yPgEqF0ZjQbhnc/bFhyvIyVNb9Zk5mIGtqVaAB1Ttl28su8AvFMOY0EwRbAe+HCLqj6W7/KA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/typography.min.css" integrity="sha512-Y1DYSb995BAfxobCkKepB1BqJJTPrOp3zPL74AWFugHHmmdcvO+C48WLrUOlhGMc0QG7AE3f7gmvvcrmX2fDoA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:1.5em;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:2em 0 .50em 0}h3{font-size:1.4em;margin:1.6em 0 .7em 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .2s ease-in-out}a:visited{color:#503}a:hover{color:#b62}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900;font-weight:bold}pre code{font-size:.8em;line-height:1.4em;padding:1em;display:block}code{background:#f3f3f3;font-family:"DejaVu Sans Mono",monospace;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source > summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible;min-width:max-content}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em 1em;margin:1em 0}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul ul{padding-left:1em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" integrity="sha512-D9gUyxqja7hBtkWpPWGt9wfbfaMGVt9gnyCvYa+jojwwPHLCzUm5i8rpk7vD7wNee9bA35eYIjobYPaQuKS1MQ==" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => {
hljs.configure({languages: ['bash', 'css', 'diff', 'graphql', 'ini', 'javascript', 'json', 'plaintext', 'python', 'python-repl', 'rust', 'shell', 'sql', 'typescript', 'xml', 'yaml']});
hljs.highlightAll();
/* Collapse source docstrings */
setTimeout(() => {
[...document.querySelectorAll('.hljs.language-python > .hljs-string')]
.filter(el => el.innerHTML.length > 200 && ['"""', "'''"].includes(el.innerHTML.substring(0, 3)))
.forEach(el => {
let d = document.createElement('details');
d.classList.add('hljs-string');
d.innerHTML = '<summary>"""</summary>' + el.innerHTML.substring(3);
el.replaceWith(d);
});
}, 100);
})</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>sglang.srt.server_args</code></h1>
</header>
<section id="section-intro">
<p>The arguments of the server.</p>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="sglang.srt.server_args.add_attention_backend_choices"><code class="name flex">
<span>def <span class="ident">add_attention_backend_choices</span></span>(<span>choices)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_attention_backend_choices(choices):
    ATTENTION_BACKEND_CHOICES.extend(choices)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.add_disagg_transfer_backend_choices"><code class="name flex">
<span>def <span class="ident">add_disagg_transfer_backend_choices</span></span>(<span>choices)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_disagg_transfer_backend_choices(choices):
    DISAGG_TRANSFER_BACKEND_CHOICES.extend(choices)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.add_load_format_choices"><code class="name flex">
<span>def <span class="ident">add_load_format_choices</span></span>(<span>choices)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_load_format_choices(choices):
    LOAD_FORMAT_CHOICES.extend(choices)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.add_quantization_method_choices"><code class="name flex">
<span>def <span class="ident">add_quantization_method_choices</span></span>(<span>choices)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_quantization_method_choices(choices):
    QUANTIZATION_CHOICES.extend(choices)</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.auto_choose_speculative_params"><code class="name flex">
<span>def <span class="ident">auto_choose_speculative_params</span></span>(<span>self: <a title="sglang.srt.server_args.ServerArgs" href="#sglang.srt.server_args.ServerArgs">ServerArgs</a>)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def auto_choose_speculative_params(self: ServerArgs):
    &#34;&#34;&#34;
    Automatically choose the parameters for speculative decoding.

    You can tune them on your own models and prompts with scripts/playground/bench_speculative.py
    &#34;&#34;&#34;
    hf_config = self.get_hf_config()
    arch = hf_config.architectures[0]

    if arch in [&#34;LlamaForCausalLM&#34;]:
        # The default value for llama
        return (5, 4, 8)
    elif arch in [
        &#34;DeepseekV3ForCausalLM&#34;,
        &#34;DeepseekV2ForCausalLM&#34;,
        &#34;GptOssForCausalLM&#34;,
    ]:
        # The default value for deepseek and gpt-oss
        return (3, 1, 4)
    elif arch in [&#34;Grok1ForCausalLM&#34;, &#34;Grok1VForCausalLM&#34;]:
        return (5, 4, 8)
    else:
        # The default value for all other models
        return (5, 4, 8)</code></pre>
</details>
<div class="desc"><p>Automatically choose the parameters for speculative decoding.</p>
<p>You can tune them on your own models and prompts with scripts/playground/bench_speculative.py</p></div>
</dd>
<dt id="sglang.srt.server_args.prepare_server_args"><code class="name flex">
<span>def <span class="ident">prepare_server_args</span></span>(<span>argv: List[str]) ‑> <a title="sglang.srt.server_args.ServerArgs" href="#sglang.srt.server_args.ServerArgs">ServerArgs</a></span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def prepare_server_args(argv: List[str]) -&gt; ServerArgs:
    &#34;&#34;&#34;
    Prepare the server arguments from the command line arguments.

    Args:
        args: The command line arguments. Typically, it should be `sys.argv[1:]`
            to ensure compatibility with `parse_args` when no arguments are passed.

    Returns:
        The server arguments.
    &#34;&#34;&#34;
    parser = argparse.ArgumentParser()
    ServerArgs.add_cli_args(parser)
    raw_args = parser.parse_args(argv)
    server_args = ServerArgs.from_cli_args(raw_args)
    return server_args</code></pre>
</details>
<div class="desc"><p>Prepare the server arguments from the command line arguments.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>args</code></strong></dt>
<dd>The command line arguments. Typically, it should be <code>sys.argv[1:]</code>
to ensure compatibility with <code>parse_args</code> when no arguments are passed.</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>The server arguments.</p></div>
</dd>
<dt id="sglang.srt.server_args.print_deprecated_warning"><code class="name flex">
<span>def <span class="ident">print_deprecated_warning</span></span>(<span>message: str)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def print_deprecated_warning(message: str):
    logger.warning(f&#34;\033[33m{message}\033[0m&#34;)</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="sglang.srt.server_args.DeprecatedAction"><code class="flex name class">
<span>class <span class="ident">DeprecatedAction</span></span>
<span>(</span><span>option_strings, dest, nargs=0, **kwargs)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class DeprecatedAction(argparse.Action):
    def __init__(self, option_strings, dest, nargs=0, **kwargs):
        super(DeprecatedAction, self).__init__(
            option_strings, dest, nargs=nargs, **kwargs
        )

    def __call__(self, parser, namespace, values, option_string=None):
        raise ValueError(self.help)</code></pre>
</details>
<div class="desc"><p>Information about how to convert command line strings to Python objects.</p>
<p>Action objects are used by an ArgumentParser to represent the information
needed to parse a single argument from one or more strings from the
command line. The keyword arguments to the Action constructor are also
all attributes of Action instances.</p>
<p>Keyword Arguments:</p>
<pre><code>- option_strings -- A list of command-line option strings which
    should be associated with this action.

- dest -- The name of the attribute to hold the created object(s)

- nargs -- The number of command-line arguments that should be
    consumed. By default, one argument will be consumed and a single
    value will be produced.  Other values include:
        - N (an integer) consumes N arguments (and produces a list)
        - '?' consumes zero or one arguments
        - '*' consumes zero or more arguments (and produces a list)
        - '+' consumes one or more arguments (and produces a list)
    Note that the difference between the default and nargs=1 is that
    with the default, a single value will be produced, while with
    nargs=1, a list containing a single value will be produced.

- const -- The value to be produced if the option is specified and the
    option uses an action that takes no values.

- default -- The value to be produced if the option is not specified.

- type -- A callable that accepts a single string argument, and
    returns the converted value.  The standard Python types str, int,
    float, and complex are useful examples of such callables.  If None,
    str is used.

- choices -- A container of values that should be allowed. If not None,
    after a command-line argument has been converted to the appropriate
    type, an exception will be raised if it is not a member of this
    collection.

- required -- True if the action must always be specified at the
    command line. This is only meaningful for optional command-line
    arguments.

- help -- The help string describing the argument.

- metavar -- The name to be used for the option's argument with the
    help string. If None, the 'dest' value will be used as the name.
</code></pre></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>argparse.Action</li>
<li>argparse._AttributeHolder</li>
</ul>
</dd>
<dt id="sglang.srt.server_args.LoRAPathAction"><code class="flex name class">
<span>class <span class="ident">LoRAPathAction</span></span>
<span>(</span><span>option_strings,<br>dest,<br>nargs=None,<br>const=None,<br>default=None,<br>type=None,<br>choices=None,<br>required=False,<br>help=None,<br>metavar=None)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class LoRAPathAction(argparse.Action):
    def __call__(self, parser, namespace, values, option_string=None):
        lora_paths = []
        if values:
            assert isinstance(values, list), &#34;Expected a list of LoRA paths.&#34;
            for lora_path in values:
                lora_path = lora_path.strip()
                if lora_path.startswith(&#34;{&#34;) and lora_path.endswith(&#34;}&#34;):
                    obj = json.loads(lora_path)
                    assert &#34;lora_path&#34; in obj and &#34;lora_name&#34; in obj, (
                        f&#34;{repr(lora_path)} looks like a JSON str, &#34;
                        &#34;but it does not contain &#39;lora_name&#39; and &#39;lora_path&#39; keys.&#34;
                    )
                    lora_paths.append(obj)
                else:
                    lora_paths.append(lora_path)

        setattr(namespace, self.dest, lora_paths)</code></pre>
</details>
<div class="desc"><p>Information about how to convert command line strings to Python objects.</p>
<p>Action objects are used by an ArgumentParser to represent the information
needed to parse a single argument from one or more strings from the
command line. The keyword arguments to the Action constructor are also
all attributes of Action instances.</p>
<p>Keyword Arguments:</p>
<pre><code>- option_strings -- A list of command-line option strings which
    should be associated with this action.

- dest -- The name of the attribute to hold the created object(s)

- nargs -- The number of command-line arguments that should be
    consumed. By default, one argument will be consumed and a single
    value will be produced.  Other values include:
        - N (an integer) consumes N arguments (and produces a list)
        - '?' consumes zero or one arguments
        - '*' consumes zero or more arguments (and produces a list)
        - '+' consumes one or more arguments (and produces a list)
    Note that the difference between the default and nargs=1 is that
    with the default, a single value will be produced, while with
    nargs=1, a list containing a single value will be produced.

- const -- The value to be produced if the option is specified and the
    option uses an action that takes no values.

- default -- The value to be produced if the option is not specified.

- type -- A callable that accepts a single string argument, and
    returns the converted value.  The standard Python types str, int,
    float, and complex are useful examples of such callables.  If None,
    str is used.

- choices -- A container of values that should be allowed. If not None,
    after a command-line argument has been converted to the appropriate
    type, an exception will be raised if it is not a member of this
    collection.

- required -- True if the action must always be specified at the
    command line. This is only meaningful for optional command-line
    arguments.

- help -- The help string describing the argument.

- metavar -- The name to be used for the option's argument with the
    help string. If None, the 'dest' value will be used as the name.
</code></pre></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>argparse.Action</li>
<li>argparse._AttributeHolder</li>
</ul>
</dd>
<dt id="sglang.srt.server_args.PortArgs"><code class="flex name class">
<span>class <span class="ident">PortArgs</span></span>
<span>(</span><span>tokenizer_ipc_name: str,<br>scheduler_input_ipc_name: str,<br>detokenizer_ipc_name: str,<br>nccl_port: int,<br>rpc_ipc_name: str,<br>metrics_ipc_name: str)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@dataclasses.dataclass
class PortArgs:
    # The ipc filename for tokenizer to receive inputs from detokenizer (zmq)
    tokenizer_ipc_name: str
    # The ipc filename for scheduler (rank 0) to receive inputs from tokenizer (zmq)
    scheduler_input_ipc_name: str
    # The ipc filename for detokenizer to receive inputs from scheduler (zmq)
    detokenizer_ipc_name: str

    # The port for nccl initialization (torch.dist)
    nccl_port: int

    # The ipc filename for rpc call between Engine and Scheduler
    rpc_ipc_name: str

    # The ipc filename for Scheduler to send metrics
    metrics_ipc_name: str

    @staticmethod
    def init_new(server_args, dp_rank: Optional[int] = None) -&gt; &#34;PortArgs&#34;:
        if server_args.nccl_port is None:
            nccl_port = server_args.port + random.randint(100, 1000)
            while True:
                if is_port_available(nccl_port):
                    break
                if nccl_port &lt; 60000:
                    nccl_port += 42
                else:
                    nccl_port -= 43
        else:
            nccl_port = server_args.nccl_port

        if not server_args.enable_dp_attention:
            # Normal case, use IPC within a single node
            return PortArgs(
                tokenizer_ipc_name=f&#34;ipc://{tempfile.NamedTemporaryFile(delete=False).name}&#34;,
                scheduler_input_ipc_name=f&#34;ipc://{tempfile.NamedTemporaryFile(delete=False).name}&#34;,
                detokenizer_ipc_name=f&#34;ipc://{tempfile.NamedTemporaryFile(delete=False).name}&#34;,
                nccl_port=nccl_port,
                rpc_ipc_name=f&#34;ipc://{tempfile.NamedTemporaryFile(delete=False).name}&#34;,
                metrics_ipc_name=f&#34;ipc://{tempfile.NamedTemporaryFile(delete=False).name}&#34;,
            )
        else:
            # DP attention. Use TCP + port to handle both single-node and multi-node.
            if server_args.nnodes == 1 and server_args.dist_init_addr is None:
                dist_init_addr = (&#34;127.0.0.1&#34;, server_args.port + ZMQ_TCP_PORT_DELTA)
            elif server_args.dist_init_addr.startswith(&#34;[&#34;):  # ipv6 address
                port_num, host = configure_ipv6(server_args.dist_init_addr)
                dist_init_addr = (host, str(port_num))
            else:
                dist_init_addr = server_args.dist_init_addr.split(&#34;:&#34;)

            assert (
                len(dist_init_addr) == 2
            ), &#34;please provide --dist-init-addr as host:port of head node&#34;

            dist_init_host, dist_init_port = dist_init_addr
            port_base = int(dist_init_port) + 1
            detokenizer_port = port_base + 1
            rpc_port = port_base + 2
            metrics_ipc_name = port_base + 3
            if dp_rank is None:
                # TokenizerManager to DataParallelController
                scheduler_input_port = port_base + 4
            else:
                scheduler_input_port = port_base + 4 + 1 + dp_rank

            return PortArgs(
                tokenizer_ipc_name=f&#34;tcp://{dist_init_host}:{port_base}&#34;,
                scheduler_input_ipc_name=f&#34;tcp://{dist_init_host}:{scheduler_input_port}&#34;,
                detokenizer_ipc_name=f&#34;tcp://{dist_init_host}:{detokenizer_port}&#34;,
                nccl_port=nccl_port,
                rpc_ipc_name=f&#34;tcp://{dist_init_host}:{rpc_port}&#34;,
                metrics_ipc_name=f&#34;tcp://{dist_init_host}:{metrics_ipc_name}&#34;,
            )</code></pre>
</details>
<div class="desc"><p>PortArgs(tokenizer_ipc_name: str, scheduler_input_ipc_name: str, detokenizer_ipc_name: str, nccl_port: int, rpc_ipc_name: str, metrics_ipc_name: str)</p></div>
<h3>Static methods</h3>
<dl>
<dt id="sglang.srt.server_args.PortArgs.init_new"><code class="name flex">
<span>def <span class="ident">init_new</span></span>(<span>server_args, dp_rank: int | None = None) ‑> <a title="sglang.srt.server_args.PortArgs" href="#sglang.srt.server_args.PortArgs">PortArgs</a></span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@staticmethod
def init_new(server_args, dp_rank: Optional[int] = None) -&gt; &#34;PortArgs&#34;:
    if server_args.nccl_port is None:
        nccl_port = server_args.port + random.randint(100, 1000)
        while True:
            if is_port_available(nccl_port):
                break
            if nccl_port &lt; 60000:
                nccl_port += 42
            else:
                nccl_port -= 43
    else:
        nccl_port = server_args.nccl_port

    if not server_args.enable_dp_attention:
        # Normal case, use IPC within a single node
        return PortArgs(
            tokenizer_ipc_name=f&#34;ipc://{tempfile.NamedTemporaryFile(delete=False).name}&#34;,
            scheduler_input_ipc_name=f&#34;ipc://{tempfile.NamedTemporaryFile(delete=False).name}&#34;,
            detokenizer_ipc_name=f&#34;ipc://{tempfile.NamedTemporaryFile(delete=False).name}&#34;,
            nccl_port=nccl_port,
            rpc_ipc_name=f&#34;ipc://{tempfile.NamedTemporaryFile(delete=False).name}&#34;,
            metrics_ipc_name=f&#34;ipc://{tempfile.NamedTemporaryFile(delete=False).name}&#34;,
        )
    else:
        # DP attention. Use TCP + port to handle both single-node and multi-node.
        if server_args.nnodes == 1 and server_args.dist_init_addr is None:
            dist_init_addr = (&#34;127.0.0.1&#34;, server_args.port + ZMQ_TCP_PORT_DELTA)
        elif server_args.dist_init_addr.startswith(&#34;[&#34;):  # ipv6 address
            port_num, host = configure_ipv6(server_args.dist_init_addr)
            dist_init_addr = (host, str(port_num))
        else:
            dist_init_addr = server_args.dist_init_addr.split(&#34;:&#34;)

        assert (
            len(dist_init_addr) == 2
        ), &#34;please provide --dist-init-addr as host:port of head node&#34;

        dist_init_host, dist_init_port = dist_init_addr
        port_base = int(dist_init_port) + 1
        detokenizer_port = port_base + 1
        rpc_port = port_base + 2
        metrics_ipc_name = port_base + 3
        if dp_rank is None:
            # TokenizerManager to DataParallelController
            scheduler_input_port = port_base + 4
        else:
            scheduler_input_port = port_base + 4 + 1 + dp_rank

        return PortArgs(
            tokenizer_ipc_name=f&#34;tcp://{dist_init_host}:{port_base}&#34;,
            scheduler_input_ipc_name=f&#34;tcp://{dist_init_host}:{scheduler_input_port}&#34;,
            detokenizer_ipc_name=f&#34;tcp://{dist_init_host}:{detokenizer_port}&#34;,
            nccl_port=nccl_port,
            rpc_ipc_name=f&#34;tcp://{dist_init_host}:{rpc_port}&#34;,
            metrics_ipc_name=f&#34;tcp://{dist_init_host}:{metrics_ipc_name}&#34;,
        )</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
<h3>Instance variables</h3>
<dl>
<dt id="sglang.srt.server_args.PortArgs.detokenizer_ipc_name"><code class="name">var <span class="ident">detokenizer_ipc_name</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.PortArgs.metrics_ipc_name"><code class="name">var <span class="ident">metrics_ipc_name</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.PortArgs.nccl_port"><code class="name">var <span class="ident">nccl_port</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.PortArgs.rpc_ipc_name"><code class="name">var <span class="ident">rpc_ipc_name</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.PortArgs.scheduler_input_ipc_name"><code class="name">var <span class="ident">scheduler_input_ipc_name</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.PortArgs.tokenizer_ipc_name"><code class="name">var <span class="ident">tokenizer_ipc_name</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</dd>
<dt id="sglang.srt.server_args.ServerArgs"><code class="flex name class">
<span>class <span class="ident">ServerArgs</span></span>
<span>(</span><span>model_path: str,<br>tokenizer_path: str | None = None,<br>tokenizer_mode: str = 'auto',<br>skip_tokenizer_init: bool = False,<br>load_format: str = 'auto',<br>model_loader_extra_config: str = '{}',<br>trust_remote_code: bool = False,<br>context_length: int | None = None,<br>is_embedding: bool = False,<br>enable_multimodal: bool | None = None,<br>revision: str | None = None,<br>model_impl: str = 'auto',<br>host: str = '127.0.0.1',<br>port: int = 30000,<br>skip_server_warmup: bool = False,<br>warmups: str | None = None,<br>nccl_port: int | None = None,<br>dtype: str = 'auto',<br>quantization: str | None = None,<br>quantization_param_path: str | None = None,<br>kv_cache_dtype: str = 'auto',<br>mem_fraction_static: float | None = None,<br>max_running_requests: int | None = None,<br>max_queued_requests: int | None = 9223372036854775807,<br>max_total_tokens: int | None = None,<br>chunked_prefill_size: int | None = None,<br>max_prefill_tokens: int = 16384,<br>schedule_policy: str = 'fcfs',<br>schedule_conservativeness: float = 1.0,<br>page_size: int | None = None,<br>hybrid_kvcache_ratio: float | None = None,<br>swa_full_tokens_ratio: float = 0.8,<br>disable_hybrid_swa_memory: bool = False,<br>device: str | None = None,<br>tp_size: int = 1,<br>pp_size: int = 1,<br>max_micro_batch_size: int | None = None,<br>stream_interval: int = 1,<br>stream_output: bool = False,<br>random_seed: int | None = None,<br>constrained_json_whitespace_pattern: str | None = None,<br>watchdog_timeout: float = 300,<br>dist_timeout: int | None = None,<br>download_dir: str | None = None,<br>base_gpu_id: int = 0,<br>gpu_id_step: int = 1,<br>sleep_on_idle: bool = False,<br>log_level: str = 'info',<br>log_level_http: str | None = None,<br>log_requests: bool = False,<br>log_requests_level: int = 2,<br>crash_dump_folder: str | None = None,<br>show_time_cost: bool = False,<br>enable_metrics: bool = False,<br>enable_metrics_for_all_schedulers: bool = False,<br>bucket_time_to_first_token: List[float] | None = None,<br>bucket_inter_token_latency: List[float] | None = None,<br>bucket_e2e_request_latency: List[float] | None = None,<br>collect_tokens_histogram: bool = False,<br>decode_log_interval: int = 40,<br>enable_request_time_stats_logging: bool = False,<br>kv_events_config: str | None = None,<br>gc_warning_threshold_secs: float = 0.0,<br>api_key: str | None = None,<br>served_model_name: str | None = None,<br>weight_version: str = 'default',<br>chat_template: str | None = None,<br>completion_template: str | None = None,<br>file_storage_path: str = 'sglang_storage',<br>enable_cache_report: bool = False,<br>reasoning_parser: str | None = None,<br>tool_call_parser: str | None = None,<br>tool_server: str | None = None,<br>dp_size: int = 1,<br>load_balance_method: str = 'round_robin',<br>dist_init_addr: str | None = None,<br>nnodes: int = 1,<br>node_rank: int = 0,<br>json_model_override_args: str = '{}',<br>preferred_sampling_params: str | None = None,<br>enable_lora: bool | None = None,<br>max_lora_rank: int | None = None,<br>lora_target_modules: set[str] | List[str] | None = None,<br>lora_paths: dict[str, str] | List[dict[str, str]] | List[str] | List[<a title="sglang.srt.lora.lora_registry.LoRARef" href="lora/lora_registry.html#sglang.srt.lora.lora_registry.LoRARef">LoRARef</a>] | None = None,<br>max_loaded_loras: int | None = None,<br>max_loras_per_batch: int = 8,<br>lora_backend: str = 'triton',<br>attention_backend: str | None = None,<br>decode_attention_backend: str | None = None,<br>prefill_attention_backend: str | None = None,<br>sampling_backend: str | None = None,<br>grammar_backend: str | None = None,<br>mm_attention_backend: str | None = None,<br>speculative_algorithm: str | None = None,<br>speculative_draft_model_path: str | None = None,<br>speculative_num_steps: int | None = None,<br>speculative_eagle_topk: int | None = None,<br>speculative_num_draft_tokens: int | None = None,<br>speculative_accept_threshold_single: float = 1.0,<br>speculative_accept_threshold_acc: float = 1.0,<br>speculative_token_map: str | None = None,<br>ep_size: int = 1,<br>moe_a2a_backend: Literal['none', 'deepep'] = 'none',<br>moe_runner_backend: Literal['auto', 'triton', 'triton_kernel', 'flashinfer_trtllm', 'flashinfer_cutlass', 'flashinfer_mxfp4'] = 'auto',<br>flashinfer_mxfp4_moe_precision: Literal['default', 'bf16'] = 'default',<br>enable_flashinfer_allreduce_fusion: bool = False,<br>deepep_mode: Literal['auto', 'normal', 'low_latency'] = 'auto',<br>ep_num_redundant_experts: int = 0,<br>ep_dispatch_algorithm: Literal['static', 'dynamic', 'fake'] | None = None,<br>init_expert_location: str = 'trivial',<br>enable_eplb: bool = False,<br>eplb_algorithm: str = 'auto',<br>eplb_rebalance_num_iterations: int = 1000,<br>eplb_rebalance_layers_per_chunk: int | None = None,<br>eplb_min_rebalancing_utilization_threshold: float = 1.0,<br>expert_distribution_recorder_mode: Literal['stat', 'stat_approx', 'per_pass', 'per_token'] | None = None,<br>expert_distribution_recorder_buffer_size: int | None = None,<br>enable_expert_distribution_metrics: bool = False,<br>deepep_config: str | None = None,<br>moe_dense_tp_size: int | None = None,<br>enable_hierarchical_cache: bool = False,<br>hicache_ratio: float = 2.0,<br>hicache_size: int = 0,<br>hicache_write_policy: str = 'write_through',<br>hicache_io_backend: str = 'kernel',<br>hicache_mem_layout: str = 'layer_first',<br>hicache_storage_backend: str | None = None,<br>hicache_storage_prefetch_policy: str = 'best_effort',<br>hicache_storage_backend_extra_config: str | None = None,<br>enable_double_sparsity: bool = False,<br>ds_channel_config_path: str | None = None,<br>ds_heavy_channel_num: int = 32,<br>ds_heavy_token_num: int = 256,<br>ds_heavy_channel_type: str = 'qk',<br>ds_sparse_decode_threshold: int = 4096,<br>cpu_offload_gb: int = 0,<br>offload_group_size: int = -1,<br>offload_num_in_group: int = 1,<br>offload_prefetch_step: int = 1,<br>offload_mode: str = 'cpu',<br>disable_radix_cache: bool = False,<br>cuda_graph_max_bs: int | None = None,<br>cuda_graph_bs: List[int] | None = None,<br>disable_cuda_graph: bool = False,<br>disable_cuda_graph_padding: bool = False,<br>enable_profile_cuda_graph: bool = False,<br>enable_cudagraph_gc: bool = False,<br>enable_nccl_nvls: bool = False,<br>enable_symm_mem: bool = False,<br>disable_flashinfer_cutlass_moe_fp4_allgather: bool = False,<br>enable_tokenizer_batch_encode: bool = False,<br>disable_outlines_disk_cache: bool = False,<br>disable_custom_all_reduce: bool = False,<br>enable_mscclpp: bool = False,<br>disable_overlap_schedule: bool = False,<br>enable_mixed_chunk: bool = False,<br>enable_dp_attention: bool = False,<br>enable_dp_lm_head: bool = False,<br>enable_two_batch_overlap: bool = False,<br>tbo_token_distribution_threshold: float = 0.48,<br>enable_torch_compile: bool = False,<br>torch_compile_max_bs: int = 32,<br>torchao_config: str = '',<br>enable_nan_detection: bool = False,<br>enable_p2p_check: bool = False,<br>triton_attention_reduce_in_fp32: bool = False,<br>triton_attention_num_kv_splits: int = 8,<br>num_continuous_decode_steps: int = 1,<br>delete_ckpt_after_loading: bool = False,<br>enable_memory_saver: bool = False,<br>allow_auto_truncate: bool = False,<br>enable_custom_logit_processor: bool = False,<br>flashinfer_mla_disable_ragged: bool = False,<br>disable_shared_experts_fusion: bool = False,<br>disable_chunked_prefix_cache: bool = False,<br>disable_fast_image_processor: bool = False,<br>enable_return_hidden_states: bool = False,<br>scheduler_recv_interval: int = 1,<br>debug_tensor_dump_output_folder: str | None = None,<br>debug_tensor_dump_input_file: str | None = None,<br>debug_tensor_dump_inject: bool = False,<br>debug_tensor_dump_prefill_only: bool = False,<br>disaggregation_mode: str = 'null',<br>disaggregation_transfer_backend: str = 'mooncake',<br>disaggregation_bootstrap_port: int = 8998,<br>disaggregation_decode_tp: int | None = None,<br>disaggregation_decode_dp: int | None = None,<br>disaggregation_prefill_pp: int | None = 1,<br>disaggregation_ib_device: str | None = None,<br>num_reserved_decode_tokens: int = 512,<br>pdlb_url: str | None = None,<br>custom_weight_loader: List[str] | None = None,<br>weight_loader_disable_mmap: bool = False,<br>enable_pdmux: bool = False,<br>sm_group_num: int = 3,<br>enable_ep_moe: bool = False,<br>enable_deepep_moe: bool = False,<br>enable_flashinfer_cutlass_moe: bool = False,<br>enable_flashinfer_trtllm_moe: bool = False,<br>enable_triton_kernel_moe: bool = False,<br>enable_flashinfer_mxfp4_moe: bool = False)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@dataclasses.dataclass
class ServerArgs:
    # Model and tokenizer
    model_path: str
    tokenizer_path: Optional[str] = None
    tokenizer_mode: str = &#34;auto&#34;
    skip_tokenizer_init: bool = False
    load_format: str = &#34;auto&#34;
    model_loader_extra_config: str = &#34;{}&#34;
    trust_remote_code: bool = False
    context_length: Optional[int] = None
    is_embedding: bool = False
    enable_multimodal: Optional[bool] = None
    revision: Optional[str] = None
    model_impl: str = &#34;auto&#34;

    # HTTP server
    host: str = &#34;127.0.0.1&#34;
    port: int = 30000
    skip_server_warmup: bool = False
    warmups: Optional[str] = None
    nccl_port: Optional[int] = None

    # Quantization and data type
    dtype: str = &#34;auto&#34;
    quantization: Optional[str] = None
    quantization_param_path: Optional[str] = None
    kv_cache_dtype: str = &#34;auto&#34;

    # Memory and scheduling
    mem_fraction_static: Optional[float] = None
    max_running_requests: Optional[int] = None
    max_queued_requests: Optional[int] = sys.maxsize
    max_total_tokens: Optional[int] = None
    chunked_prefill_size: Optional[int] = None
    max_prefill_tokens: int = 16384
    schedule_policy: str = &#34;fcfs&#34;
    schedule_conservativeness: float = 1.0
    page_size: Optional[int] = None
    hybrid_kvcache_ratio: Optional[float] = None
    swa_full_tokens_ratio: float = 0.8
    disable_hybrid_swa_memory: bool = False

    # Runtime options
    device: Optional[str] = None
    tp_size: int = 1
    pp_size: int = 1
    max_micro_batch_size: Optional[int] = None
    stream_interval: int = 1
    stream_output: bool = False
    random_seed: Optional[int] = None
    constrained_json_whitespace_pattern: Optional[str] = None
    watchdog_timeout: float = 300
    dist_timeout: Optional[int] = None  # timeout for torch.distributed
    download_dir: Optional[str] = None
    base_gpu_id: int = 0
    gpu_id_step: int = 1
    sleep_on_idle: bool = False

    # Logging
    log_level: str = &#34;info&#34;
    log_level_http: Optional[str] = None
    log_requests: bool = False
    log_requests_level: int = 2
    crash_dump_folder: Optional[str] = None
    show_time_cost: bool = False
    enable_metrics: bool = False
    enable_metrics_for_all_schedulers: bool = False
    bucket_time_to_first_token: Optional[List[float]] = None
    bucket_inter_token_latency: Optional[List[float]] = None
    bucket_e2e_request_latency: Optional[List[float]] = None
    collect_tokens_histogram: bool = False
    decode_log_interval: int = 40
    enable_request_time_stats_logging: bool = False
    kv_events_config: Optional[str] = None
    gc_warning_threshold_secs: float = 0.0

    # API related
    api_key: Optional[str] = None
    served_model_name: Optional[str] = None
    weight_version: str = &#34;default&#34;
    chat_template: Optional[str] = None
    completion_template: Optional[str] = None
    file_storage_path: str = &#34;sglang_storage&#34;
    enable_cache_report: bool = False
    reasoning_parser: Optional[str] = None
    tool_call_parser: Optional[str] = None
    tool_server: Optional[str] = None

    # Data parallelism
    dp_size: int = 1
    load_balance_method: str = &#34;round_robin&#34;

    # Multi-node distributed serving
    dist_init_addr: Optional[str] = None
    nnodes: int = 1
    node_rank: int = 0

    # Model override args in JSON
    json_model_override_args: str = &#34;{}&#34;
    preferred_sampling_params: Optional[str] = None

    # LoRA
    enable_lora: Optional[bool] = None
    max_lora_rank: Optional[int] = None
    lora_target_modules: Optional[Union[set[str], List[str]]] = None
    lora_paths: Optional[
        Union[dict[str, str], List[dict[str, str]], List[str], List[LoRARef]]
    ] = None
    max_loaded_loras: Optional[int] = None
    max_loras_per_batch: int = 8
    lora_backend: str = &#34;triton&#34;

    # Kernel backend
    attention_backend: Optional[str] = None
    decode_attention_backend: Optional[str] = None
    prefill_attention_backend: Optional[str] = None
    sampling_backend: Optional[str] = None
    grammar_backend: Optional[str] = None
    mm_attention_backend: Optional[str] = None

    # Speculative decoding
    speculative_algorithm: Optional[str] = None
    speculative_draft_model_path: Optional[str] = None
    speculative_num_steps: Optional[int] = None
    speculative_eagle_topk: Optional[int] = None
    speculative_num_draft_tokens: Optional[int] = None
    speculative_accept_threshold_single: float = 1.0
    speculative_accept_threshold_acc: float = 1.0
    speculative_token_map: Optional[str] = None

    # Expert parallelism
    ep_size: int = 1
    moe_a2a_backend: Literal[&#34;none&#34;, &#34;deepep&#34;] = &#34;none&#34;
    moe_runner_backend: Literal[
        &#34;auto&#34;,
        &#34;triton&#34;,
        &#34;triton_kernel&#34;,
        &#34;flashinfer_trtllm&#34;,
        &#34;flashinfer_cutlass&#34;,
        &#34;flashinfer_mxfp4&#34;,
    ] = &#34;auto&#34;
    flashinfer_mxfp4_moe_precision: Literal[&#34;default&#34;, &#34;bf16&#34;] = &#34;default&#34;
    enable_flashinfer_allreduce_fusion: bool = False
    deepep_mode: Literal[&#34;auto&#34;, &#34;normal&#34;, &#34;low_latency&#34;] = &#34;auto&#34;
    ep_num_redundant_experts: int = 0
    ep_dispatch_algorithm: Optional[Literal[&#34;static&#34;, &#34;dynamic&#34;, &#34;fake&#34;]] = None
    init_expert_location: str = &#34;trivial&#34;
    enable_eplb: bool = False
    eplb_algorithm: str = &#34;auto&#34;
    eplb_rebalance_num_iterations: int = 1000
    eplb_rebalance_layers_per_chunk: Optional[int] = None
    eplb_min_rebalancing_utilization_threshold: float = 1.0
    expert_distribution_recorder_mode: Optional[
        Literal[&#34;stat&#34;, &#34;stat_approx&#34;, &#34;per_pass&#34;, &#34;per_token&#34;]
    ] = None
    expert_distribution_recorder_buffer_size: Optional[int] = None
    enable_expert_distribution_metrics: bool = False
    deepep_config: Optional[str] = None
    moe_dense_tp_size: Optional[int] = None

    # Hierarchical cache
    enable_hierarchical_cache: bool = False
    hicache_ratio: float = 2.0
    hicache_size: int = 0
    hicache_write_policy: str = &#34;write_through&#34;
    hicache_io_backend: str = &#34;kernel&#34;
    hicache_mem_layout: str = &#34;layer_first&#34;
    hicache_storage_backend: Optional[str] = None
    hicache_storage_prefetch_policy: str = &#34;best_effort&#34;
    hicache_storage_backend_extra_config: Optional[str] = None

    # Double Sparsity
    enable_double_sparsity: bool = False
    ds_channel_config_path: Optional[str] = None
    ds_heavy_channel_num: int = 32
    ds_heavy_token_num: int = 256
    ds_heavy_channel_type: str = &#34;qk&#34;
    ds_sparse_decode_threshold: int = 4096

    # Offloading
    cpu_offload_gb: int = 0
    offload_group_size: int = -1
    offload_num_in_group: int = 1
    offload_prefetch_step: int = 1
    offload_mode: str = &#34;cpu&#34;

    # Optimization/debug options
    disable_radix_cache: bool = False
    cuda_graph_max_bs: Optional[int] = None
    cuda_graph_bs: Optional[List[int]] = None
    disable_cuda_graph: bool = False
    disable_cuda_graph_padding: bool = False
    enable_profile_cuda_graph: bool = False
    enable_cudagraph_gc: bool = False
    enable_nccl_nvls: bool = False
    enable_symm_mem: bool = False
    disable_flashinfer_cutlass_moe_fp4_allgather: bool = False
    enable_tokenizer_batch_encode: bool = False
    disable_outlines_disk_cache: bool = False
    disable_custom_all_reduce: bool = False
    enable_mscclpp: bool = False
    disable_overlap_schedule: bool = False
    enable_mixed_chunk: bool = False
    enable_dp_attention: bool = False
    enable_dp_lm_head: bool = False
    enable_two_batch_overlap: bool = False
    tbo_token_distribution_threshold: float = 0.48
    enable_torch_compile: bool = False
    torch_compile_max_bs: int = 32
    torchao_config: str = &#34;&#34;
    enable_nan_detection: bool = False
    enable_p2p_check: bool = False
    triton_attention_reduce_in_fp32: bool = False
    triton_attention_num_kv_splits: int = 8
    num_continuous_decode_steps: int = 1
    delete_ckpt_after_loading: bool = False
    enable_memory_saver: bool = False
    allow_auto_truncate: bool = False
    enable_custom_logit_processor: bool = False
    flashinfer_mla_disable_ragged: bool = False
    disable_shared_experts_fusion: bool = False
    disable_chunked_prefix_cache: bool = False
    disable_fast_image_processor: bool = False
    enable_return_hidden_states: bool = False
    scheduler_recv_interval: int = 1

    # Debug tensor dumps
    debug_tensor_dump_output_folder: Optional[str] = None
    debug_tensor_dump_input_file: Optional[str] = None
    debug_tensor_dump_inject: bool = False
    debug_tensor_dump_prefill_only: bool = False

    # PD disaggregation: can be &#34;null&#34; (not disaggregated), &#34;prefill&#34; (prefill-only), or &#34;decode&#34; (decode-only)
    disaggregation_mode: str = &#34;null&#34;
    disaggregation_transfer_backend: str = &#34;mooncake&#34;
    disaggregation_bootstrap_port: int = 8998
    disaggregation_decode_tp: Optional[int] = None
    disaggregation_decode_dp: Optional[int] = None
    disaggregation_prefill_pp: Optional[int] = 1
    disaggregation_ib_device: Optional[str] = None
    num_reserved_decode_tokens: int = 512  # used for decode kv cache offload in PD
    pdlb_url: Optional[str] = None

    # For model weight update
    custom_weight_loader: Optional[List[str]] = None
    weight_loader_disable_mmap: bool = False

    # For PD-Multiplexing
    enable_pdmux: bool = False
    sm_group_num: int = 3

    # Deprecated arguments
    enable_ep_moe: bool = False
    enable_deepep_moe: bool = False
    enable_flashinfer_cutlass_moe: bool = False
    enable_flashinfer_trtllm_moe: bool = False
    enable_triton_kernel_moe: bool = False
    enable_flashinfer_mxfp4_moe: bool = False

    def __post_init__(self):
        # Check deprecated arguments
        if self.enable_ep_moe:
            self.ep_size = self.tp_size
            print_deprecated_warning(
                &#34;NOTE: --enable-ep-moe is deprecated. Please set `--ep-size` to the same value as `--tp-size` instead.&#34;
            )
        if self.enable_deepep_moe:
            self.moe_a2a_backend = &#34;deepep&#34;
            print_deprecated_warning(
                &#34;NOTE: --enable-deepep-moe is deprecated. Please set `--moe-a2a-backend` to &#39;deepep&#39; instead.&#34;
            )
        if self.enable_triton_kernel_moe:
            self.moe_runner_backend = &#34;triton_kernel&#34;
            print_deprecated_warning(
                &#34;NOTE: --enable-triton-kernel-moe is deprecated. Please set `--moe-runner-backend` to &#39;triton_kernel&#39; instead.&#34;
            )
        if self.enable_flashinfer_cutlass_moe:
            self.moe_runner_backend = &#34;flashinfer_cutlass&#34;
            print_deprecated_warning(
                &#34;NOTE: --enable-flashinfer-cutlass-moe is deprecated. Please set `--moe-runner-backend` to &#39;flashinfer_cutlass&#39; instead.&#34;
            )
        if self.enable_flashinfer_trtllm_moe:
            self.moe_runner_backend = &#34;flashinfer_trtllm&#34;
            print_deprecated_warning(
                &#34;NOTE: --enable-flashinfer-trtllm-moe is deprecated. Please set `--moe-runner-backend` to &#39;flashinfer_trtllm&#39; instead.&#34;
            )
        if self.enable_flashinfer_mxfp4_moe:
            self.moe_runner_backend = &#34;flashinfer_mxfp4&#34;
            print_deprecated_warning(
                &#34;NOTE: --enable-flashinfer-mxfp4-moe is deprecated. Please set `--moe-runner-backend` to &#39;flashinfer_mxfp4&#39; instead.&#34;
            )

        # Set missing default values
        if self.tokenizer_path is None:
            self.tokenizer_path = self.model_path
        if self.served_model_name is None:
            self.served_model_name = self.model_path
        if self.device is None:
            self.device = get_device()
        if self.random_seed is None:
            self.random_seed = random.randint(0, 1 &lt;&lt; 30)

        gpu_mem = get_device_memory_capacity(self.device)

        # Set mem fraction static
        if self.mem_fraction_static is None:
            if gpu_mem is not None:
                # GPU memory capacity = model weights + KV cache pool + activations + cuda graph buffers
                # mem_fraction_static = (model weights + KV cache pool) / GPU memory capacity.

                # We want mem_fraction_static to be as large as possible but still has enough room
                # for activations and cuda graph buffers. We use the following heuristic to
                # compute the needed size for activations and cuda graph buffers:
                # - The size of the activation depends on the chunked_prefill_size and model size.
                # - The size of cuda graph buffers depends on the cuda graph capture range and model size.
                # For GPUs with more memory, we use a larger chunked_prefill_size and
                # capture more cuda graphs, so they need to reserve more memory.
                parallel_size = self.tp_size * self.pp_size

                if gpu_mem &lt; 20 * 1024:
                    # T4, 4080. (chunked_prefill_size 2k, cuda_graph_max_bs 8)
                    reserved_mem = (2.8 + parallel_size / 10) * 1024
                elif gpu_mem &lt; 35 * 1024:
                    # A10, L40, 4090, 5090. (chunked_prefill_size 2k, cuda_graph_max_bs 8)
                    reserved_mem = (2.8 + parallel_size / 10) * 1024
                elif gpu_mem &lt; 90 * 1024:
                    # H100, A100. (chunked_prefill_size 8k, cuda_graph_max_bs 160)
                    reserved_mem = (9.5 + parallel_size / 2) * 1024
                elif gpu_mem &lt; 100 * 1024:
                    # H20. (chunked_prefill_size 8k, cuda_graph_max_bs 256)
                    reserved_mem = (12 + parallel_size / 2) * 1024
                elif gpu_mem &lt; 160 * 1024:
                    # H200. (chunked_prefill_size 8k, cuda_graph_max_bs 256)
                    reserved_mem = (12 + parallel_size / 2) * 1024
                else:
                    # B200, MI300. (chunked_prefill_size 16k, cuda_graph_max_bs 512)
                    reserved_mem = 32 * 1024

                if self.speculative_algorithm is not None:
                    # draft model and larger cuda graph buffers
                    reserved_mem += 2 * 1024
                if self.enable_dp_attention:
                    reserved_mem += 4 * 1024

                self.mem_fraction_static = round((gpu_mem - reserved_mem) / gpu_mem, 3)
            else:
                self.mem_fraction_static = 0.88

            # Lazy init to avoid circular import
            # Multimodal models need more memory for the image processor
            from sglang.srt.configs.model_config import ModelConfig

            model_config = ModelConfig.from_server_args(self)
            if model_config.is_multimodal:
                self.adjust_mem_fraction_for_vlm(model_config)

        # Set chunked prefill size, which depends on the gpu memory capacity
        if self.chunked_prefill_size is None:
            if gpu_mem is not None:
                if gpu_mem &lt; 35 * 1024:  # A10, L40, 4090
                    self.chunked_prefill_size = 2048
                elif gpu_mem &lt; 160 * 1024:  # H100, H200, A100, H20
                    self.chunked_prefill_size = 8192
                else:  # B200, MI300
                    self.chunked_prefill_size = 16384
            else:
                self.chunked_prefill_size = 4096

        # Set cuda graph max batch size
        if self.cuda_graph_max_bs is None:
            # Based on detailed statistics, when serving TP1/TP2 models on lower-end GPUs with HBM&lt;25G, you can either disable cuda graph or set `cuda_graph_max_bs` to a very small value to reduce the memory overhead of creating cuda graphs, with almost no impact on performance. However, when serving models with TP4 or TP8, we need to enable cuda graph to maintain high performance. In this case, we can set `cuda_graph_max_bs` to 80 (half of the default value 160) to reduce the memory overhead of creating cuda graphs. Looking at the logs from TP4 serving of qwen2-72b, a value of 80 is sufficient and can reduce the memory overhead of creating cuda graphs on lower-end GPUs compared to the original 160, avoiding OOM issues.
            if gpu_mem is not None and gpu_mem &lt; 35 * 1024:
                if self.tp_size &lt; 4:
                    self.cuda_graph_max_bs = 8
                else:
                    self.cuda_graph_max_bs = 80

        # Set kernel backends for hpu device
        if self.device == &#34;hpu&#34;:
            self.attention_backend = &#34;torch_native&#34;
            self.sampling_backend = &#34;pytorch&#34;

        # Model-specific adjustments
        self.model_specific_adjustments()

        # Set kernel backends
        if self.device == &#34;cpu&#34;:
            if self.attention_backend is None:
                self.attention_backend = &#34;intel_amx&#34;
            self.sampling_backend = &#34;pytorch&#34;

        if self.sampling_backend is None:
            self.sampling_backend = (
                &#34;flashinfer&#34; if is_flashinfer_available() else &#34;pytorch&#34;
            )

        if self.attention_backend == &#34;torch_native&#34;:
            logger.warning(
                &#34;Cuda graph is disabled because of using torch native attention backend&#34;
            )
            self.disable_cuda_graph = True

        if self.attention_backend == &#34;ascend&#34;:
            logger.warning(
                &#34;At this moment Ascend attention backend only supports a page_size of 128, change page_size to 128.&#34;
            )
            self.page_size = 128

        if (
            self.attention_backend == &#34;flashmla&#34;
            or self.decode_attention_backend == &#34;flashmla&#34;
        ):
            logger.warning(
                &#34;FlashMLA only supports a page_size of 64, change page_size to 64.&#34;
            )
            self.page_size = 64

        if (
            self.attention_backend == &#34;cutlass_mla&#34;
            or self.decode_attention_backend == &#34;cutlass_mla&#34;
        ):
            logger.warning(
                &#34;Cutlass MLA only supports a page_size of 128, change page_size to 128.&#34;
            )
            self.page_size = 128

        if (
            self.attention_backend == &#34;trtllm_mla&#34;
            or self.decode_attention_backend == &#34;trtllm_mla&#34;
        ):
            if not is_sm100_supported():
                raise ValueError(
                    &#34;TRTLLM MLA backend is only supported on Blackwell GPUs (SM100). Please use a different backend.&#34;
                )

            if self.page_size not in [32, 64]:
                logger.warning(
                    f&#34;TensorRT-LLM MLA only supports page_size of 32 or 64, changing page_size from {self.page_size} to 64.&#34;
                )
                self.page_size = 64

            if self.kv_cache_dtype not in [&#34;fp8_e4m3&#34;, &#34;auto&#34;]:
                raise ValueError(
                    &#34;TensorRT-LLM MLA backend only supports kv-cache-dtype of fp8_e4m3 or auto.&#34;
                )

        if (
            self.attention_backend == &#34;trtllm_mha&#34;
            or self.decode_attention_backend == &#34;trtllm_mha&#34;
            or self.prefill_attention_backend == &#34;trtllm_mha&#34;
        ):
            if not is_sm100_supported():
                raise ValueError(
                    &#34;TRTLLM MHA backend is only supported on Blackwell GPUs (SM100). Please use a different backend.&#34;
                )

            if self.page_size not in [16, 32, 64]:
                logger.warning(
                    f&#34;TensorRT-LLM MHA only supports page_size of 16, 32 or 64, changing page_size from {self.page_size} to 64.&#34;
                )
                self.page_size = 64

        if self.attention_backend == &#34;dual_chunk_flash_attn&#34;:
            logger.warning(
                &#34;Mixed chunk, radix cache, and cuda graphs are disabled because of using dual chunk flash attention backend&#34;
            )
            self.enable_mixed_chunk = False
            self.disable_cuda_graph = True
            self.disable_radix_cache = True

        # Set page size
        if self.page_size is None:
            self.page_size = 1

        # AMD-specific Triton attention KV splits default number
        if is_hip():
            self.triton_attention_num_kv_splits = 16

        # Choose grammar backend
        if self.grammar_backend is None:
            self.grammar_backend = &#34;xgrammar&#34;

        # Data parallelism attention
        if self.enable_dp_attention:
            self.schedule_conservativeness = self.schedule_conservativeness * 0.3
            assert (
                self.dp_size &gt; 1
            ), &#34;Please set a dp-size &gt; 1. You can use 1 &lt; dp-size &lt;= tp-size &#34;
            assert self.tp_size % self.dp_size == 0
            self.chunked_prefill_size = self.chunked_prefill_size // self.dp_size
            logger.warning(
                f&#34;DP attention is enabled. The chunked prefill size is adjusted to {self.chunked_prefill_size} to avoid MoE kernel issues. &#34;
            )

        if self.enable_dp_lm_head:
            assert (
                self.enable_dp_attention
            ), &#34;Please enable dp attention when setting enable_dp_lm_head. &#34;

        # MoE kernel
        if self.moe_runner_backend == &#34;flashinfer_cutlass&#34;:
            assert (
                self.quantization == &#34;modelopt_fp4&#34;
            ), &#34;modelopt_fp4 quantization is required for Flashinfer MOE&#34;
            assert self.ep_size in [
                1,
                self.tp_size,
            ], &#34;The expert parallel size must be 1 or the same as the tensor parallel size&#34;

        if self.moe_runner_backend == &#34;flashinfer_trtllm&#34;:
            if not self.disable_shared_experts_fusion:
                self.disable_shared_experts_fusion = True
                logger.warning(
                    &#34;FlashInfer TRTLLM MoE is enabled. --disable-shared-experts-fusion is automatically set.&#34;
                )

        # DeepEP MoE
        if self.moe_a2a_backend == &#34;deepep&#34;:
            if self.deepep_mode == &#34;normal&#34;:
                logger.warning(&#34;Cuda graph is disabled because deepep_mode=`normal`&#34;)
                self.disable_cuda_graph = True
            self.ep_size = self.tp_size
            logger.warning(
                f&#34;DeepEP MoE is enabled. The expert parallel size is adjusted to be the same as the tensor parallel size[{self.tp_size}].&#34;
            )

        if self.enable_eplb and (self.expert_distribution_recorder_mode is None):
            self.expert_distribution_recorder_mode = &#34;stat&#34;
            logger.warning(
                &#34;EPLB is enabled. The expert_distribution_recorder_mode is automatically set.&#34;
            )

        if (self.enable_eplb or (self.init_expert_location is not None)) and (
            self.ep_dispatch_algorithm is None
        ):
            self.ep_dispatch_algorithm = &#34;static&#34;

        if self.enable_eplb:
            assert self.ep_size &gt; 1

        if self.enable_expert_distribution_metrics and (
            self.expert_distribution_recorder_mode is None
        ):
            self.expert_distribution_recorder_mode = &#34;stat&#34;

        if self.expert_distribution_recorder_buffer_size is None:
            if (x := self.eplb_rebalance_num_iterations) is not None:
                self.expert_distribution_recorder_buffer_size = x
            elif self.expert_distribution_recorder_mode is not None:
                self.expert_distribution_recorder_buffer_size = 1000

        # Pipeline parallelism
        if self.pp_size &gt; 1:
            self.disable_overlap_schedule = True
            logger.warning(
                &#34;Pipeline parallelism is incompatible with overlap schedule.&#34;
            )

        # Hicache
        if self.hicache_storage_backend == &#34;mooncake&#34;:
            # to use mooncake storage backend, the following conditions must be met:
            self.hicache_io_backend = &#34;kernel&#34;
            self.hicache_mem_layout = &#34;page_first&#34;

        # Speculative Decoding
        if self.speculative_algorithm == &#34;NEXTN&#34;:
            # NEXTN shares the same implementation of EAGLE
            self.speculative_algorithm = &#34;EAGLE&#34;

        if self.speculative_algorithm in (&#34;EAGLE&#34;, &#34;EAGLE3&#34;):
            if self.max_running_requests is None:
                self.max_running_requests = 48
            self.disable_overlap_schedule = True
            logger.warning(
                &#34;Overlap scheduler is disabled because of using &#34;
                &#34;eagle speculative decoding.&#34;
            )
            if self.enable_mixed_chunk:
                self.enable_mixed_chunk = False
                logger.warning(
                    &#34;Mixed chunked prefill is disabled because of using &#34;
                    &#34;eagle speculative decoding.&#34;
                )

            model_arch = self.get_hf_config().architectures[0]
            if model_arch in [&#34;DeepseekV3ForCausalLM&#34;, &#34;Glm4MoeForCausalLM&#34;]:
                # Auto set draft_model_path DeepSeek-V3/R1
                if self.speculative_draft_model_path is None:
                    self.speculative_draft_model_path = self.model_path
                else:
                    logger.warning(
                        &#34;DeepSeek MTP does not require setting speculative_draft_model_path.&#34;
                    )

            # Auto choose parameters
            if self.speculative_num_steps is None:
                assert (
                    self.speculative_eagle_topk is None
                    and self.speculative_num_draft_tokens is None
                )
                (
                    self.speculative_num_steps,
                    self.speculative_eagle_topk,
                    self.speculative_num_draft_tokens,
                ) = auto_choose_speculative_params(self)

            if (
                self.attention_backend == &#34;trtllm_mha&#34;
                or self.decode_attention_backend == &#34;trtllm_mha&#34;
                or self.prefill_attention_backend == &#34;trtllm_mha&#34;
            ):
                if self.speculative_eagle_topk &gt; 1:
                    raise ValueError(
                        &#34;trtllm_mha backend only supports topk = 1 for speculative decoding.&#34;
                    )

            if (
                self.speculative_eagle_topk == 1
                and self.speculative_num_draft_tokens != self.speculative_num_steps + 1
            ):
                logger.warning(
                    &#34;speculative_num_draft_tokens is adjusted to speculative_num_steps + 1 when speculative_eagle_topk == 1&#34;
                )
                self.speculative_num_draft_tokens = self.speculative_num_steps + 1

            if (
                self.speculative_eagle_topk &gt; 1
                and self.page_size &gt; 1
                and self.attention_backend != &#34;flashinfer&#34;
            ):
                raise ValueError(
                    &#34;speculative_eagle_topk &gt; 1 with page_size &gt; 1 is unstable and produces incorrect results for paged attention backends. This combination is only supported for the &#39;flashinfer&#39; backend.&#34;
                )

            # The token generated from the verify step is counted.
            # If sepculative_num_steps &gt;= speculative_num_draft_tokens, the additional tokens will definitely be discarded.
            # assert self.speculative_num_steps &lt; self.speculative_num_draft_tokens

        # GGUF
        if (
            self.load_format == &#34;auto&#34; or self.load_format == &#34;gguf&#34;
        ) and check_gguf_file(self.model_path):
            self.quantization = self.load_format = &#34;gguf&#34;

        # Model loading
        if is_remote_url(self.model_path):
            self.load_format = &#34;remote&#34;
        if self.custom_weight_loader is None:
            self.custom_weight_loader = []

        # PD disaggregation
        if self.disaggregation_mode == &#34;decode&#34;:
            assert (
                self.disaggregation_decode_tp is None
            ), &#34;Cannot set --disaggregation-decode-tp for the decode engine.&#34;
            assert (
                self.disaggregation_decode_dp is None
            ), &#34;Cannot set --disaggregation-decode-dp for the decode engine.&#34;

            self.disable_radix_cache = True
            logger.warning(&#34;KV cache is forced as chunk cache for decode server&#34;)
        elif self.disaggregation_mode == &#34;prefill&#34;:
            if self.disaggregation_decode_tp is None:
                self.disaggregation_decode_tp = self.tp_size
            if self.disaggregation_decode_dp is None:
                self.disaggregation_decode_dp = self.dp_size

            self.disaggregation_prefill_pp = self.pp_size
            self.validate_disagg_tp_size(self.tp_size, self.disaggregation_decode_tp)

            self.disable_cuda_graph = True
            logger.warning(&#34;Cuda graph is disabled for prefill server&#34;)

        # Propagate env vars
        os.environ[&#34;SGLANG_ENABLE_TORCH_COMPILE&#34;] = (
            &#34;1&#34; if self.enable_torch_compile else &#34;0&#34;
        )
        # Set env var before grammar backends init
        os.environ[&#34;SGLANG_DISABLE_OUTLINES_DISK_CACHE&#34;] = (
            &#34;1&#34; if self.disable_outlines_disk_cache else &#34;0&#34;
        )

        if self.enable_hierarchical_cache and self.disable_radix_cache:
            raise ValueError(
                &#34;The arguments enable-hierarchical-cache and disable-radix-cache are mutually exclusive &#34;
                &#34;and cannot be used at the same time. Please use only one of them.&#34;
            )

    @staticmethod
    def add_cli_args(parser: argparse.ArgumentParser):
        # Model and tokenizer
        parser.add_argument(
            &#34;--model-path&#34;,
            &#34;--model&#34;,
            type=str,
            help=&#34;The path of the model weights. This can be a local folder or a Hugging Face repo ID.&#34;,
            required=True,
        )
        parser.add_argument(
            &#34;--tokenizer-path&#34;,
            type=str,
            default=ServerArgs.tokenizer_path,
            help=&#34;The path of the tokenizer.&#34;,
        )
        parser.add_argument(
            &#34;--tokenizer-mode&#34;,
            type=str,
            default=ServerArgs.tokenizer_mode,
            choices=[&#34;auto&#34;, &#34;slow&#34;],
            help=&#34;Tokenizer mode. &#39;auto&#39; will use the fast &#34;
            &#34;tokenizer if available, and &#39;slow&#39; will &#34;
            &#34;always use the slow tokenizer.&#34;,
        )
        parser.add_argument(
            &#34;--skip-tokenizer-init&#34;,
            action=&#34;store_true&#34;,
            help=&#34;If set, skip init tokenizer and pass input_ids in generate request.&#34;,
        )
        parser.add_argument(
            &#34;--load-format&#34;,
            type=str,
            default=ServerArgs.load_format,
            choices=LOAD_FORMAT_CHOICES,
            help=&#34;The format of the model weights to load. &#34;
            &#39;&#34;auto&#34; will try to load the weights in the safetensors format &#39;
            &#34;and fall back to the pytorch bin format if safetensors format &#34;
            &#34;is not available. &#34;
            &#39;&#34;pt&#34; will load the weights in the pytorch bin format. &#39;
            &#39;&#34;safetensors&#34; will load the weights in the safetensors format. &#39;
            &#39;&#34;npcache&#34; will load the weights in pytorch format and store &#39;
            &#34;a numpy cache to speed up the loading. &#34;
            &#39;&#34;dummy&#34; will initialize the weights with random values, &#39;
            &#34;which is mainly for profiling.&#34;
            &#39;&#34;gguf&#34; will load the weights in the gguf format. &#39;
            &#39;&#34;bitsandbytes&#34; will load the weights using bitsandbytes &#39;
            &#34;quantization.&#34;
            &#39;&#34;layered&#34; loads weights layer by layer so that one can quantize a &#39;
            &#34;layer before loading another to make the peak memory envelope &#34;
            &#34;smaller.&#34;,
        )
        parser.add_argument(
            &#34;--model-loader-extra-config&#34;,
            type=str,
            help=&#34;Extra config for model loader. &#34;
            &#34;This will be passed to the model loader corresponding to the chosen load_format.&#34;,
            default=ServerArgs.model_loader_extra_config,
        )
        parser.add_argument(
            &#34;--trust-remote-code&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Whether or not to allow for custom models defined on the Hub in their own modeling files.&#34;,
        )
        parser.add_argument(
            &#34;--context-length&#34;,
            type=int,
            default=ServerArgs.context_length,
            help=&#34;The model&#39;s maximum context length. Defaults to None (will use the value from the model&#39;s config.json instead).&#34;,
        )
        parser.add_argument(
            &#34;--is-embedding&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Whether to use a CausalLM as an embedding model.&#34;,
        )
        parser.add_argument(
            &#34;--enable-multimodal&#34;,
            default=ServerArgs.enable_multimodal,
            action=&#34;store_true&#34;,
            help=&#34;Enable the multimodal functionality for the served model. If the model being served is not multimodal, nothing will happen&#34;,
        )
        parser.add_argument(
            &#34;--revision&#34;,
            type=str,
            default=None,
            help=&#34;The specific model version to use. It can be a branch &#34;
            &#34;name, a tag name, or a commit id. If unspecified, will use &#34;
            &#34;the default version.&#34;,
        )
        parser.add_argument(
            &#34;--model-impl&#34;,
            type=str,
            default=ServerArgs.model_impl,
            help=&#34;Which implementation of the model to use.\n\n&#34;
            &#39;* &#34;auto&#34; will try to use the SGLang implementation if it exists &#39;
            &#34;and fall back to the Transformers implementation if no SGLang &#34;
            &#34;implementation is available.\n&#34;
            &#39;* &#34;sglang&#34; will use the SGLang model implementation.\n&#39;
            &#39;* &#34;transformers&#34; will use the Transformers model &#39;
            &#34;implementation.\n&#34;,
        )

        # HTTP server
        parser.add_argument(
            &#34;--host&#34;,
            type=str,
            default=ServerArgs.host,
            help=&#34;The host of the HTTP server.&#34;,
        )
        parser.add_argument(
            &#34;--port&#34;,
            type=int,
            default=ServerArgs.port,
            help=&#34;The port of the HTTP server.&#34;,
        )
        parser.add_argument(
            &#34;--skip-server-warmup&#34;,
            action=&#34;store_true&#34;,
            help=&#34;If set, skip warmup.&#34;,
        )
        parser.add_argument(
            &#34;--warmups&#34;,
            type=str,
            required=False,
            help=&#34;Specify custom warmup functions (csv) to run before server starts eg. --warmups=warmup_name1,warmup_name2 &#34;
            &#34;will run the functions `warmup_name1` and `warmup_name2` specified in warmup.py before the server starts listening for requests&#34;,
        )
        parser.add_argument(
            &#34;--nccl-port&#34;,
            type=int,
            default=ServerArgs.nccl_port,
            help=&#34;The port for NCCL distributed environment setup. Defaults to a random port.&#34;,
        )

        # Quantization and data type
        parser.add_argument(
            &#34;--dtype&#34;,
            type=str,
            default=ServerArgs.dtype,
            choices=[&#34;auto&#34;, &#34;half&#34;, &#34;float16&#34;, &#34;bfloat16&#34;, &#34;float&#34;, &#34;float32&#34;],
            help=&#34;Data type for model weights and activations.\n\n&#34;
            &#39;* &#34;auto&#34; will use FP16 precision for FP32 and FP16 models, and &#39;
            &#34;BF16 precision for BF16 models.\n&#34;
            &#39;* &#34;half&#34; for FP16. Recommended for AWQ quantization.\n&#39;
            &#39;* &#34;float16&#34; is the same as &#34;half&#34;.\n&#39;
            &#39;* &#34;bfloat16&#34; for a balance between precision and range.\n&#39;
            &#39;* &#34;float&#34; is shorthand for FP32 precision.\n&#39;
            &#39;* &#34;float32&#34; for FP32 precision.&#39;,
        )
        parser.add_argument(
            &#34;--quantization&#34;,
            type=str,
            default=ServerArgs.quantization,
            choices=QUANTIZATION_CHOICES,
            help=&#34;The quantization method.&#34;,
        )
        parser.add_argument(
            &#34;--quantization-param-path&#34;,
            type=nullable_str,
            default=None,
            help=&#34;Path to the JSON file containing the KV cache &#34;
            &#34;scaling factors. This should generally be supplied, when &#34;
            &#34;KV cache dtype is FP8. Otherwise, KV cache scaling factors &#34;
            &#34;default to 1.0, which may cause accuracy issues. &#34;,
        )
        parser.add_argument(
            &#34;--kv-cache-dtype&#34;,
            type=str,
            default=ServerArgs.kv_cache_dtype,
            choices=[&#34;auto&#34;, &#34;fp8_e5m2&#34;, &#34;fp8_e4m3&#34;],
            help=&#39;Data type for kv cache storage. &#34;auto&#34; will use model data type. &#34;fp8_e5m2&#34; and &#34;fp8_e4m3&#34; is supported for CUDA 11.8+.&#39;,
        )

        # Memory and scheduling
        parser.add_argument(
            &#34;--mem-fraction-static&#34;,
            type=float,
            default=ServerArgs.mem_fraction_static,
            help=&#34;The fraction of the memory used for static allocation (model weights and KV cache memory pool). Use a smaller value if you see out-of-memory errors.&#34;,
        )
        parser.add_argument(
            &#34;--max-running-requests&#34;,
            type=int,
            default=ServerArgs.max_running_requests,
            help=&#34;The maximum number of running requests.&#34;,
        )
        parser.add_argument(
            &#34;--max-queued-requests&#34;,
            type=int,
            default=ServerArgs.max_queued_requests,
            help=&#34;The maximum number of queued requests. This option is ignored when using disaggregation-mode.&#34;,
        )
        parser.add_argument(
            &#34;--max-total-tokens&#34;,
            type=int,
            default=ServerArgs.max_total_tokens,
            help=&#34;The maximum number of tokens in the memory pool. If not specified, it will be automatically calculated based on the memory usage fraction. &#34;
            &#34;This option is typically used for development and debugging purposes.&#34;,
        )
        parser.add_argument(
            &#34;--chunked-prefill-size&#34;,
            type=int,
            default=ServerArgs.chunked_prefill_size,
            help=&#34;The maximum number of tokens in a chunk for the chunked prefill. Setting this to -1 means disabling chunked prefill.&#34;,
        )
        parser.add_argument(
            &#34;--max-prefill-tokens&#34;,
            type=int,
            default=ServerArgs.max_prefill_tokens,
            help=&#34;The maximum number of tokens in a prefill batch. The real bound will be the maximum of this value and the model&#39;s maximum context length.&#34;,
        )
        parser.add_argument(
            &#34;--schedule-policy&#34;,
            type=str,
            default=ServerArgs.schedule_policy,
            choices=[&#34;lpm&#34;, &#34;random&#34;, &#34;fcfs&#34;, &#34;dfs-weight&#34;, &#34;lof&#34;],
            help=&#34;The scheduling policy of the requests.&#34;,
        )
        parser.add_argument(
            &#34;--schedule-conservativeness&#34;,
            type=float,
            default=ServerArgs.schedule_conservativeness,
            help=&#34;How conservative the schedule policy is. A larger value means more conservative scheduling. Use a larger value if you see requests being retracted frequently.&#34;,
        )
        parser.add_argument(
            &#34;--page-size&#34;,
            type=int,
            default=ServerArgs.page_size,
            help=&#34;The number of tokens in a page.&#34;,
        )
        parser.add_argument(
            &#34;--hybrid-kvcache-ratio&#34;,
            nargs=&#34;?&#34;,
            const=0.5,
            type=float,
            default=ServerArgs.hybrid_kvcache_ratio,
            help=(
                &#34;Mix ratio in [0,1] between uniform and hybrid kv buffers &#34;
                &#34;(0.0 = pure uniform: swa_size / full_size = 1)&#34;
                &#34;(1.0 = pure hybrid: swa_size / full_size = local_attention_size / context_length)&#34;
            ),
        )
        parser.add_argument(
            &#34;--swa-full-tokens-ratio&#34;,
            type=float,
            default=ServerArgs.swa_full_tokens_ratio,
            help=&#34;The ratio of SWA layer KV tokens / full layer KV tokens, regardless of the number of swa:full layers. It should be between 0 and 1. &#34;
            &#34;E.g. 0.5 means if each swa layer has 50 tokens, then each full layer has 100 tokens.&#34;,
        )
        parser.add_argument(
            &#34;--disable-hybrid-swa-memory&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Disable the hybrid SWA memory.&#34;,
        )

        # Runtime options
        parser.add_argument(
            &#34;--device&#34;,
            type=str,
            default=ServerArgs.device,
            help=&#34;The device to use (&#39;cuda&#39;, &#39;xpu&#39;, &#39;hpu&#39;, &#39;npu&#39;, &#39;cpu&#39;). Defaults to auto-detection if not specified.&#34;,
        )
        parser.add_argument(
            &#34;--tensor-parallel-size&#34;,
            &#34;--tp-size&#34;,
            type=int,
            default=ServerArgs.tp_size,
            help=&#34;The tensor parallelism size.&#34;,
        )
        parser.add_argument(
            &#34;--pipeline-parallel-size&#34;,
            &#34;--pp-size&#34;,
            type=int,
            default=ServerArgs.pp_size,
            help=&#34;The pipeline parallelism size.&#34;,
        )
        parser.add_argument(
            &#34;--max-micro-batch-size&#34;,
            type=int,
            default=ServerArgs.max_micro_batch_size,
            help=&#34;The maximum micro batch size in pipeline parallelism.&#34;,
        )
        parser.add_argument(
            &#34;--stream-interval&#34;,
            type=int,
            default=ServerArgs.stream_interval,
            help=&#34;The interval (or buffer size) for streaming in terms of the token length. A smaller value makes streaming smoother, while a larger value makes the throughput higher&#34;,
        )
        parser.add_argument(
            &#34;--stream-output&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Whether to output as a sequence of disjoint segments.&#34;,
        )
        parser.add_argument(
            &#34;--random-seed&#34;,
            type=int,
            default=ServerArgs.random_seed,
            help=&#34;The random seed.&#34;,
        )
        parser.add_argument(
            &#34;--constrained-json-whitespace-pattern&#34;,
            type=str,
            default=ServerArgs.constrained_json_whitespace_pattern,
            help=&#34;(outlines backend only) Regex pattern for syntactic whitespaces allowed in JSON constrained output. For example, to allow the model generate consecutive whitespaces, set the pattern to [\n\t ]*&#34;,
        )
        parser.add_argument(
            &#34;--watchdog-timeout&#34;,
            type=float,
            default=ServerArgs.watchdog_timeout,
            help=&#34;Set watchdog timeout in seconds. If a forward batch takes longer than this, the server will crash to prevent hanging.&#34;,
        )
        parser.add_argument(
            &#34;--dist-timeout&#34;,
            type=int,
            default=ServerArgs.dist_timeout,
            help=&#34;Set timeout for torch.distributed initialization.&#34;,
        )
        parser.add_argument(
            &#34;--download-dir&#34;,
            type=str,
            default=ServerArgs.download_dir,
            help=&#34;Model download directory for huggingface.&#34;,
        )
        parser.add_argument(
            &#34;--base-gpu-id&#34;,
            type=int,
            default=ServerArgs.base_gpu_id,
            help=&#34;The base GPU ID to start allocating GPUs from. Useful when running multiple instances on the same machine.&#34;,
        )
        parser.add_argument(
            &#34;--gpu-id-step&#34;,
            type=int,
            default=ServerArgs.gpu_id_step,
            help=&#34;The delta between consecutive GPU IDs that are used. For example, setting it to 2 will use GPU 0,2,4,...&#34;,
        )
        parser.add_argument(
            &#34;--sleep-on-idle&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Reduce CPU usage when sglang is idle.&#34;,
        )

        # Logging
        parser.add_argument(
            &#34;--log-level&#34;,
            type=str,
            default=ServerArgs.log_level,
            help=&#34;The logging level of all loggers.&#34;,
        )
        parser.add_argument(
            &#34;--log-level-http&#34;,
            type=str,
            default=ServerArgs.log_level_http,
            help=&#34;The logging level of HTTP server. If not set, reuse --log-level by default.&#34;,
        )
        parser.add_argument(
            &#34;--log-requests&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Log metadata, inputs, outputs of all requests. The verbosity is decided by --log-requests-level&#34;,
        )
        parser.add_argument(
            &#34;--log-requests-level&#34;,
            type=int,
            default=ServerArgs.log_requests_level,
            help=&#34;0: Log metadata (no sampling parameters). 1: Log metadata and sampling parameters. 2: Log metadata, sampling parameters and partial input/output. 3: Log every input/output.&#34;,
            choices=[0, 1, 2, 3],
        )
        parser.add_argument(
            &#34;--crash-dump-folder&#34;,
            type=str,
            default=ServerArgs.crash_dump_folder,
            help=&#34;Folder path to dump requests from the last 5 min before a crash (if any). If not specified, crash dumping is disabled.&#34;,
        )
        parser.add_argument(
            &#34;--show-time-cost&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Show time cost of custom marks.&#34;,
        )
        parser.add_argument(
            &#34;--enable-metrics&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Enable log prometheus metrics.&#34;,
        )
        parser.add_argument(
            &#34;--enable-metrics-for-all-schedulers&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Enable --enable-metrics-for-all-schedulers when you want schedulers on all TP ranks (not just TP 0) &#34;
            &#34;to record request metrics separately. This is especially useful when dp_attention is enabled, as &#34;
            &#34;otherwise all metrics appear to come from TP 0.&#34;,
        )
        parser.add_argument(
            &#34;--bucket-time-to-first-token&#34;,
            type=float,
            nargs=&#34;+&#34;,
            default=ServerArgs.bucket_time_to_first_token,
            help=&#34;The buckets of time to first token, specified as a list of floats.&#34;,
        )
        parser.add_argument(
            &#34;--bucket-inter-token-latency&#34;,
            type=float,
            nargs=&#34;+&#34;,
            default=ServerArgs.bucket_inter_token_latency,
            help=&#34;The buckets of inter-token latency, specified as a list of floats.&#34;,
        )
        parser.add_argument(
            &#34;--bucket-e2e-request-latency&#34;,
            type=float,
            nargs=&#34;+&#34;,
            default=ServerArgs.bucket_e2e_request_latency,
            help=&#34;The buckets of end-to-end request latency, specified as a list of floats.&#34;,
        )
        parser.add_argument(
            &#34;--collect-tokens-histogram&#34;,
            action=&#34;store_true&#34;,
            default=ServerArgs.collect_tokens_histogram,
            help=&#34;Collect prompt/generation tokens histogram.&#34;,
        )
        parser.add_argument(
            &#34;--gc-warning-threshold-secs&#34;,
            type=float,
            default=ServerArgs.gc_warning_threshold_secs,
            help=&#34;The threshold for long GC warning. If a GC takes longer than this, a warning will be logged. Set to 0 to disable.&#34;,
        )
        parser.add_argument(
            &#34;--decode-log-interval&#34;,
            type=int,
            default=ServerArgs.decode_log_interval,
            help=&#34;The log interval of decode batch.&#34;,
        )
        parser.add_argument(
            &#34;--enable-request-time-stats-logging&#34;,
            action=&#34;store_true&#34;,
            default=ServerArgs.enable_request_time_stats_logging,
            help=&#34;Enable per request time stats logging&#34;,
        )
        parser.add_argument(
            &#34;--kv-events-config&#34;,
            type=str,
            default=None,
            help=&#34;Config in json format for NVIDIA dynamo KV event publishing. Publishing will be enabled if this flag is used.&#34;,
        )

        # API related
        parser.add_argument(
            &#34;--api-key&#34;,
            type=str,
            default=ServerArgs.api_key,
            help=&#34;Set API key of the server. It is also used in the OpenAI API compatible server.&#34;,
        )
        parser.add_argument(
            &#34;--served-model-name&#34;,
            type=str,
            default=ServerArgs.served_model_name,
            help=&#34;Override the model name returned by the v1/models endpoint in OpenAI API server.&#34;,
        )
        parser.add_argument(
            &#34;--weight-version&#34;,
            type=str,
            default=ServerArgs.weight_version,
            help=&#34;Version identifier for the model weights. Defaults to &#39;default&#39; if not specified.&#34;,
        )
        parser.add_argument(
            &#34;--chat-template&#34;,
            type=str,
            default=ServerArgs.chat_template,
            help=&#34;The buliltin chat template name or the path of the chat template file. This is only used for OpenAI-compatible API server.&#34;,
        )
        parser.add_argument(
            &#34;--completion-template&#34;,
            type=str,
            default=ServerArgs.completion_template,
            help=&#34;The buliltin completion template name or the path of the completion template file. This is only used for OpenAI-compatible API server. only for code completion currently.&#34;,
        )
        parser.add_argument(
            &#34;--file-storage-path&#34;,
            type=str,
            default=ServerArgs.file_storage_path,
            help=&#34;The path of the file storage in backend.&#34;,
        )
        parser.add_argument(
            &#34;--enable-cache-report&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Return number of cached tokens in usage.prompt_tokens_details for each openai request.&#34;,
        )
        parser.add_argument(
            &#34;--reasoning-parser&#34;,
            type=str,
            choices=list(ReasoningParser.DetectorMap.keys()),
            default=ServerArgs.reasoning_parser,
            help=f&#34;Specify the parser for reasoning models, supported parsers are: {list(ReasoningParser.DetectorMap.keys())}.&#34;,
        )
        tool_call_parser_choices = list(FunctionCallParser.ToolCallParserEnum.keys())
        parser.add_argument(
            &#34;--tool-call-parser&#34;,
            type=str,
            choices=tool_call_parser_choices,
            default=ServerArgs.tool_call_parser,
            help=f&#34;Specify the parser for handling tool-call interactions. Options include: {tool_call_parser_choices}.&#34;,
        )
        parser.add_argument(
            &#34;--tool-server&#34;,
            type=str,
            default=None,
            help=&#34;Either &#39;demo&#39; or a comma-separated list of tool server urls to use for the model. If not specified, no tool server will be used.&#34;,
        )

        # Data parallelism
        parser.add_argument(
            &#34;--data-parallel-size&#34;,
            &#34;--dp-size&#34;,
            type=int,
            default=ServerArgs.dp_size,
            help=&#34;The data parallelism size.&#34;,
        )
        parser.add_argument(
            &#34;--load-balance-method&#34;,
            type=str,
            default=ServerArgs.load_balance_method,
            help=&#34;The load balancing strategy for data parallelism.&#34;,
            choices=[
                &#34;round_robin&#34;,
                &#34;shortest_queue&#34;,
                &#34;minimum_tokens&#34;,
            ],
        )

        # Multi-node distributed serving
        parser.add_argument(
            &#34;--dist-init-addr&#34;,
            &#34;--nccl-init-addr&#34;,  # For backward compatibility. This will be removed in the future.
            type=str,
            help=&#34;The host address for initializing distributed backend (e.g., `192.168.0.2:25000`).&#34;,
        )
        parser.add_argument(
            &#34;--nnodes&#34;, type=int, default=ServerArgs.nnodes, help=&#34;The number of nodes.&#34;
        )
        parser.add_argument(
            &#34;--node-rank&#34;, type=int, default=ServerArgs.node_rank, help=&#34;The node rank.&#34;
        )

        # Model override args
        parser.add_argument(
            &#34;--json-model-override-args&#34;,
            type=str,
            help=&#34;A dictionary in JSON string format used to override default model configurations.&#34;,
            default=ServerArgs.json_model_override_args,
        )
        parser.add_argument(
            &#34;--preferred-sampling-params&#34;,
            type=str,
            help=&#34;json-formatted sampling settings that will be returned in /get_model_info&#34;,
        )

        # LoRA
        parser.add_argument(
            &#34;--enable-lora&#34;,
            default=ServerArgs.enable_lora,
            action=&#34;store_true&#34;,
            help=&#34;Enable LoRA support for the model. This argument is automatically set to True if `--lora-paths` is provided for backward compatibility.&#34;,
        )
        parser.add_argument(
            &#34;--max-lora-rank&#34;,
            default=ServerArgs.max_lora_rank,
            type=int,
            help=&#34;The maximum rank of LoRA adapters. If not specified, it will be automatically inferred from the adapters provided in --lora-paths.&#34;,
        )
        parser.add_argument(
            &#34;--lora-target-modules&#34;,
            type=str,
            choices=SUPPORTED_LORA_TARGET_MODULES + [LORA_TARGET_ALL_MODULES],
            nargs=&#34;*&#34;,
            default=None,
            help=&#34;The union set of all target modules where LoRA should be applied. If not specified, &#34;
            &#34;it will be automatically inferred from the adapters provided in --lora-paths. If &#39;all&#39; is specified, &#34;
            &#34;all supported modules will be targeted.&#34;,
        )
        parser.add_argument(
            &#34;--lora-paths&#34;,
            type=str,
            nargs=&#34;*&#34;,
            default=None,
            action=LoRAPathAction,
            help=&#39;The list of LoRA adapters to load. Each adapter must be specified in one of the following formats: &lt;PATH&gt; | &lt;NAME&gt;=&lt;PATH&gt; | JSON with schema {&#34;lora_name&#34;:str,&#34;lora_path&#34;:str,&#34;pinned&#34;:bool}&#39;,
        )
        parser.add_argument(
            &#34;--max-loras-per-batch&#34;,
            type=int,
            default=8,
            help=&#34;Maximum number of adapters for a running batch, include base-only request.&#34;,
        )
        parser.add_argument(
            &#34;--max-loaded-loras&#34;,
            type=int,
            default=ServerArgs.max_loaded_loras,
            help=&#34;If specified, it limits the maximum number of LoRA adapters loaded in CPU memory at a time. The value must be greater than or equal to `--max-loras-per-batch`.&#34;,
        )
        parser.add_argument(
            &#34;--lora-backend&#34;,
            type=str,
            default=&#34;triton&#34;,
            help=&#34;Choose the kernel backend for multi-LoRA serving.&#34;,
        )

        # Kernel backend
        parser.add_argument(
            &#34;--attention-backend&#34;,
            type=str,
            choices=ATTENTION_BACKEND_CHOICES,
            default=ServerArgs.attention_backend,
            help=&#34;Choose the kernels for attention layers.&#34;,
        )
        parser.add_argument(
            &#34;--prefill-attention-backend&#34;,
            type=str,
            choices=ATTENTION_BACKEND_CHOICES,
            default=ServerArgs.prefill_attention_backend,
            help=&#34;Choose the kernels for prefill attention layers (have priority over --attention-backend).&#34;,
        )
        parser.add_argument(
            &#34;--decode-attention-backend&#34;,
            type=str,
            choices=ATTENTION_BACKEND_CHOICES,
            default=ServerArgs.decode_attention_backend,
            help=&#34;Choose the kernels for decode attention layers (have priority over --attention-backend).&#34;,
        )
        parser.add_argument(
            &#34;--sampling-backend&#34;,
            type=str,
            choices=[&#34;flashinfer&#34;, &#34;pytorch&#34;],
            default=ServerArgs.sampling_backend,
            help=&#34;Choose the kernels for sampling layers.&#34;,
        )
        parser.add_argument(
            &#34;--grammar-backend&#34;,
            type=str,
            choices=[&#34;xgrammar&#34;, &#34;outlines&#34;, &#34;llguidance&#34;, &#34;none&#34;],
            default=ServerArgs.grammar_backend,
            help=&#34;Choose the backend for grammar-guided decoding.&#34;,
        )
        parser.add_argument(
            &#34;--mm-attention-backend&#34;,
            type=str,
            choices=[&#34;sdpa&#34;, &#34;fa3&#34;, &#34;triton_attn&#34;],
            default=ServerArgs.mm_attention_backend,
            help=&#34;Set multimodal attention backend.&#34;,
        )

        # Speculative decoding
        parser.add_argument(
            &#34;--speculative-algorithm&#34;,
            type=str,
            choices=[&#34;EAGLE&#34;, &#34;EAGLE3&#34;, &#34;NEXTN&#34;],
            help=&#34;Speculative algorithm.&#34;,
        )
        parser.add_argument(
            &#34;--speculative-draft-model-path&#34;,
            type=str,
            help=&#34;The path of the draft model weights. This can be a local folder or a Hugging Face repo ID.&#34;,
        )
        parser.add_argument(
            &#34;--speculative-num-steps&#34;,
            type=int,
            help=&#34;The number of steps sampled from draft model in Speculative Decoding.&#34;,
            default=ServerArgs.speculative_num_steps,
        )
        parser.add_argument(
            &#34;--speculative-eagle-topk&#34;,
            type=int,
            help=&#34;The number of tokens sampled from the draft model in eagle2 each step.&#34;,
            default=ServerArgs.speculative_eagle_topk,
        )
        parser.add_argument(
            &#34;--speculative-num-draft-tokens&#34;,
            type=int,
            help=&#34;The number of tokens sampled from the draft model in Speculative Decoding.&#34;,
            default=ServerArgs.speculative_num_draft_tokens,
        )
        parser.add_argument(
            &#34;--speculative-accept-threshold-single&#34;,
            type=float,
            help=&#34;Accept a draft token if its probability in the target model is greater than this threshold.&#34;,
            default=ServerArgs.speculative_accept_threshold_single,
        )
        parser.add_argument(
            &#34;--speculative-accept-threshold-acc&#34;,
            type=float,
            help=&#34;The accept probability of a draft token is raised from its target probability p to min(1, p / threshold_acc).&#34;,
            default=ServerArgs.speculative_accept_threshold_acc,
        )
        parser.add_argument(
            &#34;--speculative-token-map&#34;,
            type=str,
            help=&#34;The path of the draft model&#39;s small vocab table.&#34;,
            default=ServerArgs.speculative_token_map,
        )

        # Expert parallelism
        parser.add_argument(
            &#34;--expert-parallel-size&#34;,
            &#34;--ep-size&#34;,
            &#34;--ep&#34;,
            type=int,
            default=ServerArgs.ep_size,
            help=&#34;The expert parallelism size.&#34;,
        )
        parser.add_argument(
            &#34;--moe-a2a-backend&#34;,
            type=str,
            choices=[&#34;none&#34;, &#34;deepep&#34;],
            default=ServerArgs.moe_a2a_backend,
            help=&#34;Choose the backend for MoE A2A.&#34;,
        )
        parser.add_argument(
            &#34;--moe-runner-backend&#34;,
            type=str,
            choices=[
                &#34;auto&#34;,
                &#34;triton&#34;,
                &#34;triton_kernel&#34;,
                &#34;flashinfer_trtllm&#34;,
                &#34;flashinfer_cutlass&#34;,
                &#34;flashinfer_mxfp4&#34;,
            ],
            default=ServerArgs.moe_runner_backend,
            help=&#34;Choose the runner backend for MoE.&#34;,
        )
        parser.add_argument(
            &#34;--flashinfer-mxfp4-moe-precision&#34;,
            type=str,
            choices=[&#34;mxfp4&#34;, &#34;bf16&#34;],
            default=ServerArgs.flashinfer_mxfp4_moe_precision,
            help=&#34;Choose the computation precision of flashinfer mxfp4 moe&#34;,
        )
        parser.add_argument(
            &#34;--enable-flashinfer-allreduce-fusion&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Enable FlashInfer allreduce fusion with Residual RMSNorm.&#34;,
        )
        parser.add_argument(
            &#34;--deepep-mode&#34;,
            type=str,
            choices=[&#34;normal&#34;, &#34;low_latency&#34;, &#34;auto&#34;],
            default=&#34;auto&#34;,
            help=&#34;Select the mode when enable DeepEP MoE, could be `normal`, `low_latency` or `auto`. Default is `auto`, which means `low_latency` for decode batch and `normal` for prefill batch.&#34;,
        )
        parser.add_argument(
            &#34;--ep-num-redundant-experts&#34;,
            type=int,
            default=ServerArgs.ep_num_redundant_experts,
            help=&#34;Allocate this number of redundant experts in expert parallel.&#34;,
        )
        parser.add_argument(
            &#34;--ep-dispatch-algorithm&#34;,
            type=str,
            default=ServerArgs.ep_dispatch_algorithm,
            help=&#34;The algorithm to choose ranks for redundant experts in expert parallel.&#34;,
        )
        parser.add_argument(
            &#34;--init-expert-location&#34;,
            type=str,
            default=ServerArgs.init_expert_location,
            help=&#34;Initial location of EP experts.&#34;,
        )
        parser.add_argument(
            &#34;--enable-eplb&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Enable EPLB algorithm&#34;,
        )
        parser.add_argument(
            &#34;--eplb-algorithm&#34;,
            type=str,
            default=ServerArgs.eplb_algorithm,
            help=&#34;Chosen EPLB algorithm&#34;,
        )
        parser.add_argument(
            &#34;--eplb-rebalance-num-iterations&#34;,
            type=int,
            default=ServerArgs.eplb_rebalance_num_iterations,
            help=&#34;Number of iterations to automatically trigger a EPLB re-balance.&#34;,
        )
        parser.add_argument(
            &#34;--eplb-rebalance-layers-per-chunk&#34;,
            type=int,
            default=ServerArgs.eplb_rebalance_layers_per_chunk,
            help=&#34;Number of layers to rebalance per forward pass.&#34;,
        )
        parser.add_argument(
            &#34;--eplb-min-rebalancing-utilization-threshold&#34;,
            type=float,
            default=ServerArgs.eplb_min_rebalancing_utilization_threshold,
            help=&#34;Minimum threshold for GPU average utilization to trigger EPLB rebalancing. Must be in the range [0.0, 1.0].&#34;,
        )
        parser.add_argument(
            &#34;--expert-distribution-recorder-mode&#34;,
            type=str,
            default=ServerArgs.expert_distribution_recorder_mode,
            help=&#34;Mode of expert distribution recorder.&#34;,
        )
        parser.add_argument(
            &#34;--expert-distribution-recorder-buffer-size&#34;,
            type=int,
            default=ServerArgs.expert_distribution_recorder_buffer_size,
            help=&#34;Circular buffer size of expert distribution recorder. Set to -1 to denote infinite buffer.&#34;,
        )
        parser.add_argument(
            &#34;--enable-expert-distribution-metrics&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Enable logging metrics for expert balancedness&#34;,
        )
        parser.add_argument(
            &#34;--deepep-config&#34;,
            type=str,
            default=ServerArgs.deepep_config,
            help=&#34;Tuned DeepEP config suitable for your own cluster. It can be either a string with JSON content or a file path.&#34;,
        )
        parser.add_argument(
            &#34;--moe-dense-tp-size&#34;,
            type=int,
            default=ServerArgs.moe_dense_tp_size,
            help=&#34;TP size for MoE dense MLP layers. This flag is useful when, with large TP size, there are errors caused by weights in MLP layers having dimension smaller than the min dimension GEMM supports.&#34;,
        )

        # Hierarchical cache
        parser.add_argument(
            &#34;--enable-hierarchical-cache&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Enable hierarchical cache&#34;,
        )
        parser.add_argument(
            &#34;--hicache-ratio&#34;,
            type=float,
            default=ServerArgs.hicache_ratio,
            help=&#34;The ratio of the size of host KV cache memory pool to the size of device pool.&#34;,
        )
        parser.add_argument(
            &#34;--hicache-size&#34;,
            type=int,
            default=ServerArgs.hicache_size,
            help=&#34;The size of host KV cache memory pool in gigabytes, which will override the hicache_ratio if set.&#34;,
        )
        parser.add_argument(
            &#34;--hicache-write-policy&#34;,
            type=str,
            choices=[&#34;write_back&#34;, &#34;write_through&#34;, &#34;write_through_selective&#34;],
            default=ServerArgs.hicache_write_policy,
            help=&#34;The write policy of hierarchical cache.&#34;,
        )
        parser.add_argument(
            &#34;--hicache-io-backend&#34;,
            type=str,
            choices=[&#34;direct&#34;, &#34;kernel&#34;],
            default=ServerArgs.hicache_io_backend,
            help=&#34;The IO backend for KV cache transfer between CPU and GPU&#34;,
        )
        parser.add_argument(
            &#34;--hicache-mem-layout&#34;,
            type=str,
            choices=[&#34;layer_first&#34;, &#34;page_first&#34;],
            default=ServerArgs.hicache_mem_layout,
            help=&#34;The layout of host memory pool for hierarchical cache.&#34;,
        )
        parser.add_argument(
            &#34;--hicache-storage-backend&#34;,
            type=str,
            choices=[&#34;file&#34;, &#34;mooncake&#34;, &#34;hf3fs&#34;, &#34;nixl&#34;],
            default=ServerArgs.hicache_storage_backend,
            help=&#34;The storage backend for hierarchical KV cache.&#34;,
        )
        parser.add_argument(
            &#34;--hicache-storage-prefetch-policy&#34;,
            type=str,
            choices=[&#34;best_effort&#34;, &#34;wait_complete&#34;, &#34;timeout&#34;],
            default=ServerArgs.hicache_storage_prefetch_policy,
            help=&#34;Control when prefetching from the storage backend should stop.&#34;,
        )
        parser.add_argument(
            &#34;--hicache-storage-backend-extra-config&#34;,
            type=str,
            default=ServerArgs.hicache_storage_backend_extra_config,
            help=&#34;A dictionary in JSON string format containing extra configuration for the storage backend.&#34;,
        )

        # Double Sparsity
        parser.add_argument(
            &#34;--enable-double-sparsity&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Enable double sparsity attention&#34;,
        )
        parser.add_argument(
            &#34;--ds-channel-config-path&#34;,
            type=str,
            default=ServerArgs.ds_channel_config_path,
            help=&#34;The path of the double sparsity channel config&#34;,
        )
        parser.add_argument(
            &#34;--ds-heavy-channel-num&#34;,
            type=int,
            default=ServerArgs.ds_heavy_channel_num,
            help=&#34;The number of heavy channels in double sparsity attention&#34;,
        )
        parser.add_argument(
            &#34;--ds-heavy-token-num&#34;,
            type=int,
            default=ServerArgs.ds_heavy_token_num,
            help=&#34;The number of heavy tokens in double sparsity attention&#34;,
        )
        parser.add_argument(
            &#34;--ds-heavy-channel-type&#34;,
            type=str,
            default=ServerArgs.ds_heavy_channel_type,
            help=&#34;The type of heavy channels in double sparsity attention&#34;,
        )
        parser.add_argument(
            &#34;--ds-sparse-decode-threshold&#34;,
            type=int,
            default=ServerArgs.ds_sparse_decode_threshold,
            help=&#34;The type of heavy channels in double sparsity attention&#34;,
        )

        # Offloading
        parser.add_argument(
            &#34;--cpu-offload-gb&#34;,
            type=int,
            default=ServerArgs.cpu_offload_gb,
            help=&#34;How many GBs of RAM to reserve for CPU offloading.&#34;,
        )
        parser.add_argument(
            &#34;--offload-group-size&#34;,
            type=int,
            default=ServerArgs.offload_group_size,
            help=&#34;Number of layers per group in offloading.&#34;,
        )
        parser.add_argument(
            &#34;--offload-num-in-group&#34;,
            type=int,
            default=ServerArgs.offload_num_in_group,
            help=&#34;Number of layers to be offloaded within a group.&#34;,
        )
        parser.add_argument(
            &#34;--offload-prefetch-step&#34;,
            type=int,
            default=ServerArgs.offload_prefetch_step,
            help=&#34;Steps to prefetch in offloading.&#34;,
        )
        parser.add_argument(
            &#34;--offload-mode&#34;,
            type=str,
            default=ServerArgs.offload_mode,
            help=&#34;Mode of offloading.&#34;,
        )

        # Optimization/debug options
        parser.add_argument(
            &#34;--disable-radix-cache&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Disable RadixAttention for prefix caching.&#34;,
        )
        parser.add_argument(
            &#34;--cuda-graph-max-bs&#34;,
            type=int,
            default=ServerArgs.cuda_graph_max_bs,
            help=&#34;Set the maximum batch size for cuda graph. It will extend the cuda graph capture batch size to this value.&#34;,
        )
        parser.add_argument(
            &#34;--cuda-graph-bs&#34;,
            type=int,
            nargs=&#34;+&#34;,
            help=&#34;Set the list of batch sizes for cuda graph.&#34;,
        )
        parser.add_argument(
            &#34;--disable-cuda-graph&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Disable cuda graph.&#34;,
        )
        parser.add_argument(
            &#34;--disable-cuda-graph-padding&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Disable cuda graph when padding is needed. Still uses cuda graph when padding is not needed.&#34;,
        )
        parser.add_argument(
            &#34;--enable-profile-cuda-graph&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Enable profiling of cuda graph capture.&#34;,
        )
        parser.add_argument(
            &#34;--enable-cudagraph-gc&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Enable garbage collection during CUDA graph capture. If disabled (default), GC is frozen during capture to speed up the process.&#34;,
        )
        parser.add_argument(
            &#34;--enable-nccl-nvls&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Enable NCCL NVLS for prefill heavy requests when available.&#34;,
        )
        parser.add_argument(
            &#34;--enable-symm-mem&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Enable NCCL symmetric memory for fast collectives.&#34;,
        )
        parser.add_argument(
            &#34;--disable-flashinfer-cutlass-moe-fp4-allgather&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Disables quantize before all-gather for flashinfer cutlass moe.&#34;,
        )
        parser.add_argument(
            &#34;--enable-tokenizer-batch-encode&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Enable batch tokenization for improved performance when processing multiple text inputs. Do not use with image inputs, pre-tokenized input_ids, or input_embeds.&#34;,
        )
        parser.add_argument(
            &#34;--disable-outlines-disk-cache&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Disable disk cache of outlines to avoid possible crashes related to file system or high concurrency.&#34;,
        )
        parser.add_argument(
            &#34;--disable-custom-all-reduce&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Disable the custom all-reduce kernel and fall back to NCCL.&#34;,
        )
        parser.add_argument(
            &#34;--enable-mscclpp&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Enable using mscclpp for small messages for all-reduce kernel and fall back to NCCL.&#34;,
        )
        parser.add_argument(
            &#34;--disable-overlap-schedule&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Disable the overlap scheduler, which overlaps the CPU scheduler with GPU model worker.&#34;,
        )
        parser.add_argument(
            &#34;--enable-mixed-chunk&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Enabling mixing prefill and decode in a batch when using chunked prefill.&#34;,
        )
        parser.add_argument(
            &#34;--enable-dp-attention&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Enabling data parallelism for attention and tensor parallelism for FFN. The dp size should be equal to the tp size. Currently DeepSeek-V2 and Qwen 2/3 MoE models are supported.&#34;,
        )
        parser.add_argument(
            &#34;--enable-dp-lm-head&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Enable vocabulary parallel across the attention TP group to avoid all-gather across DP groups, optimizing performance under DP attention.&#34;,
        )
        parser.add_argument(
            &#34;--enable-two-batch-overlap&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Enabling two micro batches to overlap.&#34;,
        )
        parser.add_argument(
            &#34;--tbo-token-distribution-threshold&#34;,
            type=float,
            default=ServerArgs.tbo_token_distribution_threshold,
            help=&#34;The threshold of token distribution between two batches in micro-batch-overlap, determines whether to two-batch-overlap or two-chunk-overlap. Set to 0 denote disable two-chunk-overlap.&#34;,
        )
        parser.add_argument(
            &#34;--enable-torch-compile&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Optimize the model with torch.compile. Experimental feature.&#34;,
        )
        parser.add_argument(
            &#34;--torch-compile-max-bs&#34;,
            type=int,
            default=ServerArgs.torch_compile_max_bs,
            help=&#34;Set the maximum batch size when using torch compile.&#34;,
        )
        parser.add_argument(
            &#34;--torchao-config&#34;,
            type=str,
            default=ServerArgs.torchao_config,
            help=&#34;Optimize the model with torchao. Experimental feature. Current choices are: int8dq, int8wo, int4wo-&lt;group_size&gt;, fp8wo, fp8dq-per_tensor, fp8dq-per_row&#34;,
        )
        parser.add_argument(
            &#34;--enable-nan-detection&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Enable the NaN detection for debugging purposes.&#34;,
        )
        parser.add_argument(
            &#34;--enable-p2p-check&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Enable P2P check for GPU access, otherwise the p2p access is allowed by default.&#34;,
        )
        parser.add_argument(
            &#34;--triton-attention-reduce-in-fp32&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Cast the intermediate attention results to fp32 to avoid possible crashes related to fp16.&#34;
            &#34;This only affects Triton attention kernels.&#34;,
        )
        parser.add_argument(
            &#34;--triton-attention-num-kv-splits&#34;,
            type=int,
            default=ServerArgs.triton_attention_num_kv_splits,
            help=&#34;The number of KV splits in flash decoding Triton kernel. Larger value is better in longer context scenarios. The default value is 8.&#34;,
        )
        parser.add_argument(
            &#34;--num-continuous-decode-steps&#34;,
            type=int,
            default=ServerArgs.num_continuous_decode_steps,
            help=&#34;Run multiple continuous decoding steps to reduce scheduling overhead. &#34;
            &#34;This can potentially increase throughput but may also increase time-to-first-token latency. &#34;
            &#34;The default value is 1, meaning only run one decoding step at a time.&#34;,
        )
        parser.add_argument(
            &#34;--delete-ckpt-after-loading&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Delete the model checkpoint after loading the model.&#34;,
        )
        parser.add_argument(
            &#34;--enable-memory-saver&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Allow saving memory using release_memory_occupation and resume_memory_occupation&#34;,
        )
        parser.add_argument(
            &#34;--allow-auto-truncate&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Allow automatically truncating requests that exceed the maximum input length instead of returning an error.&#34;,
        )
        parser.add_argument(
            &#34;--enable-custom-logit-processor&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Enable users to pass custom logit processors to the server (disabled by default for security)&#34;,
        )
        parser.add_argument(
            &#34;--flashinfer-mla-disable-ragged&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Not using ragged prefill wrapper when running flashinfer mla&#34;,
        )
        parser.add_argument(
            &#34;--disable-shared-experts-fusion&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Disable shared experts fusion optimization for deepseek v3/r1.&#34;,
        )
        parser.add_argument(
            &#34;--disable-chunked-prefix-cache&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Disable chunked prefix cache feature for deepseek, which should save overhead for short sequences.&#34;,
        )
        parser.add_argument(
            &#34;--disable-fast-image-processor&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Adopt base image processor instead of fast image processor.&#34;,
        )
        parser.add_argument(
            &#34;--enable-return-hidden-states&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Enable returning hidden states with responses.&#34;,
        )
        parser.add_argument(
            &#34;--scheduler-recv-interval&#34;,
            type=int,
            default=ServerArgs.scheduler_recv_interval,
            help=&#34;The interval to poll requests in scheduler. Can be set to &gt;1 to reduce the overhead of this.&#34;,
        )

        # Debug tensor dumps
        parser.add_argument(
            &#34;--debug-tensor-dump-output-folder&#34;,
            type=str,
            default=ServerArgs.debug_tensor_dump_output_folder,
            help=&#34;The output folder for dumping tensors.&#34;,
        )
        parser.add_argument(
            &#34;--debug-tensor-dump-input-file&#34;,
            type=str,
            default=ServerArgs.debug_tensor_dump_input_file,
            help=&#34;The input filename for dumping tensors&#34;,
        )
        parser.add_argument(
            &#34;--debug-tensor-dump-inject&#34;,
            type=str,
            default=ServerArgs.debug_tensor_dump_inject,
            help=&#34;Inject the outputs from jax as the input of every layer.&#34;,
        )
        parser.add_argument(
            &#34;--debug-tensor-dump-prefill-only&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Only dump the tensors for prefill requests (i.e. batch size &gt; 1).&#34;,
        )

        # PD disaggregation
        parser.add_argument(
            &#34;--disaggregation-mode&#34;,
            type=str,
            default=&#34;null&#34;,
            choices=[&#34;null&#34;, &#34;prefill&#34;, &#34;decode&#34;],
            help=&#39;Only used for PD disaggregation. &#34;prefill&#34; for prefill-only server, and &#34;decode&#34; for decode-only server. If not specified, it is not PD disaggregated&#39;,
        )
        parser.add_argument(
            &#34;--disaggregation-transfer-backend&#34;,
            type=str,
            default=ServerArgs.disaggregation_transfer_backend,
            choices=DISAGG_TRANSFER_BACKEND_CHOICES,
            help=&#34;The backend for disaggregation transfer. Default is mooncake.&#34;,
        )
        parser.add_argument(
            &#34;--disaggregation-bootstrap-port&#34;,
            type=int,
            default=ServerArgs.disaggregation_bootstrap_port,
            help=&#34;Bootstrap server port on the prefill server. Default is 8998.&#34;,
        )
        parser.add_argument(
            &#34;--disaggregation-decode-tp&#34;,
            type=int,
            default=ServerArgs.disaggregation_decode_tp,
            help=&#34;Decode tp size. If not set, it matches the tp size of the current engine. This is only set on the prefill server.&#34;,
        )
        parser.add_argument(
            &#34;--disaggregation-decode-dp&#34;,
            type=int,
            default=ServerArgs.disaggregation_decode_dp,
            help=&#34;Decode dp size. If not set, it matches the dp size of the current engine. This is only set on the prefill server.&#34;,
        )
        parser.add_argument(
            &#34;--disaggregation-prefill-pp&#34;,
            type=int,
            default=ServerArgs.disaggregation_prefill_pp,
            help=&#34;Prefill pp size. If not set, it is default to 1. This is only set on the decode server.&#34;,
        )
        parser.add_argument(
            &#34;--disaggregation-ib-device&#34;,
            type=str,
            default=ServerArgs.disaggregation_ib_device,
            help=&#34;The InfiniBand devices for disaggregation transfer, accepts single device (e.g., --disaggregation-ib-device mlx5_0) &#34;
            &#34;or multiple comma-separated devices (e.g., --disaggregation-ib-device mlx5_0,mlx5_1). &#34;
            &#34;Default is None, which triggers automatic device detection when mooncake backend is enabled.&#34;,
        )
        parser.add_argument(
            &#34;--num-reserved-decode-tokens&#34;,
            type=int,
            default=ServerArgs.num_reserved_decode_tokens,
            help=&#34;Number of decode tokens that will have memory reserved when adding new request to the running batch.&#34;,
        )
        parser.add_argument(
            &#34;--pdlb-url&#34;,
            type=str,
            default=None,
            help=&#34;The URL of the PD disaggregation load balancer. If set, the prefill/decode server will register with the load balancer.&#34;,
        )

        # Custom weight loader
        parser.add_argument(
            &#34;--custom-weight-loader&#34;,
            type=str,
            nargs=&#34;*&#34;,
            default=None,
            help=&#34;The custom dataloader which used to update the model. Should be set with a valid import path, such as my_package.weight_load_func&#34;,
        )
        parser.add_argument(
            &#34;--weight-loader-disable-mmap&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Disable mmap while loading weight using safetensors.&#34;,
        )

        # For PD-Multiplexing
        parser.add_argument(
            &#34;--enable-pdmux&#34;,
            action=&#34;store_true&#34;,
            help=&#34;Enable PD-Multiplexing, PD running on greenctx stream.&#34;,
        )

        parser.add_argument(
            &#34;--sm-group-num&#34;,
            type=int,
            default=ServerArgs.sm_group_num,
            help=&#34;Number of sm partition groups.&#34;,
        )

        # Deprecated arguments
        parser.add_argument(
            &#34;--enable-ep-moe&#34;,
            action=&#34;store_true&#34;,
            help=&#34;(Deprecated) Enabling expert parallelism for moe. The ep size is equal to the tp size.&#34;,
        )
        parser.add_argument(
            &#34;--enable-deepep-moe&#34;,
            action=&#34;store_true&#34;,
            help=&#34;(Deprecated) Enabling DeepEP MoE implementation for EP MoE.&#34;,
        )
        parser.add_argument(
            &#34;--enable-flashinfer-cutlass-moe&#34;,
            action=&#34;store_true&#34;,
            help=&#34;(Deprecated) Enable FlashInfer CUTLASS MoE backend for modelopt_fp4 quant on Blackwell. Supports MoE-EP&#34;,
        )
        parser.add_argument(
            &#34;--enable-flashinfer-trtllm-moe&#34;,
            action=&#34;store_true&#34;,
            help=&#34;(Deprecated) Enable FlashInfer TRTLLM MoE backend on Blackwell. Supports BlockScale FP8 MoE-EP&#34;,
        )
        parser.add_argument(
            &#34;--enable-triton-kernel-moe&#34;,
            action=&#34;store_true&#34;,
            help=&#34;(Deprecated) Use triton moe grouped gemm kernel.&#34;,
        )
        parser.add_argument(
            &#34;--enable-flashinfer-mxfp4-moe&#34;,
            action=&#34;store_true&#34;,
            help=&#34;(Deprecated) Enable FlashInfer MXFP4 MoE backend for modelopt_fp4 quant on Blackwell.&#34;,
        )

    @classmethod
    def from_cli_args(cls, args: argparse.Namespace):
        args.tp_size = args.tensor_parallel_size
        args.pp_size = args.pipeline_parallel_size
        args.dp_size = args.data_parallel_size
        args.ep_size = args.expert_parallel_size
        attrs = [attr.name for attr in dataclasses.fields(cls)]
        return cls(**{attr: getattr(args, attr) for attr in attrs})

    def url(self):
        if is_valid_ipv6_address(self.host):
            return f&#34;http://[{self.host}]:{self.port}&#34;
        else:
            return f&#34;http://{self.host}:{self.port}&#34;

    def get_hf_config(self):
        kwargs = {}
        hf_config = get_config(
            self.model_path,
            trust_remote_code=self.trust_remote_code,
            revision=self.revision,
            model_override_args=json.loads(self.json_model_override_args),
            **kwargs,
        )
        return hf_config

    def check_server_args(self):
        # Check parallel size constraints
        assert (
            self.tp_size * self.pp_size
        ) % self.nnodes == 0, &#34;tp_size must be divisible by number of nodes&#34;

        if self.pp_size &gt; 1:
            assert (
                self.disable_overlap_schedule
                and self.speculative_algorithm is None
                and not self.enable_mixed_chunk
            ), &#34;Pipeline parallelism is not compatible with overlap schedule, speculative decoding, mixed chunked prefill.&#34;

        assert not (
            self.dp_size &gt; 1 and self.nnodes != 1 and not self.enable_dp_attention
        ), &#34;multi-node data parallel is not supported unless dp attention!&#34;

        assert self.base_gpu_id &gt;= 0, &#34;base_gpu_id must be non-negative&#34;
        assert self.gpu_id_step &gt;= 1, &#34;gpu_id_step must be positive&#34;

        assert self.moe_dense_tp_size in {
            1,
            None,
        }, &#34;moe_dense_tp_size only support 1 and None currently&#34;

        # Check LoRA
        self.check_lora_server_args()

        # Check speculative decoding
        if self.speculative_algorithm is not None:
            assert (
                not self.enable_mixed_chunk
            ), &#34;enable_mixed_chunk is required for speculative decoding&#34;

        # Check chunked prefill
        # Skip validation if chunked prefill is disabled (i.e., size &lt;= 0).
        if self.chunked_prefill_size &gt; 0:
            assert (
                self.chunked_prefill_size % self.page_size == 0
            ), &#34;chunked_prefill_size must be divisible by page_size&#34;

    def check_lora_server_args(self):
        assert self.max_loras_per_batch &gt; 0, &#34;max_loras_per_batch must be positive&#34;

        # Enable LoRA if any LoRA paths are provided for backward compatibility.
        if self.lora_paths:
            if self.enable_lora is None:
                self.enable_lora = True
                logger.warning(
                    &#34;--enable-lora is set to True because --lora-paths is provided.&#34;
                )
            elif self.enable_lora is False:
                logger.warning(
                    &#34;--enable-lora is set to False, any provided lora_paths will be ignored.&#34;
                )

        if self.enable_lora:
            if isinstance(self.lora_paths, list):
                lora_paths = self.lora_paths
                self.lora_paths = []
                for lora_path in lora_paths:
                    if isinstance(lora_path, str):
                        if &#34;=&#34; in lora_path:
                            name, path = lora_path.split(&#34;=&#34;, 1)
                            lora_ref = LoRARef(
                                lora_name=name, lora_path=path, pinned=False
                            )
                        else:
                            lora_ref = LoRARef(
                                lora_name=lora_path, lora_path=lora_path, pinned=False
                            )
                    elif isinstance(lora_path, dict):
                        assert (
                            &#34;lora_name&#34; in lora_path and &#34;lora_path&#34; in lora_path
                        ), f&#34;When providing LoRA paths as a list of dict, each dict should contain &#39;lora_name&#39; and &#39;lora_path&#39; keys. Got: {lora_path}&#34;
                        lora_ref = LoRARef(
                            lora_name=lora_path[&#34;lora_name&#34;],
                            lora_path=lora_path[&#34;lora_path&#34;],
                            pinned=lora_path.get(&#34;pinned&#34;, False),
                        )
                    else:
                        raise ValueError(
                            f&#34;Invalid type for item in --lora-paths list: {type(lora_path)}. &#34;
                            &#34;Expected a string or a dictionary.&#34;
                        )
                    self.lora_paths.append(lora_ref)
            elif isinstance(self.lora_paths, dict):
                self.lora_paths = [
                    LoRARef(lora_name=k, lora_path=v, pinned=False)
                    for k, v in self.lora_paths.items()
                ]
            elif self.lora_paths is None:
                self.lora_paths = []
            else:
                raise ValueError(
                    f&#34;Invalid type for --lora-paths: {type(self.lora_paths)}. &#34;
                    &#34;Expected a list or a dictionary.&#34;
                )

            # Expand target modules
            if self.lora_target_modules:
                self.lora_target_modules = set(self.lora_target_modules)
                if &#34;all&#34; in self.lora_target_modules:
                    assert (
                        len(self.lora_target_modules) == 1
                    ), &#34;If &#39;all&#39; is specified in --lora-target-modules, it should be the only module specified.&#34;
                    self.lora_target_modules = set(SUPPORTED_LORA_TARGET_MODULES)

            # Ensure sufficient information is provided for LoRA initialization.
            assert self.lora_paths or (
                self.max_lora_rank and self.lora_target_modules
            ), &#34;When no initial --lora-paths is provided, you need to specify both --max-lora-rank and --lora-target-modules for LoRA initialization.&#34;

            # Validate max_loaded_loras
            if self.max_loaded_loras is not None:
                assert self.max_loaded_loras &gt;= self.max_loras_per_batch, (
                    &#34;max_loaded_loras should be greater than or equal to max_loras_per_batch. &#34;
                    f&#34;max_loaded_loras={self.max_loaded_loras}, max_loras_per_batch={self.max_loras_per_batch}&#34;
                )
                assert len(self.lora_paths) &lt;= self.max_loaded_loras, (
                    &#34;The number of LoRA paths should not exceed max_loaded_loras. &#34;
                    f&#34;max_loaded_loras={self.max_loaded_loras}, lora_paths={len(self.lora_paths)}&#34;
                )

    def validate_disagg_tp_size(self, prefill_tp: int, decode_tp: int):
        larger_tp = max(decode_tp, prefill_tp)
        smaller_tp = min(decode_tp, prefill_tp)
        assert larger_tp % smaller_tp == 0, (
            &#34;Different tp size is supported only when one tp is multiple of the other. &#34;
            f&#34;decode_tp={decode_tp}, prefill_tp={prefill_tp}&#34;
        )

    def model_specific_adjustments(self):
        hf_config = self.get_hf_config()
        model_arch = hf_config.architectures[0]
        if model_arch in [&#34;GptOssForCausalLM&#34;]:
            if self.attention_backend is None:
                if is_cuda() and is_sm100_supported():
                    self.attention_backend = &#34;trtllm_mha&#34;
                elif is_cuda() and is_sm90_supported():
                    self.attention_backend = &#34;fa3&#34;
                else:
                    self.attention_backend = &#34;triton&#34;
            supported_backends = [&#34;triton&#34;, &#34;trtllm_mha&#34;, &#34;fa3&#34;]
            logger.info(
                f&#34;Use {self.attention_backend} as attention backend for GptOssForCausalLM&#34;
            )
            assert (
                self.attention_backend in supported_backends
            ), f&#34;GptOssForCausalLM requires one of {supported_backends} attention backend, but got &#39;{self.attention_backend}&#39;&#34;

            if is_sm100_supported():
                if not self.enable_dp_attention:
                    self.enable_flashinfer_allreduce_fusion = True
                    logger.info(
                        &#34;Enable FlashInfer AllReduce Fusion on sm100 for GptOssForCausalLM&#34;
                    )
            quantization_config = getattr(hf_config, &#34;quantization_config&#34;, None)
            is_mxfp4_quant_format = (
                quantization_config is not None
                and quantization_config.get(&#34;quant_method&#34;) == &#34;mxfp4&#34;
            )

            if is_sm100_supported() and is_mxfp4_quant_format:
                self.moe_runner_backend = &#34;flashinfer_mxfp4&#34;
                logger.warning(
                    &#34;Detected SM100 and MXFP4 quantization format for GPT-OSS model, enabling FlashInfer MXFP4 MOE kernel.&#34;
                )
            else:
                if self.moe_runner_backend == &#34;triton_kernel&#34;:
                    assert (
                        self.ep_size == 1
                    ), &#34;Triton kernel MoE is only supported when ep_size == 1&#34;
                if (
                    self.moe_runner_backend == &#34;auto&#34;
                    and self.ep_size == 1
                    and is_triton_kernels_available()
                ):
                    self.moe_runner_backend = &#34;triton_kernel&#34;
                    logger.warning(
                        &#34;Detected GPT-OSS model, enabling triton_kernels MOE kernel.&#34;
                    )
            self.disable_hybrid_swa_memory = True
            if is_mxfp4_quant_format:
                # use bf16 for mxfp4 triton kernels
                self.dtype = &#34;bfloat16&#34;

        elif &#34;Llama4&#34; in model_arch:
            assert self.attention_backend in {
                &#34;fa3&#34;,
                &#34;aiter&#34;,
            }, &#34;fa3 or aiter is required for Llama4 model&#34;
        elif model_arch in [
            &#34;Gemma2ForCausalLM&#34;,
            &#34;Gemma3ForCausalLM&#34;,
            &#34;Gemma3ForConditionalGeneration&#34;,
            &#34;Gemma3nForCausalLM&#34;,
            &#34;Gemma3nForConditionalGeneration&#34;,
        ]:
            # FIXME: https://github.com/sgl-project/sglang/pull/7367 is not compatible with gemma2 model.
            # It failed at this test: https://github.com/sgl-project/sglang/actions/runs/16255155597/job/45890331952#step:4:736
            logger.warning(
                f&#34;Disable hybrid SWA memory for {model_arch} as it is not yet supported.&#34;
            )
            self.disable_hybrid_swa_memory = True

    def adjust_mem_fraction_for_vlm(self, model_config):
        vision_config = getattr(model_config.hf_config, &#34;vision_config&#34;, None)
        if vision_config is None:
            return

        # roughly reduce the mem_fraction_static base on params of Vit
        original_server_arg_mem_fraction = self.mem_fraction_static
        # a base mem_fraction_static factor for regular Vit
        base_mem_fraction_reduction_ratio = 0.95

        vit_num_layers = getattr(vision_config, &#34;num_hidden_layers&#34;, 24)
        vit_hidden_size = getattr(vision_config, &#34;hidden_size&#34;, 1024)

        # baseline ViT params (ViT-L/14)
        baseline_vit_layers = 24
        baseline_vit_hidden_size = 1024

        # weight params count
        current_complexity_score = vit_num_layers * (vit_hidden_size**2)
        baseline_complexity_score = baseline_vit_layers * (baseline_vit_hidden_size**2)
        complexity_ratio = (
            current_complexity_score / baseline_complexity_score
            if baseline_complexity_score &gt; 0
            else 1.0
        )

        # every time the complexity grows 100%, adjust final factor for 10%
        sensitivity_scale = 0.1
        dynamic_adjustment_factor = 1.0 - sensitivity_scale * (complexity_ratio - 1.0)
        dynamic_adjustment_factor = max(0.8, min(1.05, dynamic_adjustment_factor))

        final_overall_factor = (
            base_mem_fraction_reduction_ratio * dynamic_adjustment_factor
        )
        self.mem_fraction_static = (
            original_server_arg_mem_fraction * final_overall_factor
        )</code></pre>
</details>
<div class="desc"><p>ServerArgs(model_path: str, tokenizer_path: Optional[str] = None, tokenizer_mode: str = 'auto', skip_tokenizer_init: bool = False, load_format: str = 'auto', model_loader_extra_config: str = '{}', trust_remote_code: bool = False, context_length: Optional[int] = None, is_embedding: bool = False, enable_multimodal: Optional[bool] = None, revision: Optional[str] = None, model_impl: str = 'auto', host: str = '127.0.0.1', port: int = 30000, skip_server_warmup: bool = False, warmups: Optional[str] = None, nccl_port: Optional[int] = None, dtype: str = 'auto', quantization: Optional[str] = None, quantization_param_path: Optional[str] = None, kv_cache_dtype: str = 'auto', mem_fraction_static: Optional[float] = None, max_running_requests: Optional[int] = None, max_queued_requests: Optional[int] = 9223372036854775807, max_total_tokens: Optional[int] = None, chunked_prefill_size: Optional[int] = None, max_prefill_tokens: int = 16384, schedule_policy: str = 'fcfs', schedule_conservativeness: float = 1.0, page_size: Optional[int] = None, hybrid_kvcache_ratio: Optional[float] = None, swa_full_tokens_ratio: float = 0.8, disable_hybrid_swa_memory: bool = False, device: Optional[str] = None, tp_size: int = 1, pp_size: int = 1, max_micro_batch_size: Optional[int] = None, stream_interval: int = 1, stream_output: bool = False, random_seed: Optional[int] = None, constrained_json_whitespace_pattern: Optional[str] = None, watchdog_timeout: float = 300, dist_timeout: Optional[int] = None, download_dir: Optional[str] = None, base_gpu_id: int = 0, gpu_id_step: int = 1, sleep_on_idle: bool = False, log_level: str = 'info', log_level_http: Optional[str] = None, log_requests: bool = False, log_requests_level: int = 2, crash_dump_folder: Optional[str] = None, show_time_cost: bool = False, enable_metrics: bool = False, enable_metrics_for_all_schedulers: bool = False, bucket_time_to_first_token: Optional[List[float]] = None, bucket_inter_token_latency: Optional[List[float]] = None, bucket_e2e_request_latency: Optional[List[float]] = None, collect_tokens_histogram: bool = False, decode_log_interval: int = 40, enable_request_time_stats_logging: bool = False, kv_events_config: Optional[str] = None, gc_warning_threshold_secs: float = 0.0, api_key: Optional[str] = None, served_model_name: Optional[str] = None, weight_version: str = 'default', chat_template: Optional[str] = None, completion_template: Optional[str] = None, file_storage_path: str = 'sglang_storage', enable_cache_report: bool = False, reasoning_parser: Optional[str] = None, tool_call_parser: Optional[str] = None, tool_server: Optional[str] = None, dp_size: int = 1, load_balance_method: str = 'round_robin', dist_init_addr: Optional[str] = None, nnodes: int = 1, node_rank: int = 0, json_model_override_args: str = '{}', preferred_sampling_params: Optional[str] = None, enable_lora: Optional[bool] = None, max_lora_rank: Optional[int] = None, lora_target_modules: Union[set[str], List[str], NoneType] = None, lora_paths: Union[dict[str, str], List[dict[str, str]], List[str], List[sglang.srt.lora.lora_registry.LoRARef], NoneType] = None, max_loaded_loras: Optional[int] = None, max_loras_per_batch: int = 8, lora_backend: str = 'triton', attention_backend: Optional[str] = None, decode_attention_backend: Optional[str] = None, prefill_attention_backend: Optional[str] = None, sampling_backend: Optional[str] = None, grammar_backend: Optional[str] = None, mm_attention_backend: Optional[str] = None, speculative_algorithm: Optional[str] = None, speculative_draft_model_path: Optional[str] = None, speculative_num_steps: Optional[int] = None, speculative_eagle_topk: Optional[int] = None, speculative_num_draft_tokens: Optional[int] = None, speculative_accept_threshold_single: float = 1.0, speculative_accept_threshold_acc: float = 1.0, speculative_token_map: Optional[str] = None, ep_size: int = 1, moe_a2a_backend: Literal['none', 'deepep'] = 'none', moe_runner_backend: Literal['auto', 'triton', 'triton_kernel', 'flashinfer_trtllm', 'flashinfer_cutlass', 'flashinfer_mxfp4'] = 'auto', flashinfer_mxfp4_moe_precision: Literal['default', 'bf16'] = 'default', enable_flashinfer_allreduce_fusion: bool = False, deepep_mode: Literal['auto', 'normal', 'low_latency'] = 'auto', ep_num_redundant_experts: int = 0, ep_dispatch_algorithm: Optional[Literal['static', 'dynamic', 'fake']] = None, init_expert_location: str = 'trivial', enable_eplb: bool = False, eplb_algorithm: str = 'auto', eplb_rebalance_num_iterations: int = 1000, eplb_rebalance_layers_per_chunk: Optional[int] = None, eplb_min_rebalancing_utilization_threshold: float = 1.0, expert_distribution_recorder_mode: Optional[Literal['stat', 'stat_approx', 'per_pass', 'per_token']] = None, expert_distribution_recorder_buffer_size: Optional[int] = None, enable_expert_distribution_metrics: bool = False, deepep_config: Optional[str] = None, moe_dense_tp_size: Optional[int] = None, enable_hierarchical_cache: bool = False, hicache_ratio: float = 2.0, hicache_size: int = 0, hicache_write_policy: str = 'write_through', hicache_io_backend: str = 'kernel', hicache_mem_layout: str = 'layer_first', hicache_storage_backend: Optional[str] = None, hicache_storage_prefetch_policy: str = 'best_effort', hicache_storage_backend_extra_config: Optional[str] = None, enable_double_sparsity: bool = False, ds_channel_config_path: Optional[str] = None, ds_heavy_channel_num: int = 32, ds_heavy_token_num: int = 256, ds_heavy_channel_type: str = 'qk', ds_sparse_decode_threshold: int = 4096, cpu_offload_gb: int = 0, offload_group_size: int = -1, offload_num_in_group: int = 1, offload_prefetch_step: int = 1, offload_mode: str = 'cpu', disable_radix_cache: bool = False, cuda_graph_max_bs: Optional[int] = None, cuda_graph_bs: Optional[List[int]] = None, disable_cuda_graph: bool = False, disable_cuda_graph_padding: bool = False, enable_profile_cuda_graph: bool = False, enable_cudagraph_gc: bool = False, enable_nccl_nvls: bool = False, enable_symm_mem: bool = False, disable_flashinfer_cutlass_moe_fp4_allgather: bool = False, enable_tokenizer_batch_encode: bool = False, disable_outlines_disk_cache: bool = False, disable_custom_all_reduce: bool = False, enable_mscclpp: bool = False, disable_overlap_schedule: bool = False, enable_mixed_chunk: bool = False, enable_dp_attention: bool = False, enable_dp_lm_head: bool = False, enable_two_batch_overlap: bool = False, tbo_token_distribution_threshold: float = 0.48, enable_torch_compile: bool = False, torch_compile_max_bs: int = 32, torchao_config: str = '', enable_nan_detection: bool = False, enable_p2p_check: bool = False, triton_attention_reduce_in_fp32: bool = False, triton_attention_num_kv_splits: int = 8, num_continuous_decode_steps: int = 1, delete_ckpt_after_loading: bool = False, enable_memory_saver: bool = False, allow_auto_truncate: bool = False, enable_custom_logit_processor: bool = False, flashinfer_mla_disable_ragged: bool = False, disable_shared_experts_fusion: bool = False, disable_chunked_prefix_cache: bool = False, disable_fast_image_processor: bool = False, enable_return_hidden_states: bool = False, scheduler_recv_interval: int = 1, debug_tensor_dump_output_folder: Optional[str] = None, debug_tensor_dump_input_file: Optional[str] = None, debug_tensor_dump_inject: bool = False, debug_tensor_dump_prefill_only: bool = False, disaggregation_mode: str = 'null', disaggregation_transfer_backend: str = 'mooncake', disaggregation_bootstrap_port: int = 8998, disaggregation_decode_tp: Optional[int] = None, disaggregation_decode_dp: Optional[int] = None, disaggregation_prefill_pp: Optional[int] = 1, disaggregation_ib_device: Optional[str] = None, num_reserved_decode_tokens: int = 512, pdlb_url: Optional[str] = None, custom_weight_loader: Optional[List[str]] = None, weight_loader_disable_mmap: bool = False, enable_pdmux: bool = False, sm_group_num: int = 3, enable_ep_moe: bool = False, enable_deepep_moe: bool = False, enable_flashinfer_cutlass_moe: bool = False, enable_flashinfer_trtllm_moe: bool = False, enable_triton_kernel_moe: bool = False, enable_flashinfer_mxfp4_moe: bool = False)</p></div>
<h3>Static methods</h3>
<dl>
<dt id="sglang.srt.server_args.ServerArgs.add_cli_args"><code class="name flex">
<span>def <span class="ident">add_cli_args</span></span>(<span>parser: argparse.ArgumentParser)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@staticmethod
def add_cli_args(parser: argparse.ArgumentParser):
    # Model and tokenizer
    parser.add_argument(
        &#34;--model-path&#34;,
        &#34;--model&#34;,
        type=str,
        help=&#34;The path of the model weights. This can be a local folder or a Hugging Face repo ID.&#34;,
        required=True,
    )
    parser.add_argument(
        &#34;--tokenizer-path&#34;,
        type=str,
        default=ServerArgs.tokenizer_path,
        help=&#34;The path of the tokenizer.&#34;,
    )
    parser.add_argument(
        &#34;--tokenizer-mode&#34;,
        type=str,
        default=ServerArgs.tokenizer_mode,
        choices=[&#34;auto&#34;, &#34;slow&#34;],
        help=&#34;Tokenizer mode. &#39;auto&#39; will use the fast &#34;
        &#34;tokenizer if available, and &#39;slow&#39; will &#34;
        &#34;always use the slow tokenizer.&#34;,
    )
    parser.add_argument(
        &#34;--skip-tokenizer-init&#34;,
        action=&#34;store_true&#34;,
        help=&#34;If set, skip init tokenizer and pass input_ids in generate request.&#34;,
    )
    parser.add_argument(
        &#34;--load-format&#34;,
        type=str,
        default=ServerArgs.load_format,
        choices=LOAD_FORMAT_CHOICES,
        help=&#34;The format of the model weights to load. &#34;
        &#39;&#34;auto&#34; will try to load the weights in the safetensors format &#39;
        &#34;and fall back to the pytorch bin format if safetensors format &#34;
        &#34;is not available. &#34;
        &#39;&#34;pt&#34; will load the weights in the pytorch bin format. &#39;
        &#39;&#34;safetensors&#34; will load the weights in the safetensors format. &#39;
        &#39;&#34;npcache&#34; will load the weights in pytorch format and store &#39;
        &#34;a numpy cache to speed up the loading. &#34;
        &#39;&#34;dummy&#34; will initialize the weights with random values, &#39;
        &#34;which is mainly for profiling.&#34;
        &#39;&#34;gguf&#34; will load the weights in the gguf format. &#39;
        &#39;&#34;bitsandbytes&#34; will load the weights using bitsandbytes &#39;
        &#34;quantization.&#34;
        &#39;&#34;layered&#34; loads weights layer by layer so that one can quantize a &#39;
        &#34;layer before loading another to make the peak memory envelope &#34;
        &#34;smaller.&#34;,
    )
    parser.add_argument(
        &#34;--model-loader-extra-config&#34;,
        type=str,
        help=&#34;Extra config for model loader. &#34;
        &#34;This will be passed to the model loader corresponding to the chosen load_format.&#34;,
        default=ServerArgs.model_loader_extra_config,
    )
    parser.add_argument(
        &#34;--trust-remote-code&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Whether or not to allow for custom models defined on the Hub in their own modeling files.&#34;,
    )
    parser.add_argument(
        &#34;--context-length&#34;,
        type=int,
        default=ServerArgs.context_length,
        help=&#34;The model&#39;s maximum context length. Defaults to None (will use the value from the model&#39;s config.json instead).&#34;,
    )
    parser.add_argument(
        &#34;--is-embedding&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Whether to use a CausalLM as an embedding model.&#34;,
    )
    parser.add_argument(
        &#34;--enable-multimodal&#34;,
        default=ServerArgs.enable_multimodal,
        action=&#34;store_true&#34;,
        help=&#34;Enable the multimodal functionality for the served model. If the model being served is not multimodal, nothing will happen&#34;,
    )
    parser.add_argument(
        &#34;--revision&#34;,
        type=str,
        default=None,
        help=&#34;The specific model version to use. It can be a branch &#34;
        &#34;name, a tag name, or a commit id. If unspecified, will use &#34;
        &#34;the default version.&#34;,
    )
    parser.add_argument(
        &#34;--model-impl&#34;,
        type=str,
        default=ServerArgs.model_impl,
        help=&#34;Which implementation of the model to use.\n\n&#34;
        &#39;* &#34;auto&#34; will try to use the SGLang implementation if it exists &#39;
        &#34;and fall back to the Transformers implementation if no SGLang &#34;
        &#34;implementation is available.\n&#34;
        &#39;* &#34;sglang&#34; will use the SGLang model implementation.\n&#39;
        &#39;* &#34;transformers&#34; will use the Transformers model &#39;
        &#34;implementation.\n&#34;,
    )

    # HTTP server
    parser.add_argument(
        &#34;--host&#34;,
        type=str,
        default=ServerArgs.host,
        help=&#34;The host of the HTTP server.&#34;,
    )
    parser.add_argument(
        &#34;--port&#34;,
        type=int,
        default=ServerArgs.port,
        help=&#34;The port of the HTTP server.&#34;,
    )
    parser.add_argument(
        &#34;--skip-server-warmup&#34;,
        action=&#34;store_true&#34;,
        help=&#34;If set, skip warmup.&#34;,
    )
    parser.add_argument(
        &#34;--warmups&#34;,
        type=str,
        required=False,
        help=&#34;Specify custom warmup functions (csv) to run before server starts eg. --warmups=warmup_name1,warmup_name2 &#34;
        &#34;will run the functions `warmup_name1` and `warmup_name2` specified in warmup.py before the server starts listening for requests&#34;,
    )
    parser.add_argument(
        &#34;--nccl-port&#34;,
        type=int,
        default=ServerArgs.nccl_port,
        help=&#34;The port for NCCL distributed environment setup. Defaults to a random port.&#34;,
    )

    # Quantization and data type
    parser.add_argument(
        &#34;--dtype&#34;,
        type=str,
        default=ServerArgs.dtype,
        choices=[&#34;auto&#34;, &#34;half&#34;, &#34;float16&#34;, &#34;bfloat16&#34;, &#34;float&#34;, &#34;float32&#34;],
        help=&#34;Data type for model weights and activations.\n\n&#34;
        &#39;* &#34;auto&#34; will use FP16 precision for FP32 and FP16 models, and &#39;
        &#34;BF16 precision for BF16 models.\n&#34;
        &#39;* &#34;half&#34; for FP16. Recommended for AWQ quantization.\n&#39;
        &#39;* &#34;float16&#34; is the same as &#34;half&#34;.\n&#39;
        &#39;* &#34;bfloat16&#34; for a balance between precision and range.\n&#39;
        &#39;* &#34;float&#34; is shorthand for FP32 precision.\n&#39;
        &#39;* &#34;float32&#34; for FP32 precision.&#39;,
    )
    parser.add_argument(
        &#34;--quantization&#34;,
        type=str,
        default=ServerArgs.quantization,
        choices=QUANTIZATION_CHOICES,
        help=&#34;The quantization method.&#34;,
    )
    parser.add_argument(
        &#34;--quantization-param-path&#34;,
        type=nullable_str,
        default=None,
        help=&#34;Path to the JSON file containing the KV cache &#34;
        &#34;scaling factors. This should generally be supplied, when &#34;
        &#34;KV cache dtype is FP8. Otherwise, KV cache scaling factors &#34;
        &#34;default to 1.0, which may cause accuracy issues. &#34;,
    )
    parser.add_argument(
        &#34;--kv-cache-dtype&#34;,
        type=str,
        default=ServerArgs.kv_cache_dtype,
        choices=[&#34;auto&#34;, &#34;fp8_e5m2&#34;, &#34;fp8_e4m3&#34;],
        help=&#39;Data type for kv cache storage. &#34;auto&#34; will use model data type. &#34;fp8_e5m2&#34; and &#34;fp8_e4m3&#34; is supported for CUDA 11.8+.&#39;,
    )

    # Memory and scheduling
    parser.add_argument(
        &#34;--mem-fraction-static&#34;,
        type=float,
        default=ServerArgs.mem_fraction_static,
        help=&#34;The fraction of the memory used for static allocation (model weights and KV cache memory pool). Use a smaller value if you see out-of-memory errors.&#34;,
    )
    parser.add_argument(
        &#34;--max-running-requests&#34;,
        type=int,
        default=ServerArgs.max_running_requests,
        help=&#34;The maximum number of running requests.&#34;,
    )
    parser.add_argument(
        &#34;--max-queued-requests&#34;,
        type=int,
        default=ServerArgs.max_queued_requests,
        help=&#34;The maximum number of queued requests. This option is ignored when using disaggregation-mode.&#34;,
    )
    parser.add_argument(
        &#34;--max-total-tokens&#34;,
        type=int,
        default=ServerArgs.max_total_tokens,
        help=&#34;The maximum number of tokens in the memory pool. If not specified, it will be automatically calculated based on the memory usage fraction. &#34;
        &#34;This option is typically used for development and debugging purposes.&#34;,
    )
    parser.add_argument(
        &#34;--chunked-prefill-size&#34;,
        type=int,
        default=ServerArgs.chunked_prefill_size,
        help=&#34;The maximum number of tokens in a chunk for the chunked prefill. Setting this to -1 means disabling chunked prefill.&#34;,
    )
    parser.add_argument(
        &#34;--max-prefill-tokens&#34;,
        type=int,
        default=ServerArgs.max_prefill_tokens,
        help=&#34;The maximum number of tokens in a prefill batch. The real bound will be the maximum of this value and the model&#39;s maximum context length.&#34;,
    )
    parser.add_argument(
        &#34;--schedule-policy&#34;,
        type=str,
        default=ServerArgs.schedule_policy,
        choices=[&#34;lpm&#34;, &#34;random&#34;, &#34;fcfs&#34;, &#34;dfs-weight&#34;, &#34;lof&#34;],
        help=&#34;The scheduling policy of the requests.&#34;,
    )
    parser.add_argument(
        &#34;--schedule-conservativeness&#34;,
        type=float,
        default=ServerArgs.schedule_conservativeness,
        help=&#34;How conservative the schedule policy is. A larger value means more conservative scheduling. Use a larger value if you see requests being retracted frequently.&#34;,
    )
    parser.add_argument(
        &#34;--page-size&#34;,
        type=int,
        default=ServerArgs.page_size,
        help=&#34;The number of tokens in a page.&#34;,
    )
    parser.add_argument(
        &#34;--hybrid-kvcache-ratio&#34;,
        nargs=&#34;?&#34;,
        const=0.5,
        type=float,
        default=ServerArgs.hybrid_kvcache_ratio,
        help=(
            &#34;Mix ratio in [0,1] between uniform and hybrid kv buffers &#34;
            &#34;(0.0 = pure uniform: swa_size / full_size = 1)&#34;
            &#34;(1.0 = pure hybrid: swa_size / full_size = local_attention_size / context_length)&#34;
        ),
    )
    parser.add_argument(
        &#34;--swa-full-tokens-ratio&#34;,
        type=float,
        default=ServerArgs.swa_full_tokens_ratio,
        help=&#34;The ratio of SWA layer KV tokens / full layer KV tokens, regardless of the number of swa:full layers. It should be between 0 and 1. &#34;
        &#34;E.g. 0.5 means if each swa layer has 50 tokens, then each full layer has 100 tokens.&#34;,
    )
    parser.add_argument(
        &#34;--disable-hybrid-swa-memory&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Disable the hybrid SWA memory.&#34;,
    )

    # Runtime options
    parser.add_argument(
        &#34;--device&#34;,
        type=str,
        default=ServerArgs.device,
        help=&#34;The device to use (&#39;cuda&#39;, &#39;xpu&#39;, &#39;hpu&#39;, &#39;npu&#39;, &#39;cpu&#39;). Defaults to auto-detection if not specified.&#34;,
    )
    parser.add_argument(
        &#34;--tensor-parallel-size&#34;,
        &#34;--tp-size&#34;,
        type=int,
        default=ServerArgs.tp_size,
        help=&#34;The tensor parallelism size.&#34;,
    )
    parser.add_argument(
        &#34;--pipeline-parallel-size&#34;,
        &#34;--pp-size&#34;,
        type=int,
        default=ServerArgs.pp_size,
        help=&#34;The pipeline parallelism size.&#34;,
    )
    parser.add_argument(
        &#34;--max-micro-batch-size&#34;,
        type=int,
        default=ServerArgs.max_micro_batch_size,
        help=&#34;The maximum micro batch size in pipeline parallelism.&#34;,
    )
    parser.add_argument(
        &#34;--stream-interval&#34;,
        type=int,
        default=ServerArgs.stream_interval,
        help=&#34;The interval (or buffer size) for streaming in terms of the token length. A smaller value makes streaming smoother, while a larger value makes the throughput higher&#34;,
    )
    parser.add_argument(
        &#34;--stream-output&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Whether to output as a sequence of disjoint segments.&#34;,
    )
    parser.add_argument(
        &#34;--random-seed&#34;,
        type=int,
        default=ServerArgs.random_seed,
        help=&#34;The random seed.&#34;,
    )
    parser.add_argument(
        &#34;--constrained-json-whitespace-pattern&#34;,
        type=str,
        default=ServerArgs.constrained_json_whitespace_pattern,
        help=&#34;(outlines backend only) Regex pattern for syntactic whitespaces allowed in JSON constrained output. For example, to allow the model generate consecutive whitespaces, set the pattern to [\n\t ]*&#34;,
    )
    parser.add_argument(
        &#34;--watchdog-timeout&#34;,
        type=float,
        default=ServerArgs.watchdog_timeout,
        help=&#34;Set watchdog timeout in seconds. If a forward batch takes longer than this, the server will crash to prevent hanging.&#34;,
    )
    parser.add_argument(
        &#34;--dist-timeout&#34;,
        type=int,
        default=ServerArgs.dist_timeout,
        help=&#34;Set timeout for torch.distributed initialization.&#34;,
    )
    parser.add_argument(
        &#34;--download-dir&#34;,
        type=str,
        default=ServerArgs.download_dir,
        help=&#34;Model download directory for huggingface.&#34;,
    )
    parser.add_argument(
        &#34;--base-gpu-id&#34;,
        type=int,
        default=ServerArgs.base_gpu_id,
        help=&#34;The base GPU ID to start allocating GPUs from. Useful when running multiple instances on the same machine.&#34;,
    )
    parser.add_argument(
        &#34;--gpu-id-step&#34;,
        type=int,
        default=ServerArgs.gpu_id_step,
        help=&#34;The delta between consecutive GPU IDs that are used. For example, setting it to 2 will use GPU 0,2,4,...&#34;,
    )
    parser.add_argument(
        &#34;--sleep-on-idle&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Reduce CPU usage when sglang is idle.&#34;,
    )

    # Logging
    parser.add_argument(
        &#34;--log-level&#34;,
        type=str,
        default=ServerArgs.log_level,
        help=&#34;The logging level of all loggers.&#34;,
    )
    parser.add_argument(
        &#34;--log-level-http&#34;,
        type=str,
        default=ServerArgs.log_level_http,
        help=&#34;The logging level of HTTP server. If not set, reuse --log-level by default.&#34;,
    )
    parser.add_argument(
        &#34;--log-requests&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Log metadata, inputs, outputs of all requests. The verbosity is decided by --log-requests-level&#34;,
    )
    parser.add_argument(
        &#34;--log-requests-level&#34;,
        type=int,
        default=ServerArgs.log_requests_level,
        help=&#34;0: Log metadata (no sampling parameters). 1: Log metadata and sampling parameters. 2: Log metadata, sampling parameters and partial input/output. 3: Log every input/output.&#34;,
        choices=[0, 1, 2, 3],
    )
    parser.add_argument(
        &#34;--crash-dump-folder&#34;,
        type=str,
        default=ServerArgs.crash_dump_folder,
        help=&#34;Folder path to dump requests from the last 5 min before a crash (if any). If not specified, crash dumping is disabled.&#34;,
    )
    parser.add_argument(
        &#34;--show-time-cost&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Show time cost of custom marks.&#34;,
    )
    parser.add_argument(
        &#34;--enable-metrics&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Enable log prometheus metrics.&#34;,
    )
    parser.add_argument(
        &#34;--enable-metrics-for-all-schedulers&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Enable --enable-metrics-for-all-schedulers when you want schedulers on all TP ranks (not just TP 0) &#34;
        &#34;to record request metrics separately. This is especially useful when dp_attention is enabled, as &#34;
        &#34;otherwise all metrics appear to come from TP 0.&#34;,
    )
    parser.add_argument(
        &#34;--bucket-time-to-first-token&#34;,
        type=float,
        nargs=&#34;+&#34;,
        default=ServerArgs.bucket_time_to_first_token,
        help=&#34;The buckets of time to first token, specified as a list of floats.&#34;,
    )
    parser.add_argument(
        &#34;--bucket-inter-token-latency&#34;,
        type=float,
        nargs=&#34;+&#34;,
        default=ServerArgs.bucket_inter_token_latency,
        help=&#34;The buckets of inter-token latency, specified as a list of floats.&#34;,
    )
    parser.add_argument(
        &#34;--bucket-e2e-request-latency&#34;,
        type=float,
        nargs=&#34;+&#34;,
        default=ServerArgs.bucket_e2e_request_latency,
        help=&#34;The buckets of end-to-end request latency, specified as a list of floats.&#34;,
    )
    parser.add_argument(
        &#34;--collect-tokens-histogram&#34;,
        action=&#34;store_true&#34;,
        default=ServerArgs.collect_tokens_histogram,
        help=&#34;Collect prompt/generation tokens histogram.&#34;,
    )
    parser.add_argument(
        &#34;--gc-warning-threshold-secs&#34;,
        type=float,
        default=ServerArgs.gc_warning_threshold_secs,
        help=&#34;The threshold for long GC warning. If a GC takes longer than this, a warning will be logged. Set to 0 to disable.&#34;,
    )
    parser.add_argument(
        &#34;--decode-log-interval&#34;,
        type=int,
        default=ServerArgs.decode_log_interval,
        help=&#34;The log interval of decode batch.&#34;,
    )
    parser.add_argument(
        &#34;--enable-request-time-stats-logging&#34;,
        action=&#34;store_true&#34;,
        default=ServerArgs.enable_request_time_stats_logging,
        help=&#34;Enable per request time stats logging&#34;,
    )
    parser.add_argument(
        &#34;--kv-events-config&#34;,
        type=str,
        default=None,
        help=&#34;Config in json format for NVIDIA dynamo KV event publishing. Publishing will be enabled if this flag is used.&#34;,
    )

    # API related
    parser.add_argument(
        &#34;--api-key&#34;,
        type=str,
        default=ServerArgs.api_key,
        help=&#34;Set API key of the server. It is also used in the OpenAI API compatible server.&#34;,
    )
    parser.add_argument(
        &#34;--served-model-name&#34;,
        type=str,
        default=ServerArgs.served_model_name,
        help=&#34;Override the model name returned by the v1/models endpoint in OpenAI API server.&#34;,
    )
    parser.add_argument(
        &#34;--weight-version&#34;,
        type=str,
        default=ServerArgs.weight_version,
        help=&#34;Version identifier for the model weights. Defaults to &#39;default&#39; if not specified.&#34;,
    )
    parser.add_argument(
        &#34;--chat-template&#34;,
        type=str,
        default=ServerArgs.chat_template,
        help=&#34;The buliltin chat template name or the path of the chat template file. This is only used for OpenAI-compatible API server.&#34;,
    )
    parser.add_argument(
        &#34;--completion-template&#34;,
        type=str,
        default=ServerArgs.completion_template,
        help=&#34;The buliltin completion template name or the path of the completion template file. This is only used for OpenAI-compatible API server. only for code completion currently.&#34;,
    )
    parser.add_argument(
        &#34;--file-storage-path&#34;,
        type=str,
        default=ServerArgs.file_storage_path,
        help=&#34;The path of the file storage in backend.&#34;,
    )
    parser.add_argument(
        &#34;--enable-cache-report&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Return number of cached tokens in usage.prompt_tokens_details for each openai request.&#34;,
    )
    parser.add_argument(
        &#34;--reasoning-parser&#34;,
        type=str,
        choices=list(ReasoningParser.DetectorMap.keys()),
        default=ServerArgs.reasoning_parser,
        help=f&#34;Specify the parser for reasoning models, supported parsers are: {list(ReasoningParser.DetectorMap.keys())}.&#34;,
    )
    tool_call_parser_choices = list(FunctionCallParser.ToolCallParserEnum.keys())
    parser.add_argument(
        &#34;--tool-call-parser&#34;,
        type=str,
        choices=tool_call_parser_choices,
        default=ServerArgs.tool_call_parser,
        help=f&#34;Specify the parser for handling tool-call interactions. Options include: {tool_call_parser_choices}.&#34;,
    )
    parser.add_argument(
        &#34;--tool-server&#34;,
        type=str,
        default=None,
        help=&#34;Either &#39;demo&#39; or a comma-separated list of tool server urls to use for the model. If not specified, no tool server will be used.&#34;,
    )

    # Data parallelism
    parser.add_argument(
        &#34;--data-parallel-size&#34;,
        &#34;--dp-size&#34;,
        type=int,
        default=ServerArgs.dp_size,
        help=&#34;The data parallelism size.&#34;,
    )
    parser.add_argument(
        &#34;--load-balance-method&#34;,
        type=str,
        default=ServerArgs.load_balance_method,
        help=&#34;The load balancing strategy for data parallelism.&#34;,
        choices=[
            &#34;round_robin&#34;,
            &#34;shortest_queue&#34;,
            &#34;minimum_tokens&#34;,
        ],
    )

    # Multi-node distributed serving
    parser.add_argument(
        &#34;--dist-init-addr&#34;,
        &#34;--nccl-init-addr&#34;,  # For backward compatibility. This will be removed in the future.
        type=str,
        help=&#34;The host address for initializing distributed backend (e.g., `192.168.0.2:25000`).&#34;,
    )
    parser.add_argument(
        &#34;--nnodes&#34;, type=int, default=ServerArgs.nnodes, help=&#34;The number of nodes.&#34;
    )
    parser.add_argument(
        &#34;--node-rank&#34;, type=int, default=ServerArgs.node_rank, help=&#34;The node rank.&#34;
    )

    # Model override args
    parser.add_argument(
        &#34;--json-model-override-args&#34;,
        type=str,
        help=&#34;A dictionary in JSON string format used to override default model configurations.&#34;,
        default=ServerArgs.json_model_override_args,
    )
    parser.add_argument(
        &#34;--preferred-sampling-params&#34;,
        type=str,
        help=&#34;json-formatted sampling settings that will be returned in /get_model_info&#34;,
    )

    # LoRA
    parser.add_argument(
        &#34;--enable-lora&#34;,
        default=ServerArgs.enable_lora,
        action=&#34;store_true&#34;,
        help=&#34;Enable LoRA support for the model. This argument is automatically set to True if `--lora-paths` is provided for backward compatibility.&#34;,
    )
    parser.add_argument(
        &#34;--max-lora-rank&#34;,
        default=ServerArgs.max_lora_rank,
        type=int,
        help=&#34;The maximum rank of LoRA adapters. If not specified, it will be automatically inferred from the adapters provided in --lora-paths.&#34;,
    )
    parser.add_argument(
        &#34;--lora-target-modules&#34;,
        type=str,
        choices=SUPPORTED_LORA_TARGET_MODULES + [LORA_TARGET_ALL_MODULES],
        nargs=&#34;*&#34;,
        default=None,
        help=&#34;The union set of all target modules where LoRA should be applied. If not specified, &#34;
        &#34;it will be automatically inferred from the adapters provided in --lora-paths. If &#39;all&#39; is specified, &#34;
        &#34;all supported modules will be targeted.&#34;,
    )
    parser.add_argument(
        &#34;--lora-paths&#34;,
        type=str,
        nargs=&#34;*&#34;,
        default=None,
        action=LoRAPathAction,
        help=&#39;The list of LoRA adapters to load. Each adapter must be specified in one of the following formats: &lt;PATH&gt; | &lt;NAME&gt;=&lt;PATH&gt; | JSON with schema {&#34;lora_name&#34;:str,&#34;lora_path&#34;:str,&#34;pinned&#34;:bool}&#39;,
    )
    parser.add_argument(
        &#34;--max-loras-per-batch&#34;,
        type=int,
        default=8,
        help=&#34;Maximum number of adapters for a running batch, include base-only request.&#34;,
    )
    parser.add_argument(
        &#34;--max-loaded-loras&#34;,
        type=int,
        default=ServerArgs.max_loaded_loras,
        help=&#34;If specified, it limits the maximum number of LoRA adapters loaded in CPU memory at a time. The value must be greater than or equal to `--max-loras-per-batch`.&#34;,
    )
    parser.add_argument(
        &#34;--lora-backend&#34;,
        type=str,
        default=&#34;triton&#34;,
        help=&#34;Choose the kernel backend for multi-LoRA serving.&#34;,
    )

    # Kernel backend
    parser.add_argument(
        &#34;--attention-backend&#34;,
        type=str,
        choices=ATTENTION_BACKEND_CHOICES,
        default=ServerArgs.attention_backend,
        help=&#34;Choose the kernels for attention layers.&#34;,
    )
    parser.add_argument(
        &#34;--prefill-attention-backend&#34;,
        type=str,
        choices=ATTENTION_BACKEND_CHOICES,
        default=ServerArgs.prefill_attention_backend,
        help=&#34;Choose the kernels for prefill attention layers (have priority over --attention-backend).&#34;,
    )
    parser.add_argument(
        &#34;--decode-attention-backend&#34;,
        type=str,
        choices=ATTENTION_BACKEND_CHOICES,
        default=ServerArgs.decode_attention_backend,
        help=&#34;Choose the kernels for decode attention layers (have priority over --attention-backend).&#34;,
    )
    parser.add_argument(
        &#34;--sampling-backend&#34;,
        type=str,
        choices=[&#34;flashinfer&#34;, &#34;pytorch&#34;],
        default=ServerArgs.sampling_backend,
        help=&#34;Choose the kernels for sampling layers.&#34;,
    )
    parser.add_argument(
        &#34;--grammar-backend&#34;,
        type=str,
        choices=[&#34;xgrammar&#34;, &#34;outlines&#34;, &#34;llguidance&#34;, &#34;none&#34;],
        default=ServerArgs.grammar_backend,
        help=&#34;Choose the backend for grammar-guided decoding.&#34;,
    )
    parser.add_argument(
        &#34;--mm-attention-backend&#34;,
        type=str,
        choices=[&#34;sdpa&#34;, &#34;fa3&#34;, &#34;triton_attn&#34;],
        default=ServerArgs.mm_attention_backend,
        help=&#34;Set multimodal attention backend.&#34;,
    )

    # Speculative decoding
    parser.add_argument(
        &#34;--speculative-algorithm&#34;,
        type=str,
        choices=[&#34;EAGLE&#34;, &#34;EAGLE3&#34;, &#34;NEXTN&#34;],
        help=&#34;Speculative algorithm.&#34;,
    )
    parser.add_argument(
        &#34;--speculative-draft-model-path&#34;,
        type=str,
        help=&#34;The path of the draft model weights. This can be a local folder or a Hugging Face repo ID.&#34;,
    )
    parser.add_argument(
        &#34;--speculative-num-steps&#34;,
        type=int,
        help=&#34;The number of steps sampled from draft model in Speculative Decoding.&#34;,
        default=ServerArgs.speculative_num_steps,
    )
    parser.add_argument(
        &#34;--speculative-eagle-topk&#34;,
        type=int,
        help=&#34;The number of tokens sampled from the draft model in eagle2 each step.&#34;,
        default=ServerArgs.speculative_eagle_topk,
    )
    parser.add_argument(
        &#34;--speculative-num-draft-tokens&#34;,
        type=int,
        help=&#34;The number of tokens sampled from the draft model in Speculative Decoding.&#34;,
        default=ServerArgs.speculative_num_draft_tokens,
    )
    parser.add_argument(
        &#34;--speculative-accept-threshold-single&#34;,
        type=float,
        help=&#34;Accept a draft token if its probability in the target model is greater than this threshold.&#34;,
        default=ServerArgs.speculative_accept_threshold_single,
    )
    parser.add_argument(
        &#34;--speculative-accept-threshold-acc&#34;,
        type=float,
        help=&#34;The accept probability of a draft token is raised from its target probability p to min(1, p / threshold_acc).&#34;,
        default=ServerArgs.speculative_accept_threshold_acc,
    )
    parser.add_argument(
        &#34;--speculative-token-map&#34;,
        type=str,
        help=&#34;The path of the draft model&#39;s small vocab table.&#34;,
        default=ServerArgs.speculative_token_map,
    )

    # Expert parallelism
    parser.add_argument(
        &#34;--expert-parallel-size&#34;,
        &#34;--ep-size&#34;,
        &#34;--ep&#34;,
        type=int,
        default=ServerArgs.ep_size,
        help=&#34;The expert parallelism size.&#34;,
    )
    parser.add_argument(
        &#34;--moe-a2a-backend&#34;,
        type=str,
        choices=[&#34;none&#34;, &#34;deepep&#34;],
        default=ServerArgs.moe_a2a_backend,
        help=&#34;Choose the backend for MoE A2A.&#34;,
    )
    parser.add_argument(
        &#34;--moe-runner-backend&#34;,
        type=str,
        choices=[
            &#34;auto&#34;,
            &#34;triton&#34;,
            &#34;triton_kernel&#34;,
            &#34;flashinfer_trtllm&#34;,
            &#34;flashinfer_cutlass&#34;,
            &#34;flashinfer_mxfp4&#34;,
        ],
        default=ServerArgs.moe_runner_backend,
        help=&#34;Choose the runner backend for MoE.&#34;,
    )
    parser.add_argument(
        &#34;--flashinfer-mxfp4-moe-precision&#34;,
        type=str,
        choices=[&#34;mxfp4&#34;, &#34;bf16&#34;],
        default=ServerArgs.flashinfer_mxfp4_moe_precision,
        help=&#34;Choose the computation precision of flashinfer mxfp4 moe&#34;,
    )
    parser.add_argument(
        &#34;--enable-flashinfer-allreduce-fusion&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Enable FlashInfer allreduce fusion with Residual RMSNorm.&#34;,
    )
    parser.add_argument(
        &#34;--deepep-mode&#34;,
        type=str,
        choices=[&#34;normal&#34;, &#34;low_latency&#34;, &#34;auto&#34;],
        default=&#34;auto&#34;,
        help=&#34;Select the mode when enable DeepEP MoE, could be `normal`, `low_latency` or `auto`. Default is `auto`, which means `low_latency` for decode batch and `normal` for prefill batch.&#34;,
    )
    parser.add_argument(
        &#34;--ep-num-redundant-experts&#34;,
        type=int,
        default=ServerArgs.ep_num_redundant_experts,
        help=&#34;Allocate this number of redundant experts in expert parallel.&#34;,
    )
    parser.add_argument(
        &#34;--ep-dispatch-algorithm&#34;,
        type=str,
        default=ServerArgs.ep_dispatch_algorithm,
        help=&#34;The algorithm to choose ranks for redundant experts in expert parallel.&#34;,
    )
    parser.add_argument(
        &#34;--init-expert-location&#34;,
        type=str,
        default=ServerArgs.init_expert_location,
        help=&#34;Initial location of EP experts.&#34;,
    )
    parser.add_argument(
        &#34;--enable-eplb&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Enable EPLB algorithm&#34;,
    )
    parser.add_argument(
        &#34;--eplb-algorithm&#34;,
        type=str,
        default=ServerArgs.eplb_algorithm,
        help=&#34;Chosen EPLB algorithm&#34;,
    )
    parser.add_argument(
        &#34;--eplb-rebalance-num-iterations&#34;,
        type=int,
        default=ServerArgs.eplb_rebalance_num_iterations,
        help=&#34;Number of iterations to automatically trigger a EPLB re-balance.&#34;,
    )
    parser.add_argument(
        &#34;--eplb-rebalance-layers-per-chunk&#34;,
        type=int,
        default=ServerArgs.eplb_rebalance_layers_per_chunk,
        help=&#34;Number of layers to rebalance per forward pass.&#34;,
    )
    parser.add_argument(
        &#34;--eplb-min-rebalancing-utilization-threshold&#34;,
        type=float,
        default=ServerArgs.eplb_min_rebalancing_utilization_threshold,
        help=&#34;Minimum threshold for GPU average utilization to trigger EPLB rebalancing. Must be in the range [0.0, 1.0].&#34;,
    )
    parser.add_argument(
        &#34;--expert-distribution-recorder-mode&#34;,
        type=str,
        default=ServerArgs.expert_distribution_recorder_mode,
        help=&#34;Mode of expert distribution recorder.&#34;,
    )
    parser.add_argument(
        &#34;--expert-distribution-recorder-buffer-size&#34;,
        type=int,
        default=ServerArgs.expert_distribution_recorder_buffer_size,
        help=&#34;Circular buffer size of expert distribution recorder. Set to -1 to denote infinite buffer.&#34;,
    )
    parser.add_argument(
        &#34;--enable-expert-distribution-metrics&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Enable logging metrics for expert balancedness&#34;,
    )
    parser.add_argument(
        &#34;--deepep-config&#34;,
        type=str,
        default=ServerArgs.deepep_config,
        help=&#34;Tuned DeepEP config suitable for your own cluster. It can be either a string with JSON content or a file path.&#34;,
    )
    parser.add_argument(
        &#34;--moe-dense-tp-size&#34;,
        type=int,
        default=ServerArgs.moe_dense_tp_size,
        help=&#34;TP size for MoE dense MLP layers. This flag is useful when, with large TP size, there are errors caused by weights in MLP layers having dimension smaller than the min dimension GEMM supports.&#34;,
    )

    # Hierarchical cache
    parser.add_argument(
        &#34;--enable-hierarchical-cache&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Enable hierarchical cache&#34;,
    )
    parser.add_argument(
        &#34;--hicache-ratio&#34;,
        type=float,
        default=ServerArgs.hicache_ratio,
        help=&#34;The ratio of the size of host KV cache memory pool to the size of device pool.&#34;,
    )
    parser.add_argument(
        &#34;--hicache-size&#34;,
        type=int,
        default=ServerArgs.hicache_size,
        help=&#34;The size of host KV cache memory pool in gigabytes, which will override the hicache_ratio if set.&#34;,
    )
    parser.add_argument(
        &#34;--hicache-write-policy&#34;,
        type=str,
        choices=[&#34;write_back&#34;, &#34;write_through&#34;, &#34;write_through_selective&#34;],
        default=ServerArgs.hicache_write_policy,
        help=&#34;The write policy of hierarchical cache.&#34;,
    )
    parser.add_argument(
        &#34;--hicache-io-backend&#34;,
        type=str,
        choices=[&#34;direct&#34;, &#34;kernel&#34;],
        default=ServerArgs.hicache_io_backend,
        help=&#34;The IO backend for KV cache transfer between CPU and GPU&#34;,
    )
    parser.add_argument(
        &#34;--hicache-mem-layout&#34;,
        type=str,
        choices=[&#34;layer_first&#34;, &#34;page_first&#34;],
        default=ServerArgs.hicache_mem_layout,
        help=&#34;The layout of host memory pool for hierarchical cache.&#34;,
    )
    parser.add_argument(
        &#34;--hicache-storage-backend&#34;,
        type=str,
        choices=[&#34;file&#34;, &#34;mooncake&#34;, &#34;hf3fs&#34;, &#34;nixl&#34;],
        default=ServerArgs.hicache_storage_backend,
        help=&#34;The storage backend for hierarchical KV cache.&#34;,
    )
    parser.add_argument(
        &#34;--hicache-storage-prefetch-policy&#34;,
        type=str,
        choices=[&#34;best_effort&#34;, &#34;wait_complete&#34;, &#34;timeout&#34;],
        default=ServerArgs.hicache_storage_prefetch_policy,
        help=&#34;Control when prefetching from the storage backend should stop.&#34;,
    )
    parser.add_argument(
        &#34;--hicache-storage-backend-extra-config&#34;,
        type=str,
        default=ServerArgs.hicache_storage_backend_extra_config,
        help=&#34;A dictionary in JSON string format containing extra configuration for the storage backend.&#34;,
    )

    # Double Sparsity
    parser.add_argument(
        &#34;--enable-double-sparsity&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Enable double sparsity attention&#34;,
    )
    parser.add_argument(
        &#34;--ds-channel-config-path&#34;,
        type=str,
        default=ServerArgs.ds_channel_config_path,
        help=&#34;The path of the double sparsity channel config&#34;,
    )
    parser.add_argument(
        &#34;--ds-heavy-channel-num&#34;,
        type=int,
        default=ServerArgs.ds_heavy_channel_num,
        help=&#34;The number of heavy channels in double sparsity attention&#34;,
    )
    parser.add_argument(
        &#34;--ds-heavy-token-num&#34;,
        type=int,
        default=ServerArgs.ds_heavy_token_num,
        help=&#34;The number of heavy tokens in double sparsity attention&#34;,
    )
    parser.add_argument(
        &#34;--ds-heavy-channel-type&#34;,
        type=str,
        default=ServerArgs.ds_heavy_channel_type,
        help=&#34;The type of heavy channels in double sparsity attention&#34;,
    )
    parser.add_argument(
        &#34;--ds-sparse-decode-threshold&#34;,
        type=int,
        default=ServerArgs.ds_sparse_decode_threshold,
        help=&#34;The type of heavy channels in double sparsity attention&#34;,
    )

    # Offloading
    parser.add_argument(
        &#34;--cpu-offload-gb&#34;,
        type=int,
        default=ServerArgs.cpu_offload_gb,
        help=&#34;How many GBs of RAM to reserve for CPU offloading.&#34;,
    )
    parser.add_argument(
        &#34;--offload-group-size&#34;,
        type=int,
        default=ServerArgs.offload_group_size,
        help=&#34;Number of layers per group in offloading.&#34;,
    )
    parser.add_argument(
        &#34;--offload-num-in-group&#34;,
        type=int,
        default=ServerArgs.offload_num_in_group,
        help=&#34;Number of layers to be offloaded within a group.&#34;,
    )
    parser.add_argument(
        &#34;--offload-prefetch-step&#34;,
        type=int,
        default=ServerArgs.offload_prefetch_step,
        help=&#34;Steps to prefetch in offloading.&#34;,
    )
    parser.add_argument(
        &#34;--offload-mode&#34;,
        type=str,
        default=ServerArgs.offload_mode,
        help=&#34;Mode of offloading.&#34;,
    )

    # Optimization/debug options
    parser.add_argument(
        &#34;--disable-radix-cache&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Disable RadixAttention for prefix caching.&#34;,
    )
    parser.add_argument(
        &#34;--cuda-graph-max-bs&#34;,
        type=int,
        default=ServerArgs.cuda_graph_max_bs,
        help=&#34;Set the maximum batch size for cuda graph. It will extend the cuda graph capture batch size to this value.&#34;,
    )
    parser.add_argument(
        &#34;--cuda-graph-bs&#34;,
        type=int,
        nargs=&#34;+&#34;,
        help=&#34;Set the list of batch sizes for cuda graph.&#34;,
    )
    parser.add_argument(
        &#34;--disable-cuda-graph&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Disable cuda graph.&#34;,
    )
    parser.add_argument(
        &#34;--disable-cuda-graph-padding&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Disable cuda graph when padding is needed. Still uses cuda graph when padding is not needed.&#34;,
    )
    parser.add_argument(
        &#34;--enable-profile-cuda-graph&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Enable profiling of cuda graph capture.&#34;,
    )
    parser.add_argument(
        &#34;--enable-cudagraph-gc&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Enable garbage collection during CUDA graph capture. If disabled (default), GC is frozen during capture to speed up the process.&#34;,
    )
    parser.add_argument(
        &#34;--enable-nccl-nvls&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Enable NCCL NVLS for prefill heavy requests when available.&#34;,
    )
    parser.add_argument(
        &#34;--enable-symm-mem&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Enable NCCL symmetric memory for fast collectives.&#34;,
    )
    parser.add_argument(
        &#34;--disable-flashinfer-cutlass-moe-fp4-allgather&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Disables quantize before all-gather for flashinfer cutlass moe.&#34;,
    )
    parser.add_argument(
        &#34;--enable-tokenizer-batch-encode&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Enable batch tokenization for improved performance when processing multiple text inputs. Do not use with image inputs, pre-tokenized input_ids, or input_embeds.&#34;,
    )
    parser.add_argument(
        &#34;--disable-outlines-disk-cache&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Disable disk cache of outlines to avoid possible crashes related to file system or high concurrency.&#34;,
    )
    parser.add_argument(
        &#34;--disable-custom-all-reduce&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Disable the custom all-reduce kernel and fall back to NCCL.&#34;,
    )
    parser.add_argument(
        &#34;--enable-mscclpp&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Enable using mscclpp for small messages for all-reduce kernel and fall back to NCCL.&#34;,
    )
    parser.add_argument(
        &#34;--disable-overlap-schedule&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Disable the overlap scheduler, which overlaps the CPU scheduler with GPU model worker.&#34;,
    )
    parser.add_argument(
        &#34;--enable-mixed-chunk&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Enabling mixing prefill and decode in a batch when using chunked prefill.&#34;,
    )
    parser.add_argument(
        &#34;--enable-dp-attention&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Enabling data parallelism for attention and tensor parallelism for FFN. The dp size should be equal to the tp size. Currently DeepSeek-V2 and Qwen 2/3 MoE models are supported.&#34;,
    )
    parser.add_argument(
        &#34;--enable-dp-lm-head&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Enable vocabulary parallel across the attention TP group to avoid all-gather across DP groups, optimizing performance under DP attention.&#34;,
    )
    parser.add_argument(
        &#34;--enable-two-batch-overlap&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Enabling two micro batches to overlap.&#34;,
    )
    parser.add_argument(
        &#34;--tbo-token-distribution-threshold&#34;,
        type=float,
        default=ServerArgs.tbo_token_distribution_threshold,
        help=&#34;The threshold of token distribution between two batches in micro-batch-overlap, determines whether to two-batch-overlap or two-chunk-overlap. Set to 0 denote disable two-chunk-overlap.&#34;,
    )
    parser.add_argument(
        &#34;--enable-torch-compile&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Optimize the model with torch.compile. Experimental feature.&#34;,
    )
    parser.add_argument(
        &#34;--torch-compile-max-bs&#34;,
        type=int,
        default=ServerArgs.torch_compile_max_bs,
        help=&#34;Set the maximum batch size when using torch compile.&#34;,
    )
    parser.add_argument(
        &#34;--torchao-config&#34;,
        type=str,
        default=ServerArgs.torchao_config,
        help=&#34;Optimize the model with torchao. Experimental feature. Current choices are: int8dq, int8wo, int4wo-&lt;group_size&gt;, fp8wo, fp8dq-per_tensor, fp8dq-per_row&#34;,
    )
    parser.add_argument(
        &#34;--enable-nan-detection&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Enable the NaN detection for debugging purposes.&#34;,
    )
    parser.add_argument(
        &#34;--enable-p2p-check&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Enable P2P check for GPU access, otherwise the p2p access is allowed by default.&#34;,
    )
    parser.add_argument(
        &#34;--triton-attention-reduce-in-fp32&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Cast the intermediate attention results to fp32 to avoid possible crashes related to fp16.&#34;
        &#34;This only affects Triton attention kernels.&#34;,
    )
    parser.add_argument(
        &#34;--triton-attention-num-kv-splits&#34;,
        type=int,
        default=ServerArgs.triton_attention_num_kv_splits,
        help=&#34;The number of KV splits in flash decoding Triton kernel. Larger value is better in longer context scenarios. The default value is 8.&#34;,
    )
    parser.add_argument(
        &#34;--num-continuous-decode-steps&#34;,
        type=int,
        default=ServerArgs.num_continuous_decode_steps,
        help=&#34;Run multiple continuous decoding steps to reduce scheduling overhead. &#34;
        &#34;This can potentially increase throughput but may also increase time-to-first-token latency. &#34;
        &#34;The default value is 1, meaning only run one decoding step at a time.&#34;,
    )
    parser.add_argument(
        &#34;--delete-ckpt-after-loading&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Delete the model checkpoint after loading the model.&#34;,
    )
    parser.add_argument(
        &#34;--enable-memory-saver&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Allow saving memory using release_memory_occupation and resume_memory_occupation&#34;,
    )
    parser.add_argument(
        &#34;--allow-auto-truncate&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Allow automatically truncating requests that exceed the maximum input length instead of returning an error.&#34;,
    )
    parser.add_argument(
        &#34;--enable-custom-logit-processor&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Enable users to pass custom logit processors to the server (disabled by default for security)&#34;,
    )
    parser.add_argument(
        &#34;--flashinfer-mla-disable-ragged&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Not using ragged prefill wrapper when running flashinfer mla&#34;,
    )
    parser.add_argument(
        &#34;--disable-shared-experts-fusion&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Disable shared experts fusion optimization for deepseek v3/r1.&#34;,
    )
    parser.add_argument(
        &#34;--disable-chunked-prefix-cache&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Disable chunked prefix cache feature for deepseek, which should save overhead for short sequences.&#34;,
    )
    parser.add_argument(
        &#34;--disable-fast-image-processor&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Adopt base image processor instead of fast image processor.&#34;,
    )
    parser.add_argument(
        &#34;--enable-return-hidden-states&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Enable returning hidden states with responses.&#34;,
    )
    parser.add_argument(
        &#34;--scheduler-recv-interval&#34;,
        type=int,
        default=ServerArgs.scheduler_recv_interval,
        help=&#34;The interval to poll requests in scheduler. Can be set to &gt;1 to reduce the overhead of this.&#34;,
    )

    # Debug tensor dumps
    parser.add_argument(
        &#34;--debug-tensor-dump-output-folder&#34;,
        type=str,
        default=ServerArgs.debug_tensor_dump_output_folder,
        help=&#34;The output folder for dumping tensors.&#34;,
    )
    parser.add_argument(
        &#34;--debug-tensor-dump-input-file&#34;,
        type=str,
        default=ServerArgs.debug_tensor_dump_input_file,
        help=&#34;The input filename for dumping tensors&#34;,
    )
    parser.add_argument(
        &#34;--debug-tensor-dump-inject&#34;,
        type=str,
        default=ServerArgs.debug_tensor_dump_inject,
        help=&#34;Inject the outputs from jax as the input of every layer.&#34;,
    )
    parser.add_argument(
        &#34;--debug-tensor-dump-prefill-only&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Only dump the tensors for prefill requests (i.e. batch size &gt; 1).&#34;,
    )

    # PD disaggregation
    parser.add_argument(
        &#34;--disaggregation-mode&#34;,
        type=str,
        default=&#34;null&#34;,
        choices=[&#34;null&#34;, &#34;prefill&#34;, &#34;decode&#34;],
        help=&#39;Only used for PD disaggregation. &#34;prefill&#34; for prefill-only server, and &#34;decode&#34; for decode-only server. If not specified, it is not PD disaggregated&#39;,
    )
    parser.add_argument(
        &#34;--disaggregation-transfer-backend&#34;,
        type=str,
        default=ServerArgs.disaggregation_transfer_backend,
        choices=DISAGG_TRANSFER_BACKEND_CHOICES,
        help=&#34;The backend for disaggregation transfer. Default is mooncake.&#34;,
    )
    parser.add_argument(
        &#34;--disaggregation-bootstrap-port&#34;,
        type=int,
        default=ServerArgs.disaggregation_bootstrap_port,
        help=&#34;Bootstrap server port on the prefill server. Default is 8998.&#34;,
    )
    parser.add_argument(
        &#34;--disaggregation-decode-tp&#34;,
        type=int,
        default=ServerArgs.disaggregation_decode_tp,
        help=&#34;Decode tp size. If not set, it matches the tp size of the current engine. This is only set on the prefill server.&#34;,
    )
    parser.add_argument(
        &#34;--disaggregation-decode-dp&#34;,
        type=int,
        default=ServerArgs.disaggregation_decode_dp,
        help=&#34;Decode dp size. If not set, it matches the dp size of the current engine. This is only set on the prefill server.&#34;,
    )
    parser.add_argument(
        &#34;--disaggregation-prefill-pp&#34;,
        type=int,
        default=ServerArgs.disaggregation_prefill_pp,
        help=&#34;Prefill pp size. If not set, it is default to 1. This is only set on the decode server.&#34;,
    )
    parser.add_argument(
        &#34;--disaggregation-ib-device&#34;,
        type=str,
        default=ServerArgs.disaggregation_ib_device,
        help=&#34;The InfiniBand devices for disaggregation transfer, accepts single device (e.g., --disaggregation-ib-device mlx5_0) &#34;
        &#34;or multiple comma-separated devices (e.g., --disaggregation-ib-device mlx5_0,mlx5_1). &#34;
        &#34;Default is None, which triggers automatic device detection when mooncake backend is enabled.&#34;,
    )
    parser.add_argument(
        &#34;--num-reserved-decode-tokens&#34;,
        type=int,
        default=ServerArgs.num_reserved_decode_tokens,
        help=&#34;Number of decode tokens that will have memory reserved when adding new request to the running batch.&#34;,
    )
    parser.add_argument(
        &#34;--pdlb-url&#34;,
        type=str,
        default=None,
        help=&#34;The URL of the PD disaggregation load balancer. If set, the prefill/decode server will register with the load balancer.&#34;,
    )

    # Custom weight loader
    parser.add_argument(
        &#34;--custom-weight-loader&#34;,
        type=str,
        nargs=&#34;*&#34;,
        default=None,
        help=&#34;The custom dataloader which used to update the model. Should be set with a valid import path, such as my_package.weight_load_func&#34;,
    )
    parser.add_argument(
        &#34;--weight-loader-disable-mmap&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Disable mmap while loading weight using safetensors.&#34;,
    )

    # For PD-Multiplexing
    parser.add_argument(
        &#34;--enable-pdmux&#34;,
        action=&#34;store_true&#34;,
        help=&#34;Enable PD-Multiplexing, PD running on greenctx stream.&#34;,
    )

    parser.add_argument(
        &#34;--sm-group-num&#34;,
        type=int,
        default=ServerArgs.sm_group_num,
        help=&#34;Number of sm partition groups.&#34;,
    )

    # Deprecated arguments
    parser.add_argument(
        &#34;--enable-ep-moe&#34;,
        action=&#34;store_true&#34;,
        help=&#34;(Deprecated) Enabling expert parallelism for moe. The ep size is equal to the tp size.&#34;,
    )
    parser.add_argument(
        &#34;--enable-deepep-moe&#34;,
        action=&#34;store_true&#34;,
        help=&#34;(Deprecated) Enabling DeepEP MoE implementation for EP MoE.&#34;,
    )
    parser.add_argument(
        &#34;--enable-flashinfer-cutlass-moe&#34;,
        action=&#34;store_true&#34;,
        help=&#34;(Deprecated) Enable FlashInfer CUTLASS MoE backend for modelopt_fp4 quant on Blackwell. Supports MoE-EP&#34;,
    )
    parser.add_argument(
        &#34;--enable-flashinfer-trtllm-moe&#34;,
        action=&#34;store_true&#34;,
        help=&#34;(Deprecated) Enable FlashInfer TRTLLM MoE backend on Blackwell. Supports BlockScale FP8 MoE-EP&#34;,
    )
    parser.add_argument(
        &#34;--enable-triton-kernel-moe&#34;,
        action=&#34;store_true&#34;,
        help=&#34;(Deprecated) Use triton moe grouped gemm kernel.&#34;,
    )
    parser.add_argument(
        &#34;--enable-flashinfer-mxfp4-moe&#34;,
        action=&#34;store_true&#34;,
        help=&#34;(Deprecated) Enable FlashInfer MXFP4 MoE backend for modelopt_fp4 quant on Blackwell.&#34;,
    )</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.from_cli_args"><code class="name flex">
<span>def <span class="ident">from_cli_args</span></span>(<span>args: argparse.Namespace)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Instance variables</h3>
<dl>
<dt id="sglang.srt.server_args.ServerArgs.allow_auto_truncate"><code class="name">var <span class="ident">allow_auto_truncate</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.api_key"><code class="name">var <span class="ident">api_key</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.attention_backend"><code class="name">var <span class="ident">attention_backend</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.base_gpu_id"><code class="name">var <span class="ident">base_gpu_id</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.bucket_e2e_request_latency"><code class="name">var <span class="ident">bucket_e2e_request_latency</span> : List[float] | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.bucket_inter_token_latency"><code class="name">var <span class="ident">bucket_inter_token_latency</span> : List[float] | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.bucket_time_to_first_token"><code class="name">var <span class="ident">bucket_time_to_first_token</span> : List[float] | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.chat_template"><code class="name">var <span class="ident">chat_template</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.chunked_prefill_size"><code class="name">var <span class="ident">chunked_prefill_size</span> : int | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.collect_tokens_histogram"><code class="name">var <span class="ident">collect_tokens_histogram</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.completion_template"><code class="name">var <span class="ident">completion_template</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.constrained_json_whitespace_pattern"><code class="name">var <span class="ident">constrained_json_whitespace_pattern</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.context_length"><code class="name">var <span class="ident">context_length</span> : int | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.cpu_offload_gb"><code class="name">var <span class="ident">cpu_offload_gb</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.crash_dump_folder"><code class="name">var <span class="ident">crash_dump_folder</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.cuda_graph_bs"><code class="name">var <span class="ident">cuda_graph_bs</span> : List[int] | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.cuda_graph_max_bs"><code class="name">var <span class="ident">cuda_graph_max_bs</span> : int | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.custom_weight_loader"><code class="name">var <span class="ident">custom_weight_loader</span> : List[str] | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.debug_tensor_dump_inject"><code class="name">var <span class="ident">debug_tensor_dump_inject</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.debug_tensor_dump_input_file"><code class="name">var <span class="ident">debug_tensor_dump_input_file</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.debug_tensor_dump_output_folder"><code class="name">var <span class="ident">debug_tensor_dump_output_folder</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.debug_tensor_dump_prefill_only"><code class="name">var <span class="ident">debug_tensor_dump_prefill_only</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.decode_attention_backend"><code class="name">var <span class="ident">decode_attention_backend</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.decode_log_interval"><code class="name">var <span class="ident">decode_log_interval</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.deepep_config"><code class="name">var <span class="ident">deepep_config</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.deepep_mode"><code class="name">var <span class="ident">deepep_mode</span> : Literal['auto', 'normal', 'low_latency']</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.delete_ckpt_after_loading"><code class="name">var <span class="ident">delete_ckpt_after_loading</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.device"><code class="name">var <span class="ident">device</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.disable_chunked_prefix_cache"><code class="name">var <span class="ident">disable_chunked_prefix_cache</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.disable_cuda_graph"><code class="name">var <span class="ident">disable_cuda_graph</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.disable_cuda_graph_padding"><code class="name">var <span class="ident">disable_cuda_graph_padding</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.disable_custom_all_reduce"><code class="name">var <span class="ident">disable_custom_all_reduce</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.disable_fast_image_processor"><code class="name">var <span class="ident">disable_fast_image_processor</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.disable_flashinfer_cutlass_moe_fp4_allgather"><code class="name">var <span class="ident">disable_flashinfer_cutlass_moe_fp4_allgather</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.disable_hybrid_swa_memory"><code class="name">var <span class="ident">disable_hybrid_swa_memory</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.disable_outlines_disk_cache"><code class="name">var <span class="ident">disable_outlines_disk_cache</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.disable_overlap_schedule"><code class="name">var <span class="ident">disable_overlap_schedule</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.disable_radix_cache"><code class="name">var <span class="ident">disable_radix_cache</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.disable_shared_experts_fusion"><code class="name">var <span class="ident">disable_shared_experts_fusion</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.disaggregation_bootstrap_port"><code class="name">var <span class="ident">disaggregation_bootstrap_port</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.disaggregation_decode_dp"><code class="name">var <span class="ident">disaggregation_decode_dp</span> : int | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.disaggregation_decode_tp"><code class="name">var <span class="ident">disaggregation_decode_tp</span> : int | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.disaggregation_ib_device"><code class="name">var <span class="ident">disaggregation_ib_device</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.disaggregation_mode"><code class="name">var <span class="ident">disaggregation_mode</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.disaggregation_prefill_pp"><code class="name">var <span class="ident">disaggregation_prefill_pp</span> : int | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.disaggregation_transfer_backend"><code class="name">var <span class="ident">disaggregation_transfer_backend</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.dist_init_addr"><code class="name">var <span class="ident">dist_init_addr</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.dist_timeout"><code class="name">var <span class="ident">dist_timeout</span> : int | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.download_dir"><code class="name">var <span class="ident">download_dir</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.dp_size"><code class="name">var <span class="ident">dp_size</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.ds_channel_config_path"><code class="name">var <span class="ident">ds_channel_config_path</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.ds_heavy_channel_num"><code class="name">var <span class="ident">ds_heavy_channel_num</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.ds_heavy_channel_type"><code class="name">var <span class="ident">ds_heavy_channel_type</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.ds_heavy_token_num"><code class="name">var <span class="ident">ds_heavy_token_num</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.ds_sparse_decode_threshold"><code class="name">var <span class="ident">ds_sparse_decode_threshold</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.dtype"><code class="name">var <span class="ident">dtype</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.enable_cache_report"><code class="name">var <span class="ident">enable_cache_report</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.enable_cudagraph_gc"><code class="name">var <span class="ident">enable_cudagraph_gc</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.enable_custom_logit_processor"><code class="name">var <span class="ident">enable_custom_logit_processor</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.enable_deepep_moe"><code class="name">var <span class="ident">enable_deepep_moe</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.enable_double_sparsity"><code class="name">var <span class="ident">enable_double_sparsity</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.enable_dp_attention"><code class="name">var <span class="ident">enable_dp_attention</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.enable_dp_lm_head"><code class="name">var <span class="ident">enable_dp_lm_head</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.enable_ep_moe"><code class="name">var <span class="ident">enable_ep_moe</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.enable_eplb"><code class="name">var <span class="ident">enable_eplb</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.enable_expert_distribution_metrics"><code class="name">var <span class="ident">enable_expert_distribution_metrics</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.enable_flashinfer_allreduce_fusion"><code class="name">var <span class="ident">enable_flashinfer_allreduce_fusion</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.enable_flashinfer_cutlass_moe"><code class="name">var <span class="ident">enable_flashinfer_cutlass_moe</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.enable_flashinfer_mxfp4_moe"><code class="name">var <span class="ident">enable_flashinfer_mxfp4_moe</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.enable_flashinfer_trtllm_moe"><code class="name">var <span class="ident">enable_flashinfer_trtllm_moe</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.enable_hierarchical_cache"><code class="name">var <span class="ident">enable_hierarchical_cache</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.enable_lora"><code class="name">var <span class="ident">enable_lora</span> : bool | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.enable_memory_saver"><code class="name">var <span class="ident">enable_memory_saver</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.enable_metrics"><code class="name">var <span class="ident">enable_metrics</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.enable_metrics_for_all_schedulers"><code class="name">var <span class="ident">enable_metrics_for_all_schedulers</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.enable_mixed_chunk"><code class="name">var <span class="ident">enable_mixed_chunk</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.enable_mscclpp"><code class="name">var <span class="ident">enable_mscclpp</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.enable_multimodal"><code class="name">var <span class="ident">enable_multimodal</span> : bool | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.enable_nan_detection"><code class="name">var <span class="ident">enable_nan_detection</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.enable_nccl_nvls"><code class="name">var <span class="ident">enable_nccl_nvls</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.enable_p2p_check"><code class="name">var <span class="ident">enable_p2p_check</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.enable_pdmux"><code class="name">var <span class="ident">enable_pdmux</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.enable_profile_cuda_graph"><code class="name">var <span class="ident">enable_profile_cuda_graph</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.enable_request_time_stats_logging"><code class="name">var <span class="ident">enable_request_time_stats_logging</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.enable_return_hidden_states"><code class="name">var <span class="ident">enable_return_hidden_states</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.enable_symm_mem"><code class="name">var <span class="ident">enable_symm_mem</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.enable_tokenizer_batch_encode"><code class="name">var <span class="ident">enable_tokenizer_batch_encode</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.enable_torch_compile"><code class="name">var <span class="ident">enable_torch_compile</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.enable_triton_kernel_moe"><code class="name">var <span class="ident">enable_triton_kernel_moe</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.enable_two_batch_overlap"><code class="name">var <span class="ident">enable_two_batch_overlap</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.ep_dispatch_algorithm"><code class="name">var <span class="ident">ep_dispatch_algorithm</span> : Literal['static', 'dynamic', 'fake'] | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.ep_num_redundant_experts"><code class="name">var <span class="ident">ep_num_redundant_experts</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.ep_size"><code class="name">var <span class="ident">ep_size</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.eplb_algorithm"><code class="name">var <span class="ident">eplb_algorithm</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.eplb_min_rebalancing_utilization_threshold"><code class="name">var <span class="ident">eplb_min_rebalancing_utilization_threshold</span> : float</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.eplb_rebalance_layers_per_chunk"><code class="name">var <span class="ident">eplb_rebalance_layers_per_chunk</span> : int | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.eplb_rebalance_num_iterations"><code class="name">var <span class="ident">eplb_rebalance_num_iterations</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.expert_distribution_recorder_buffer_size"><code class="name">var <span class="ident">expert_distribution_recorder_buffer_size</span> : int | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.expert_distribution_recorder_mode"><code class="name">var <span class="ident">expert_distribution_recorder_mode</span> : Literal['stat', 'stat_approx', 'per_pass', 'per_token'] | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.file_storage_path"><code class="name">var <span class="ident">file_storage_path</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.flashinfer_mla_disable_ragged"><code class="name">var <span class="ident">flashinfer_mla_disable_ragged</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.flashinfer_mxfp4_moe_precision"><code class="name">var <span class="ident">flashinfer_mxfp4_moe_precision</span> : Literal['default', 'bf16']</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.gc_warning_threshold_secs"><code class="name">var <span class="ident">gc_warning_threshold_secs</span> : float</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.gpu_id_step"><code class="name">var <span class="ident">gpu_id_step</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.grammar_backend"><code class="name">var <span class="ident">grammar_backend</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.hicache_io_backend"><code class="name">var <span class="ident">hicache_io_backend</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.hicache_mem_layout"><code class="name">var <span class="ident">hicache_mem_layout</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.hicache_ratio"><code class="name">var <span class="ident">hicache_ratio</span> : float</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.hicache_size"><code class="name">var <span class="ident">hicache_size</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.hicache_storage_backend"><code class="name">var <span class="ident">hicache_storage_backend</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.hicache_storage_backend_extra_config"><code class="name">var <span class="ident">hicache_storage_backend_extra_config</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.hicache_storage_prefetch_policy"><code class="name">var <span class="ident">hicache_storage_prefetch_policy</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.hicache_write_policy"><code class="name">var <span class="ident">hicache_write_policy</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.host"><code class="name">var <span class="ident">host</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.hybrid_kvcache_ratio"><code class="name">var <span class="ident">hybrid_kvcache_ratio</span> : float | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.init_expert_location"><code class="name">var <span class="ident">init_expert_location</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.is_embedding"><code class="name">var <span class="ident">is_embedding</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.json_model_override_args"><code class="name">var <span class="ident">json_model_override_args</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.kv_cache_dtype"><code class="name">var <span class="ident">kv_cache_dtype</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.kv_events_config"><code class="name">var <span class="ident">kv_events_config</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.load_balance_method"><code class="name">var <span class="ident">load_balance_method</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.load_format"><code class="name">var <span class="ident">load_format</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.log_level"><code class="name">var <span class="ident">log_level</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.log_level_http"><code class="name">var <span class="ident">log_level_http</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.log_requests"><code class="name">var <span class="ident">log_requests</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.log_requests_level"><code class="name">var <span class="ident">log_requests_level</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.lora_backend"><code class="name">var <span class="ident">lora_backend</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.lora_paths"><code class="name">var <span class="ident">lora_paths</span> : dict[str, str] | List[dict[str, str]] | List[str] | List[<a title="sglang.srt.lora.lora_registry.LoRARef" href="lora/lora_registry.html#sglang.srt.lora.lora_registry.LoRARef">LoRARef</a>] | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.lora_target_modules"><code class="name">var <span class="ident">lora_target_modules</span> : set[str] | List[str] | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.max_loaded_loras"><code class="name">var <span class="ident">max_loaded_loras</span> : int | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.max_lora_rank"><code class="name">var <span class="ident">max_lora_rank</span> : int | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.max_loras_per_batch"><code class="name">var <span class="ident">max_loras_per_batch</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.max_micro_batch_size"><code class="name">var <span class="ident">max_micro_batch_size</span> : int | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.max_prefill_tokens"><code class="name">var <span class="ident">max_prefill_tokens</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.max_queued_requests"><code class="name">var <span class="ident">max_queued_requests</span> : int | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.max_running_requests"><code class="name">var <span class="ident">max_running_requests</span> : int | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.max_total_tokens"><code class="name">var <span class="ident">max_total_tokens</span> : int | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.mem_fraction_static"><code class="name">var <span class="ident">mem_fraction_static</span> : float | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.mm_attention_backend"><code class="name">var <span class="ident">mm_attention_backend</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.model_impl"><code class="name">var <span class="ident">model_impl</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.model_loader_extra_config"><code class="name">var <span class="ident">model_loader_extra_config</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.model_path"><code class="name">var <span class="ident">model_path</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.moe_a2a_backend"><code class="name">var <span class="ident">moe_a2a_backend</span> : Literal['none', 'deepep']</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.moe_dense_tp_size"><code class="name">var <span class="ident">moe_dense_tp_size</span> : int | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.moe_runner_backend"><code class="name">var <span class="ident">moe_runner_backend</span> : Literal['auto', 'triton', 'triton_kernel', 'flashinfer_trtllm', 'flashinfer_cutlass', 'flashinfer_mxfp4']</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.nccl_port"><code class="name">var <span class="ident">nccl_port</span> : int | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.nnodes"><code class="name">var <span class="ident">nnodes</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.node_rank"><code class="name">var <span class="ident">node_rank</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.num_continuous_decode_steps"><code class="name">var <span class="ident">num_continuous_decode_steps</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.num_reserved_decode_tokens"><code class="name">var <span class="ident">num_reserved_decode_tokens</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.offload_group_size"><code class="name">var <span class="ident">offload_group_size</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.offload_mode"><code class="name">var <span class="ident">offload_mode</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.offload_num_in_group"><code class="name">var <span class="ident">offload_num_in_group</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.offload_prefetch_step"><code class="name">var <span class="ident">offload_prefetch_step</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.page_size"><code class="name">var <span class="ident">page_size</span> : int | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.pdlb_url"><code class="name">var <span class="ident">pdlb_url</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.port"><code class="name">var <span class="ident">port</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.pp_size"><code class="name">var <span class="ident">pp_size</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.preferred_sampling_params"><code class="name">var <span class="ident">preferred_sampling_params</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.prefill_attention_backend"><code class="name">var <span class="ident">prefill_attention_backend</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.quantization"><code class="name">var <span class="ident">quantization</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.quantization_param_path"><code class="name">var <span class="ident">quantization_param_path</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.random_seed"><code class="name">var <span class="ident">random_seed</span> : int | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.reasoning_parser"><code class="name">var <span class="ident">reasoning_parser</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.revision"><code class="name">var <span class="ident">revision</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.sampling_backend"><code class="name">var <span class="ident">sampling_backend</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.schedule_conservativeness"><code class="name">var <span class="ident">schedule_conservativeness</span> : float</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.schedule_policy"><code class="name">var <span class="ident">schedule_policy</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.scheduler_recv_interval"><code class="name">var <span class="ident">scheduler_recv_interval</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.served_model_name"><code class="name">var <span class="ident">served_model_name</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.show_time_cost"><code class="name">var <span class="ident">show_time_cost</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.skip_server_warmup"><code class="name">var <span class="ident">skip_server_warmup</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.skip_tokenizer_init"><code class="name">var <span class="ident">skip_tokenizer_init</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.sleep_on_idle"><code class="name">var <span class="ident">sleep_on_idle</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.sm_group_num"><code class="name">var <span class="ident">sm_group_num</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.speculative_accept_threshold_acc"><code class="name">var <span class="ident">speculative_accept_threshold_acc</span> : float</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.speculative_accept_threshold_single"><code class="name">var <span class="ident">speculative_accept_threshold_single</span> : float</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.speculative_algorithm"><code class="name">var <span class="ident">speculative_algorithm</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.speculative_draft_model_path"><code class="name">var <span class="ident">speculative_draft_model_path</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.speculative_eagle_topk"><code class="name">var <span class="ident">speculative_eagle_topk</span> : int | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.speculative_num_draft_tokens"><code class="name">var <span class="ident">speculative_num_draft_tokens</span> : int | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.speculative_num_steps"><code class="name">var <span class="ident">speculative_num_steps</span> : int | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.speculative_token_map"><code class="name">var <span class="ident">speculative_token_map</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.stream_interval"><code class="name">var <span class="ident">stream_interval</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.stream_output"><code class="name">var <span class="ident">stream_output</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.swa_full_tokens_ratio"><code class="name">var <span class="ident">swa_full_tokens_ratio</span> : float</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.tbo_token_distribution_threshold"><code class="name">var <span class="ident">tbo_token_distribution_threshold</span> : float</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.tokenizer_mode"><code class="name">var <span class="ident">tokenizer_mode</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.tokenizer_path"><code class="name">var <span class="ident">tokenizer_path</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.tool_call_parser"><code class="name">var <span class="ident">tool_call_parser</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.tool_server"><code class="name">var <span class="ident">tool_server</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.torch_compile_max_bs"><code class="name">var <span class="ident">torch_compile_max_bs</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.torchao_config"><code class="name">var <span class="ident">torchao_config</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.tp_size"><code class="name">var <span class="ident">tp_size</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.triton_attention_num_kv_splits"><code class="name">var <span class="ident">triton_attention_num_kv_splits</span> : int</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.triton_attention_reduce_in_fp32"><code class="name">var <span class="ident">triton_attention_reduce_in_fp32</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.trust_remote_code"><code class="name">var <span class="ident">trust_remote_code</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.warmups"><code class="name">var <span class="ident">warmups</span> : str | None</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.watchdog_timeout"><code class="name">var <span class="ident">watchdog_timeout</span> : float</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.weight_loader_disable_mmap"><code class="name">var <span class="ident">weight_loader_disable_mmap</span> : bool</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.weight_version"><code class="name">var <span class="ident">weight_version</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="sglang.srt.server_args.ServerArgs.adjust_mem_fraction_for_vlm"><code class="name flex">
<span>def <span class="ident">adjust_mem_fraction_for_vlm</span></span>(<span>self, model_config)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def adjust_mem_fraction_for_vlm(self, model_config):
    vision_config = getattr(model_config.hf_config, &#34;vision_config&#34;, None)
    if vision_config is None:
        return

    # roughly reduce the mem_fraction_static base on params of Vit
    original_server_arg_mem_fraction = self.mem_fraction_static
    # a base mem_fraction_static factor for regular Vit
    base_mem_fraction_reduction_ratio = 0.95

    vit_num_layers = getattr(vision_config, &#34;num_hidden_layers&#34;, 24)
    vit_hidden_size = getattr(vision_config, &#34;hidden_size&#34;, 1024)

    # baseline ViT params (ViT-L/14)
    baseline_vit_layers = 24
    baseline_vit_hidden_size = 1024

    # weight params count
    current_complexity_score = vit_num_layers * (vit_hidden_size**2)
    baseline_complexity_score = baseline_vit_layers * (baseline_vit_hidden_size**2)
    complexity_ratio = (
        current_complexity_score / baseline_complexity_score
        if baseline_complexity_score &gt; 0
        else 1.0
    )

    # every time the complexity grows 100%, adjust final factor for 10%
    sensitivity_scale = 0.1
    dynamic_adjustment_factor = 1.0 - sensitivity_scale * (complexity_ratio - 1.0)
    dynamic_adjustment_factor = max(0.8, min(1.05, dynamic_adjustment_factor))

    final_overall_factor = (
        base_mem_fraction_reduction_ratio * dynamic_adjustment_factor
    )
    self.mem_fraction_static = (
        original_server_arg_mem_fraction * final_overall_factor
    )</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.check_lora_server_args"><code class="name flex">
<span>def <span class="ident">check_lora_server_args</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def check_lora_server_args(self):
    assert self.max_loras_per_batch &gt; 0, &#34;max_loras_per_batch must be positive&#34;

    # Enable LoRA if any LoRA paths are provided for backward compatibility.
    if self.lora_paths:
        if self.enable_lora is None:
            self.enable_lora = True
            logger.warning(
                &#34;--enable-lora is set to True because --lora-paths is provided.&#34;
            )
        elif self.enable_lora is False:
            logger.warning(
                &#34;--enable-lora is set to False, any provided lora_paths will be ignored.&#34;
            )

    if self.enable_lora:
        if isinstance(self.lora_paths, list):
            lora_paths = self.lora_paths
            self.lora_paths = []
            for lora_path in lora_paths:
                if isinstance(lora_path, str):
                    if &#34;=&#34; in lora_path:
                        name, path = lora_path.split(&#34;=&#34;, 1)
                        lora_ref = LoRARef(
                            lora_name=name, lora_path=path, pinned=False
                        )
                    else:
                        lora_ref = LoRARef(
                            lora_name=lora_path, lora_path=lora_path, pinned=False
                        )
                elif isinstance(lora_path, dict):
                    assert (
                        &#34;lora_name&#34; in lora_path and &#34;lora_path&#34; in lora_path
                    ), f&#34;When providing LoRA paths as a list of dict, each dict should contain &#39;lora_name&#39; and &#39;lora_path&#39; keys. Got: {lora_path}&#34;
                    lora_ref = LoRARef(
                        lora_name=lora_path[&#34;lora_name&#34;],
                        lora_path=lora_path[&#34;lora_path&#34;],
                        pinned=lora_path.get(&#34;pinned&#34;, False),
                    )
                else:
                    raise ValueError(
                        f&#34;Invalid type for item in --lora-paths list: {type(lora_path)}. &#34;
                        &#34;Expected a string or a dictionary.&#34;
                    )
                self.lora_paths.append(lora_ref)
        elif isinstance(self.lora_paths, dict):
            self.lora_paths = [
                LoRARef(lora_name=k, lora_path=v, pinned=False)
                for k, v in self.lora_paths.items()
            ]
        elif self.lora_paths is None:
            self.lora_paths = []
        else:
            raise ValueError(
                f&#34;Invalid type for --lora-paths: {type(self.lora_paths)}. &#34;
                &#34;Expected a list or a dictionary.&#34;
            )

        # Expand target modules
        if self.lora_target_modules:
            self.lora_target_modules = set(self.lora_target_modules)
            if &#34;all&#34; in self.lora_target_modules:
                assert (
                    len(self.lora_target_modules) == 1
                ), &#34;If &#39;all&#39; is specified in --lora-target-modules, it should be the only module specified.&#34;
                self.lora_target_modules = set(SUPPORTED_LORA_TARGET_MODULES)

        # Ensure sufficient information is provided for LoRA initialization.
        assert self.lora_paths or (
            self.max_lora_rank and self.lora_target_modules
        ), &#34;When no initial --lora-paths is provided, you need to specify both --max-lora-rank and --lora-target-modules for LoRA initialization.&#34;

        # Validate max_loaded_loras
        if self.max_loaded_loras is not None:
            assert self.max_loaded_loras &gt;= self.max_loras_per_batch, (
                &#34;max_loaded_loras should be greater than or equal to max_loras_per_batch. &#34;
                f&#34;max_loaded_loras={self.max_loaded_loras}, max_loras_per_batch={self.max_loras_per_batch}&#34;
            )
            assert len(self.lora_paths) &lt;= self.max_loaded_loras, (
                &#34;The number of LoRA paths should not exceed max_loaded_loras. &#34;
                f&#34;max_loaded_loras={self.max_loaded_loras}, lora_paths={len(self.lora_paths)}&#34;
            )</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.check_server_args"><code class="name flex">
<span>def <span class="ident">check_server_args</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def check_server_args(self):
    # Check parallel size constraints
    assert (
        self.tp_size * self.pp_size
    ) % self.nnodes == 0, &#34;tp_size must be divisible by number of nodes&#34;

    if self.pp_size &gt; 1:
        assert (
            self.disable_overlap_schedule
            and self.speculative_algorithm is None
            and not self.enable_mixed_chunk
        ), &#34;Pipeline parallelism is not compatible with overlap schedule, speculative decoding, mixed chunked prefill.&#34;

    assert not (
        self.dp_size &gt; 1 and self.nnodes != 1 and not self.enable_dp_attention
    ), &#34;multi-node data parallel is not supported unless dp attention!&#34;

    assert self.base_gpu_id &gt;= 0, &#34;base_gpu_id must be non-negative&#34;
    assert self.gpu_id_step &gt;= 1, &#34;gpu_id_step must be positive&#34;

    assert self.moe_dense_tp_size in {
        1,
        None,
    }, &#34;moe_dense_tp_size only support 1 and None currently&#34;

    # Check LoRA
    self.check_lora_server_args()

    # Check speculative decoding
    if self.speculative_algorithm is not None:
        assert (
            not self.enable_mixed_chunk
        ), &#34;enable_mixed_chunk is required for speculative decoding&#34;

    # Check chunked prefill
    # Skip validation if chunked prefill is disabled (i.e., size &lt;= 0).
    if self.chunked_prefill_size &gt; 0:
        assert (
            self.chunked_prefill_size % self.page_size == 0
        ), &#34;chunked_prefill_size must be divisible by page_size&#34;</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.get_hf_config"><code class="name flex">
<span>def <span class="ident">get_hf_config</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_hf_config(self):
    kwargs = {}
    hf_config = get_config(
        self.model_path,
        trust_remote_code=self.trust_remote_code,
        revision=self.revision,
        model_override_args=json.loads(self.json_model_override_args),
        **kwargs,
    )
    return hf_config</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.model_specific_adjustments"><code class="name flex">
<span>def <span class="ident">model_specific_adjustments</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def model_specific_adjustments(self):
    hf_config = self.get_hf_config()
    model_arch = hf_config.architectures[0]
    if model_arch in [&#34;GptOssForCausalLM&#34;]:
        if self.attention_backend is None:
            if is_cuda() and is_sm100_supported():
                self.attention_backend = &#34;trtllm_mha&#34;
            elif is_cuda() and is_sm90_supported():
                self.attention_backend = &#34;fa3&#34;
            else:
                self.attention_backend = &#34;triton&#34;
        supported_backends = [&#34;triton&#34;, &#34;trtllm_mha&#34;, &#34;fa3&#34;]
        logger.info(
            f&#34;Use {self.attention_backend} as attention backend for GptOssForCausalLM&#34;
        )
        assert (
            self.attention_backend in supported_backends
        ), f&#34;GptOssForCausalLM requires one of {supported_backends} attention backend, but got &#39;{self.attention_backend}&#39;&#34;

        if is_sm100_supported():
            if not self.enable_dp_attention:
                self.enable_flashinfer_allreduce_fusion = True
                logger.info(
                    &#34;Enable FlashInfer AllReduce Fusion on sm100 for GptOssForCausalLM&#34;
                )
        quantization_config = getattr(hf_config, &#34;quantization_config&#34;, None)
        is_mxfp4_quant_format = (
            quantization_config is not None
            and quantization_config.get(&#34;quant_method&#34;) == &#34;mxfp4&#34;
        )

        if is_sm100_supported() and is_mxfp4_quant_format:
            self.moe_runner_backend = &#34;flashinfer_mxfp4&#34;
            logger.warning(
                &#34;Detected SM100 and MXFP4 quantization format for GPT-OSS model, enabling FlashInfer MXFP4 MOE kernel.&#34;
            )
        else:
            if self.moe_runner_backend == &#34;triton_kernel&#34;:
                assert (
                    self.ep_size == 1
                ), &#34;Triton kernel MoE is only supported when ep_size == 1&#34;
            if (
                self.moe_runner_backend == &#34;auto&#34;
                and self.ep_size == 1
                and is_triton_kernels_available()
            ):
                self.moe_runner_backend = &#34;triton_kernel&#34;
                logger.warning(
                    &#34;Detected GPT-OSS model, enabling triton_kernels MOE kernel.&#34;
                )
        self.disable_hybrid_swa_memory = True
        if is_mxfp4_quant_format:
            # use bf16 for mxfp4 triton kernels
            self.dtype = &#34;bfloat16&#34;

    elif &#34;Llama4&#34; in model_arch:
        assert self.attention_backend in {
            &#34;fa3&#34;,
            &#34;aiter&#34;,
        }, &#34;fa3 or aiter is required for Llama4 model&#34;
    elif model_arch in [
        &#34;Gemma2ForCausalLM&#34;,
        &#34;Gemma3ForCausalLM&#34;,
        &#34;Gemma3ForConditionalGeneration&#34;,
        &#34;Gemma3nForCausalLM&#34;,
        &#34;Gemma3nForConditionalGeneration&#34;,
    ]:
        # FIXME: https://github.com/sgl-project/sglang/pull/7367 is not compatible with gemma2 model.
        # It failed at this test: https://github.com/sgl-project/sglang/actions/runs/16255155597/job/45890331952#step:4:736
        logger.warning(
            f&#34;Disable hybrid SWA memory for {model_arch} as it is not yet supported.&#34;
        )
        self.disable_hybrid_swa_memory = True</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.url"><code class="name flex">
<span>def <span class="ident">url</span></span>(<span>self)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def url(self):
    if is_valid_ipv6_address(self.host):
        return f&#34;http://[{self.host}]:{self.port}&#34;
    else:
        return f&#34;http://{self.host}:{self.port}&#34;</code></pre>
</details>
<div class="desc"></div>
</dd>
<dt id="sglang.srt.server_args.ServerArgs.validate_disagg_tp_size"><code class="name flex">
<span>def <span class="ident">validate_disagg_tp_size</span></span>(<span>self, prefill_tp: int, decode_tp: int)</span>
</code></dt>
<dd>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def validate_disagg_tp_size(self, prefill_tp: int, decode_tp: int):
    larger_tp = max(decode_tp, prefill_tp)
    smaller_tp = min(decode_tp, prefill_tp)
    assert larger_tp % smaller_tp == 0, (
        &#34;Different tp size is supported only when one tp is multiple of the other. &#34;
        f&#34;decode_tp={decode_tp}, prefill_tp={prefill_tp}&#34;
    )</code></pre>
</details>
<div class="desc"></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="sglang.srt" href="index.html">sglang.srt</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="sglang.srt.server_args.add_attention_backend_choices" href="#sglang.srt.server_args.add_attention_backend_choices">add_attention_backend_choices</a></code></li>
<li><code><a title="sglang.srt.server_args.add_disagg_transfer_backend_choices" href="#sglang.srt.server_args.add_disagg_transfer_backend_choices">add_disagg_transfer_backend_choices</a></code></li>
<li><code><a title="sglang.srt.server_args.add_load_format_choices" href="#sglang.srt.server_args.add_load_format_choices">add_load_format_choices</a></code></li>
<li><code><a title="sglang.srt.server_args.add_quantization_method_choices" href="#sglang.srt.server_args.add_quantization_method_choices">add_quantization_method_choices</a></code></li>
<li><code><a title="sglang.srt.server_args.auto_choose_speculative_params" href="#sglang.srt.server_args.auto_choose_speculative_params">auto_choose_speculative_params</a></code></li>
<li><code><a title="sglang.srt.server_args.prepare_server_args" href="#sglang.srt.server_args.prepare_server_args">prepare_server_args</a></code></li>
<li><code><a title="sglang.srt.server_args.print_deprecated_warning" href="#sglang.srt.server_args.print_deprecated_warning">print_deprecated_warning</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="sglang.srt.server_args.DeprecatedAction" href="#sglang.srt.server_args.DeprecatedAction">DeprecatedAction</a></code></h4>
</li>
<li>
<h4><code><a title="sglang.srt.server_args.LoRAPathAction" href="#sglang.srt.server_args.LoRAPathAction">LoRAPathAction</a></code></h4>
</li>
<li>
<h4><code><a title="sglang.srt.server_args.PortArgs" href="#sglang.srt.server_args.PortArgs">PortArgs</a></code></h4>
<ul class="">
<li><code><a title="sglang.srt.server_args.PortArgs.detokenizer_ipc_name" href="#sglang.srt.server_args.PortArgs.detokenizer_ipc_name">detokenizer_ipc_name</a></code></li>
<li><code><a title="sglang.srt.server_args.PortArgs.init_new" href="#sglang.srt.server_args.PortArgs.init_new">init_new</a></code></li>
<li><code><a title="sglang.srt.server_args.PortArgs.metrics_ipc_name" href="#sglang.srt.server_args.PortArgs.metrics_ipc_name">metrics_ipc_name</a></code></li>
<li><code><a title="sglang.srt.server_args.PortArgs.nccl_port" href="#sglang.srt.server_args.PortArgs.nccl_port">nccl_port</a></code></li>
<li><code><a title="sglang.srt.server_args.PortArgs.rpc_ipc_name" href="#sglang.srt.server_args.PortArgs.rpc_ipc_name">rpc_ipc_name</a></code></li>
<li><code><a title="sglang.srt.server_args.PortArgs.scheduler_input_ipc_name" href="#sglang.srt.server_args.PortArgs.scheduler_input_ipc_name">scheduler_input_ipc_name</a></code></li>
<li><code><a title="sglang.srt.server_args.PortArgs.tokenizer_ipc_name" href="#sglang.srt.server_args.PortArgs.tokenizer_ipc_name">tokenizer_ipc_name</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="sglang.srt.server_args.ServerArgs" href="#sglang.srt.server_args.ServerArgs">ServerArgs</a></code></h4>
<ul class="">
<li><code><a title="sglang.srt.server_args.ServerArgs.add_cli_args" href="#sglang.srt.server_args.ServerArgs.add_cli_args">add_cli_args</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.adjust_mem_fraction_for_vlm" href="#sglang.srt.server_args.ServerArgs.adjust_mem_fraction_for_vlm">adjust_mem_fraction_for_vlm</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.allow_auto_truncate" href="#sglang.srt.server_args.ServerArgs.allow_auto_truncate">allow_auto_truncate</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.api_key" href="#sglang.srt.server_args.ServerArgs.api_key">api_key</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.attention_backend" href="#sglang.srt.server_args.ServerArgs.attention_backend">attention_backend</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.base_gpu_id" href="#sglang.srt.server_args.ServerArgs.base_gpu_id">base_gpu_id</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.bucket_e2e_request_latency" href="#sglang.srt.server_args.ServerArgs.bucket_e2e_request_latency">bucket_e2e_request_latency</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.bucket_inter_token_latency" href="#sglang.srt.server_args.ServerArgs.bucket_inter_token_latency">bucket_inter_token_latency</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.bucket_time_to_first_token" href="#sglang.srt.server_args.ServerArgs.bucket_time_to_first_token">bucket_time_to_first_token</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.chat_template" href="#sglang.srt.server_args.ServerArgs.chat_template">chat_template</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.check_lora_server_args" href="#sglang.srt.server_args.ServerArgs.check_lora_server_args">check_lora_server_args</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.check_server_args" href="#sglang.srt.server_args.ServerArgs.check_server_args">check_server_args</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.chunked_prefill_size" href="#sglang.srt.server_args.ServerArgs.chunked_prefill_size">chunked_prefill_size</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.collect_tokens_histogram" href="#sglang.srt.server_args.ServerArgs.collect_tokens_histogram">collect_tokens_histogram</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.completion_template" href="#sglang.srt.server_args.ServerArgs.completion_template">completion_template</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.constrained_json_whitespace_pattern" href="#sglang.srt.server_args.ServerArgs.constrained_json_whitespace_pattern">constrained_json_whitespace_pattern</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.context_length" href="#sglang.srt.server_args.ServerArgs.context_length">context_length</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.cpu_offload_gb" href="#sglang.srt.server_args.ServerArgs.cpu_offload_gb">cpu_offload_gb</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.crash_dump_folder" href="#sglang.srt.server_args.ServerArgs.crash_dump_folder">crash_dump_folder</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.cuda_graph_bs" href="#sglang.srt.server_args.ServerArgs.cuda_graph_bs">cuda_graph_bs</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.cuda_graph_max_bs" href="#sglang.srt.server_args.ServerArgs.cuda_graph_max_bs">cuda_graph_max_bs</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.custom_weight_loader" href="#sglang.srt.server_args.ServerArgs.custom_weight_loader">custom_weight_loader</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.debug_tensor_dump_inject" href="#sglang.srt.server_args.ServerArgs.debug_tensor_dump_inject">debug_tensor_dump_inject</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.debug_tensor_dump_input_file" href="#sglang.srt.server_args.ServerArgs.debug_tensor_dump_input_file">debug_tensor_dump_input_file</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.debug_tensor_dump_output_folder" href="#sglang.srt.server_args.ServerArgs.debug_tensor_dump_output_folder">debug_tensor_dump_output_folder</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.debug_tensor_dump_prefill_only" href="#sglang.srt.server_args.ServerArgs.debug_tensor_dump_prefill_only">debug_tensor_dump_prefill_only</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.decode_attention_backend" href="#sglang.srt.server_args.ServerArgs.decode_attention_backend">decode_attention_backend</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.decode_log_interval" href="#sglang.srt.server_args.ServerArgs.decode_log_interval">decode_log_interval</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.deepep_config" href="#sglang.srt.server_args.ServerArgs.deepep_config">deepep_config</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.deepep_mode" href="#sglang.srt.server_args.ServerArgs.deepep_mode">deepep_mode</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.delete_ckpt_after_loading" href="#sglang.srt.server_args.ServerArgs.delete_ckpt_after_loading">delete_ckpt_after_loading</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.device" href="#sglang.srt.server_args.ServerArgs.device">device</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.disable_chunked_prefix_cache" href="#sglang.srt.server_args.ServerArgs.disable_chunked_prefix_cache">disable_chunked_prefix_cache</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.disable_cuda_graph" href="#sglang.srt.server_args.ServerArgs.disable_cuda_graph">disable_cuda_graph</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.disable_cuda_graph_padding" href="#sglang.srt.server_args.ServerArgs.disable_cuda_graph_padding">disable_cuda_graph_padding</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.disable_custom_all_reduce" href="#sglang.srt.server_args.ServerArgs.disable_custom_all_reduce">disable_custom_all_reduce</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.disable_fast_image_processor" href="#sglang.srt.server_args.ServerArgs.disable_fast_image_processor">disable_fast_image_processor</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.disable_flashinfer_cutlass_moe_fp4_allgather" href="#sglang.srt.server_args.ServerArgs.disable_flashinfer_cutlass_moe_fp4_allgather">disable_flashinfer_cutlass_moe_fp4_allgather</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.disable_hybrid_swa_memory" href="#sglang.srt.server_args.ServerArgs.disable_hybrid_swa_memory">disable_hybrid_swa_memory</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.disable_outlines_disk_cache" href="#sglang.srt.server_args.ServerArgs.disable_outlines_disk_cache">disable_outlines_disk_cache</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.disable_overlap_schedule" href="#sglang.srt.server_args.ServerArgs.disable_overlap_schedule">disable_overlap_schedule</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.disable_radix_cache" href="#sglang.srt.server_args.ServerArgs.disable_radix_cache">disable_radix_cache</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.disable_shared_experts_fusion" href="#sglang.srt.server_args.ServerArgs.disable_shared_experts_fusion">disable_shared_experts_fusion</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.disaggregation_bootstrap_port" href="#sglang.srt.server_args.ServerArgs.disaggregation_bootstrap_port">disaggregation_bootstrap_port</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.disaggregation_decode_dp" href="#sglang.srt.server_args.ServerArgs.disaggregation_decode_dp">disaggregation_decode_dp</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.disaggregation_decode_tp" href="#sglang.srt.server_args.ServerArgs.disaggregation_decode_tp">disaggregation_decode_tp</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.disaggregation_ib_device" href="#sglang.srt.server_args.ServerArgs.disaggregation_ib_device">disaggregation_ib_device</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.disaggregation_mode" href="#sglang.srt.server_args.ServerArgs.disaggregation_mode">disaggregation_mode</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.disaggregation_prefill_pp" href="#sglang.srt.server_args.ServerArgs.disaggregation_prefill_pp">disaggregation_prefill_pp</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.disaggregation_transfer_backend" href="#sglang.srt.server_args.ServerArgs.disaggregation_transfer_backend">disaggregation_transfer_backend</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.dist_init_addr" href="#sglang.srt.server_args.ServerArgs.dist_init_addr">dist_init_addr</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.dist_timeout" href="#sglang.srt.server_args.ServerArgs.dist_timeout">dist_timeout</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.download_dir" href="#sglang.srt.server_args.ServerArgs.download_dir">download_dir</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.dp_size" href="#sglang.srt.server_args.ServerArgs.dp_size">dp_size</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.ds_channel_config_path" href="#sglang.srt.server_args.ServerArgs.ds_channel_config_path">ds_channel_config_path</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.ds_heavy_channel_num" href="#sglang.srt.server_args.ServerArgs.ds_heavy_channel_num">ds_heavy_channel_num</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.ds_heavy_channel_type" href="#sglang.srt.server_args.ServerArgs.ds_heavy_channel_type">ds_heavy_channel_type</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.ds_heavy_token_num" href="#sglang.srt.server_args.ServerArgs.ds_heavy_token_num">ds_heavy_token_num</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.ds_sparse_decode_threshold" href="#sglang.srt.server_args.ServerArgs.ds_sparse_decode_threshold">ds_sparse_decode_threshold</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.dtype" href="#sglang.srt.server_args.ServerArgs.dtype">dtype</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.enable_cache_report" href="#sglang.srt.server_args.ServerArgs.enable_cache_report">enable_cache_report</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.enable_cudagraph_gc" href="#sglang.srt.server_args.ServerArgs.enable_cudagraph_gc">enable_cudagraph_gc</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.enable_custom_logit_processor" href="#sglang.srt.server_args.ServerArgs.enable_custom_logit_processor">enable_custom_logit_processor</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.enable_deepep_moe" href="#sglang.srt.server_args.ServerArgs.enable_deepep_moe">enable_deepep_moe</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.enable_double_sparsity" href="#sglang.srt.server_args.ServerArgs.enable_double_sparsity">enable_double_sparsity</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.enable_dp_attention" href="#sglang.srt.server_args.ServerArgs.enable_dp_attention">enable_dp_attention</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.enable_dp_lm_head" href="#sglang.srt.server_args.ServerArgs.enable_dp_lm_head">enable_dp_lm_head</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.enable_ep_moe" href="#sglang.srt.server_args.ServerArgs.enable_ep_moe">enable_ep_moe</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.enable_eplb" href="#sglang.srt.server_args.ServerArgs.enable_eplb">enable_eplb</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.enable_expert_distribution_metrics" href="#sglang.srt.server_args.ServerArgs.enable_expert_distribution_metrics">enable_expert_distribution_metrics</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.enable_flashinfer_allreduce_fusion" href="#sglang.srt.server_args.ServerArgs.enable_flashinfer_allreduce_fusion">enable_flashinfer_allreduce_fusion</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.enable_flashinfer_cutlass_moe" href="#sglang.srt.server_args.ServerArgs.enable_flashinfer_cutlass_moe">enable_flashinfer_cutlass_moe</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.enable_flashinfer_mxfp4_moe" href="#sglang.srt.server_args.ServerArgs.enable_flashinfer_mxfp4_moe">enable_flashinfer_mxfp4_moe</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.enable_flashinfer_trtllm_moe" href="#sglang.srt.server_args.ServerArgs.enable_flashinfer_trtllm_moe">enable_flashinfer_trtllm_moe</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.enable_hierarchical_cache" href="#sglang.srt.server_args.ServerArgs.enable_hierarchical_cache">enable_hierarchical_cache</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.enable_lora" href="#sglang.srt.server_args.ServerArgs.enable_lora">enable_lora</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.enable_memory_saver" href="#sglang.srt.server_args.ServerArgs.enable_memory_saver">enable_memory_saver</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.enable_metrics" href="#sglang.srt.server_args.ServerArgs.enable_metrics">enable_metrics</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.enable_metrics_for_all_schedulers" href="#sglang.srt.server_args.ServerArgs.enable_metrics_for_all_schedulers">enable_metrics_for_all_schedulers</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.enable_mixed_chunk" href="#sglang.srt.server_args.ServerArgs.enable_mixed_chunk">enable_mixed_chunk</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.enable_mscclpp" href="#sglang.srt.server_args.ServerArgs.enable_mscclpp">enable_mscclpp</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.enable_multimodal" href="#sglang.srt.server_args.ServerArgs.enable_multimodal">enable_multimodal</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.enable_nan_detection" href="#sglang.srt.server_args.ServerArgs.enable_nan_detection">enable_nan_detection</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.enable_nccl_nvls" href="#sglang.srt.server_args.ServerArgs.enable_nccl_nvls">enable_nccl_nvls</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.enable_p2p_check" href="#sglang.srt.server_args.ServerArgs.enable_p2p_check">enable_p2p_check</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.enable_pdmux" href="#sglang.srt.server_args.ServerArgs.enable_pdmux">enable_pdmux</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.enable_profile_cuda_graph" href="#sglang.srt.server_args.ServerArgs.enable_profile_cuda_graph">enable_profile_cuda_graph</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.enable_request_time_stats_logging" href="#sglang.srt.server_args.ServerArgs.enable_request_time_stats_logging">enable_request_time_stats_logging</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.enable_return_hidden_states" href="#sglang.srt.server_args.ServerArgs.enable_return_hidden_states">enable_return_hidden_states</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.enable_symm_mem" href="#sglang.srt.server_args.ServerArgs.enable_symm_mem">enable_symm_mem</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.enable_tokenizer_batch_encode" href="#sglang.srt.server_args.ServerArgs.enable_tokenizer_batch_encode">enable_tokenizer_batch_encode</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.enable_torch_compile" href="#sglang.srt.server_args.ServerArgs.enable_torch_compile">enable_torch_compile</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.enable_triton_kernel_moe" href="#sglang.srt.server_args.ServerArgs.enable_triton_kernel_moe">enable_triton_kernel_moe</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.enable_two_batch_overlap" href="#sglang.srt.server_args.ServerArgs.enable_two_batch_overlap">enable_two_batch_overlap</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.ep_dispatch_algorithm" href="#sglang.srt.server_args.ServerArgs.ep_dispatch_algorithm">ep_dispatch_algorithm</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.ep_num_redundant_experts" href="#sglang.srt.server_args.ServerArgs.ep_num_redundant_experts">ep_num_redundant_experts</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.ep_size" href="#sglang.srt.server_args.ServerArgs.ep_size">ep_size</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.eplb_algorithm" href="#sglang.srt.server_args.ServerArgs.eplb_algorithm">eplb_algorithm</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.eplb_min_rebalancing_utilization_threshold" href="#sglang.srt.server_args.ServerArgs.eplb_min_rebalancing_utilization_threshold">eplb_min_rebalancing_utilization_threshold</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.eplb_rebalance_layers_per_chunk" href="#sglang.srt.server_args.ServerArgs.eplb_rebalance_layers_per_chunk">eplb_rebalance_layers_per_chunk</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.eplb_rebalance_num_iterations" href="#sglang.srt.server_args.ServerArgs.eplb_rebalance_num_iterations">eplb_rebalance_num_iterations</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.expert_distribution_recorder_buffer_size" href="#sglang.srt.server_args.ServerArgs.expert_distribution_recorder_buffer_size">expert_distribution_recorder_buffer_size</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.expert_distribution_recorder_mode" href="#sglang.srt.server_args.ServerArgs.expert_distribution_recorder_mode">expert_distribution_recorder_mode</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.file_storage_path" href="#sglang.srt.server_args.ServerArgs.file_storage_path">file_storage_path</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.flashinfer_mla_disable_ragged" href="#sglang.srt.server_args.ServerArgs.flashinfer_mla_disable_ragged">flashinfer_mla_disable_ragged</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.flashinfer_mxfp4_moe_precision" href="#sglang.srt.server_args.ServerArgs.flashinfer_mxfp4_moe_precision">flashinfer_mxfp4_moe_precision</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.from_cli_args" href="#sglang.srt.server_args.ServerArgs.from_cli_args">from_cli_args</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.gc_warning_threshold_secs" href="#sglang.srt.server_args.ServerArgs.gc_warning_threshold_secs">gc_warning_threshold_secs</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.get_hf_config" href="#sglang.srt.server_args.ServerArgs.get_hf_config">get_hf_config</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.gpu_id_step" href="#sglang.srt.server_args.ServerArgs.gpu_id_step">gpu_id_step</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.grammar_backend" href="#sglang.srt.server_args.ServerArgs.grammar_backend">grammar_backend</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.hicache_io_backend" href="#sglang.srt.server_args.ServerArgs.hicache_io_backend">hicache_io_backend</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.hicache_mem_layout" href="#sglang.srt.server_args.ServerArgs.hicache_mem_layout">hicache_mem_layout</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.hicache_ratio" href="#sglang.srt.server_args.ServerArgs.hicache_ratio">hicache_ratio</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.hicache_size" href="#sglang.srt.server_args.ServerArgs.hicache_size">hicache_size</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.hicache_storage_backend" href="#sglang.srt.server_args.ServerArgs.hicache_storage_backend">hicache_storage_backend</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.hicache_storage_backend_extra_config" href="#sglang.srt.server_args.ServerArgs.hicache_storage_backend_extra_config">hicache_storage_backend_extra_config</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.hicache_storage_prefetch_policy" href="#sglang.srt.server_args.ServerArgs.hicache_storage_prefetch_policy">hicache_storage_prefetch_policy</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.hicache_write_policy" href="#sglang.srt.server_args.ServerArgs.hicache_write_policy">hicache_write_policy</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.host" href="#sglang.srt.server_args.ServerArgs.host">host</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.hybrid_kvcache_ratio" href="#sglang.srt.server_args.ServerArgs.hybrid_kvcache_ratio">hybrid_kvcache_ratio</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.init_expert_location" href="#sglang.srt.server_args.ServerArgs.init_expert_location">init_expert_location</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.is_embedding" href="#sglang.srt.server_args.ServerArgs.is_embedding">is_embedding</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.json_model_override_args" href="#sglang.srt.server_args.ServerArgs.json_model_override_args">json_model_override_args</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.kv_cache_dtype" href="#sglang.srt.server_args.ServerArgs.kv_cache_dtype">kv_cache_dtype</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.kv_events_config" href="#sglang.srt.server_args.ServerArgs.kv_events_config">kv_events_config</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.load_balance_method" href="#sglang.srt.server_args.ServerArgs.load_balance_method">load_balance_method</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.load_format" href="#sglang.srt.server_args.ServerArgs.load_format">load_format</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.log_level" href="#sglang.srt.server_args.ServerArgs.log_level">log_level</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.log_level_http" href="#sglang.srt.server_args.ServerArgs.log_level_http">log_level_http</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.log_requests" href="#sglang.srt.server_args.ServerArgs.log_requests">log_requests</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.log_requests_level" href="#sglang.srt.server_args.ServerArgs.log_requests_level">log_requests_level</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.lora_backend" href="#sglang.srt.server_args.ServerArgs.lora_backend">lora_backend</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.lora_paths" href="#sglang.srt.server_args.ServerArgs.lora_paths">lora_paths</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.lora_target_modules" href="#sglang.srt.server_args.ServerArgs.lora_target_modules">lora_target_modules</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.max_loaded_loras" href="#sglang.srt.server_args.ServerArgs.max_loaded_loras">max_loaded_loras</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.max_lora_rank" href="#sglang.srt.server_args.ServerArgs.max_lora_rank">max_lora_rank</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.max_loras_per_batch" href="#sglang.srt.server_args.ServerArgs.max_loras_per_batch">max_loras_per_batch</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.max_micro_batch_size" href="#sglang.srt.server_args.ServerArgs.max_micro_batch_size">max_micro_batch_size</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.max_prefill_tokens" href="#sglang.srt.server_args.ServerArgs.max_prefill_tokens">max_prefill_tokens</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.max_queued_requests" href="#sglang.srt.server_args.ServerArgs.max_queued_requests">max_queued_requests</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.max_running_requests" href="#sglang.srt.server_args.ServerArgs.max_running_requests">max_running_requests</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.max_total_tokens" href="#sglang.srt.server_args.ServerArgs.max_total_tokens">max_total_tokens</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.mem_fraction_static" href="#sglang.srt.server_args.ServerArgs.mem_fraction_static">mem_fraction_static</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.mm_attention_backend" href="#sglang.srt.server_args.ServerArgs.mm_attention_backend">mm_attention_backend</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.model_impl" href="#sglang.srt.server_args.ServerArgs.model_impl">model_impl</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.model_loader_extra_config" href="#sglang.srt.server_args.ServerArgs.model_loader_extra_config">model_loader_extra_config</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.model_path" href="#sglang.srt.server_args.ServerArgs.model_path">model_path</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.model_specific_adjustments" href="#sglang.srt.server_args.ServerArgs.model_specific_adjustments">model_specific_adjustments</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.moe_a2a_backend" href="#sglang.srt.server_args.ServerArgs.moe_a2a_backend">moe_a2a_backend</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.moe_dense_tp_size" href="#sglang.srt.server_args.ServerArgs.moe_dense_tp_size">moe_dense_tp_size</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.moe_runner_backend" href="#sglang.srt.server_args.ServerArgs.moe_runner_backend">moe_runner_backend</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.nccl_port" href="#sglang.srt.server_args.ServerArgs.nccl_port">nccl_port</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.nnodes" href="#sglang.srt.server_args.ServerArgs.nnodes">nnodes</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.node_rank" href="#sglang.srt.server_args.ServerArgs.node_rank">node_rank</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.num_continuous_decode_steps" href="#sglang.srt.server_args.ServerArgs.num_continuous_decode_steps">num_continuous_decode_steps</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.num_reserved_decode_tokens" href="#sglang.srt.server_args.ServerArgs.num_reserved_decode_tokens">num_reserved_decode_tokens</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.offload_group_size" href="#sglang.srt.server_args.ServerArgs.offload_group_size">offload_group_size</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.offload_mode" href="#sglang.srt.server_args.ServerArgs.offload_mode">offload_mode</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.offload_num_in_group" href="#sglang.srt.server_args.ServerArgs.offload_num_in_group">offload_num_in_group</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.offload_prefetch_step" href="#sglang.srt.server_args.ServerArgs.offload_prefetch_step">offload_prefetch_step</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.page_size" href="#sglang.srt.server_args.ServerArgs.page_size">page_size</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.pdlb_url" href="#sglang.srt.server_args.ServerArgs.pdlb_url">pdlb_url</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.port" href="#sglang.srt.server_args.ServerArgs.port">port</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.pp_size" href="#sglang.srt.server_args.ServerArgs.pp_size">pp_size</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.preferred_sampling_params" href="#sglang.srt.server_args.ServerArgs.preferred_sampling_params">preferred_sampling_params</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.prefill_attention_backend" href="#sglang.srt.server_args.ServerArgs.prefill_attention_backend">prefill_attention_backend</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.quantization" href="#sglang.srt.server_args.ServerArgs.quantization">quantization</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.quantization_param_path" href="#sglang.srt.server_args.ServerArgs.quantization_param_path">quantization_param_path</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.random_seed" href="#sglang.srt.server_args.ServerArgs.random_seed">random_seed</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.reasoning_parser" href="#sglang.srt.server_args.ServerArgs.reasoning_parser">reasoning_parser</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.revision" href="#sglang.srt.server_args.ServerArgs.revision">revision</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.sampling_backend" href="#sglang.srt.server_args.ServerArgs.sampling_backend">sampling_backend</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.schedule_conservativeness" href="#sglang.srt.server_args.ServerArgs.schedule_conservativeness">schedule_conservativeness</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.schedule_policy" href="#sglang.srt.server_args.ServerArgs.schedule_policy">schedule_policy</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.scheduler_recv_interval" href="#sglang.srt.server_args.ServerArgs.scheduler_recv_interval">scheduler_recv_interval</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.served_model_name" href="#sglang.srt.server_args.ServerArgs.served_model_name">served_model_name</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.show_time_cost" href="#sglang.srt.server_args.ServerArgs.show_time_cost">show_time_cost</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.skip_server_warmup" href="#sglang.srt.server_args.ServerArgs.skip_server_warmup">skip_server_warmup</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.skip_tokenizer_init" href="#sglang.srt.server_args.ServerArgs.skip_tokenizer_init">skip_tokenizer_init</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.sleep_on_idle" href="#sglang.srt.server_args.ServerArgs.sleep_on_idle">sleep_on_idle</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.sm_group_num" href="#sglang.srt.server_args.ServerArgs.sm_group_num">sm_group_num</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.speculative_accept_threshold_acc" href="#sglang.srt.server_args.ServerArgs.speculative_accept_threshold_acc">speculative_accept_threshold_acc</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.speculative_accept_threshold_single" href="#sglang.srt.server_args.ServerArgs.speculative_accept_threshold_single">speculative_accept_threshold_single</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.speculative_algorithm" href="#sglang.srt.server_args.ServerArgs.speculative_algorithm">speculative_algorithm</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.speculative_draft_model_path" href="#sglang.srt.server_args.ServerArgs.speculative_draft_model_path">speculative_draft_model_path</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.speculative_eagle_topk" href="#sglang.srt.server_args.ServerArgs.speculative_eagle_topk">speculative_eagle_topk</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.speculative_num_draft_tokens" href="#sglang.srt.server_args.ServerArgs.speculative_num_draft_tokens">speculative_num_draft_tokens</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.speculative_num_steps" href="#sglang.srt.server_args.ServerArgs.speculative_num_steps">speculative_num_steps</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.speculative_token_map" href="#sglang.srt.server_args.ServerArgs.speculative_token_map">speculative_token_map</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.stream_interval" href="#sglang.srt.server_args.ServerArgs.stream_interval">stream_interval</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.stream_output" href="#sglang.srt.server_args.ServerArgs.stream_output">stream_output</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.swa_full_tokens_ratio" href="#sglang.srt.server_args.ServerArgs.swa_full_tokens_ratio">swa_full_tokens_ratio</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.tbo_token_distribution_threshold" href="#sglang.srt.server_args.ServerArgs.tbo_token_distribution_threshold">tbo_token_distribution_threshold</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.tokenizer_mode" href="#sglang.srt.server_args.ServerArgs.tokenizer_mode">tokenizer_mode</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.tokenizer_path" href="#sglang.srt.server_args.ServerArgs.tokenizer_path">tokenizer_path</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.tool_call_parser" href="#sglang.srt.server_args.ServerArgs.tool_call_parser">tool_call_parser</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.tool_server" href="#sglang.srt.server_args.ServerArgs.tool_server">tool_server</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.torch_compile_max_bs" href="#sglang.srt.server_args.ServerArgs.torch_compile_max_bs">torch_compile_max_bs</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.torchao_config" href="#sglang.srt.server_args.ServerArgs.torchao_config">torchao_config</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.tp_size" href="#sglang.srt.server_args.ServerArgs.tp_size">tp_size</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.triton_attention_num_kv_splits" href="#sglang.srt.server_args.ServerArgs.triton_attention_num_kv_splits">triton_attention_num_kv_splits</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.triton_attention_reduce_in_fp32" href="#sglang.srt.server_args.ServerArgs.triton_attention_reduce_in_fp32">triton_attention_reduce_in_fp32</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.trust_remote_code" href="#sglang.srt.server_args.ServerArgs.trust_remote_code">trust_remote_code</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.url" href="#sglang.srt.server_args.ServerArgs.url">url</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.validate_disagg_tp_size" href="#sglang.srt.server_args.ServerArgs.validate_disagg_tp_size">validate_disagg_tp_size</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.warmups" href="#sglang.srt.server_args.ServerArgs.warmups">warmups</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.watchdog_timeout" href="#sglang.srt.server_args.ServerArgs.watchdog_timeout">watchdog_timeout</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.weight_loader_disable_mmap" href="#sglang.srt.server_args.ServerArgs.weight_loader_disable_mmap">weight_loader_disable_mmap</a></code></li>
<li><code><a title="sglang.srt.server_args.ServerArgs.weight_version" href="#sglang.srt.server_args.ServerArgs.weight_version">weight_version</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.6</a>.</p>
</footer>
</body>
</html>
